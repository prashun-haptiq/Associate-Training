try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="9bf6be38-1af5-4b85-ac39-f356181e3ce0",e._sentryDebugIdIdentifier="sentry-dbid-9bf6be38-1af5-4b85-ac39-f356181e3ce0")}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6900],{83250:function(e,t,s){"use strict";var a,r,n,i,l=s(55953);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)({}).hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e}).apply(null,arguments)}t.Z=function(e){return l.createElement("svg",o({xmlns:"http://www.w3.org/2000/svg",width:109,height:113,fill:"none"},e),a||(a=l.createElement("path",{fill:"url(#supabase_logo_svg__a)",d:"M63.708 110.284c-2.86 3.601-8.658 1.628-8.727-2.97l-1.007-67.251h45.22c8.19 0 12.758 9.46 7.665 15.874z"})),r||(r=l.createElement("path",{fill:"url(#supabase_logo_svg__b)",fillOpacity:.2,d:"M63.708 110.284c-2.86 3.601-8.658 1.628-8.727-2.97l-1.007-67.251h45.22c8.19 0 12.758 9.46 7.665 15.874z"})),n||(n=l.createElement("path",{fill:"#3ECF8E",d:"M45.317 2.071c2.86-3.601 8.657-1.628 8.726 2.97l.442 67.251H9.83c-8.19 0-12.759-9.46-7.665-15.875z"})),i||(i=l.createElement("defs",null,l.createElement("linearGradient",{id:"supabase_logo_svg__a",x1:53.974,x2:94.163,y1:54.974,y2:71.829,gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#249361"}),l.createElement("stop",{offset:1,stopColor:"#3ECF8E"})),l.createElement("linearGradient",{id:"supabase_logo_svg__b",x1:36.156,x2:54.484,y1:30.578,y2:65.081,gradientUnits:"userSpaceOnUse"},l.createElement("stop",null),l.createElement("stop",{offset:1,stopOpacity:0})))))}},21091:function(e,t,s){"use strict";s.d(t,{Y:function(){return w},f:function(){return j}});var a=s(52155),r=s(38109),n=s(98244),i=s(17779),l=s(13350),o=s(73207),d=s(99792),c=s(87294),u=s(4578),m=s(83250),p=s(21517),h=s(57480),x=s(70778),g=s(59253);let f=new Set(["lov-view","lov-write","lov-search-replace","lov-line-replace","lov-delete","lov-rename"]),v=(e,t,s,a,r)=>{var n;if(null==t?void 0:null===(n=t.file_path)||void 0===n?void 0:n.startsWith("mem://")){if("lov-view"===e)return s?"Recalled memory":"Recalling memory";if(["lov-write","lov-search-replace","lov-line-replace"].includes(e))return s?"Updated memory":"Updating memory"}switch(e){case"read_file":case"lov-think":return s?a?"Thought for ".concat(a," second").concat(a>1?"s":""):"Finished thinking":"Thinking";case"lov-view":return s?"Read":"Reading";case"lov-rename":return s?"Renamed":"Renaming";case"lov-delete":return s?"Deleted":"Deleting";case"lov-write":case"lov-search-replace":case"lov-line-replace":return s?"Edited":"Editing";case"lov-add-dependency":return s?"Installed":"Installing";case"lov-remove-dependency":return s?"Uninstalled":"Uninstalling";case"lov-supabase-linter":case"supabase--linter":return"".concat(s?"Checked":"Checking"," performance and security");case"lov-search-files":return s?"Searched for":"Searching for";case"lov-list-dir":return s?"Listed":"Listing";case"lov-read-console-logs":case"lov-read-network-requests":return s?"Checked":"Checking";case"scrape_website":case"lov-fetch-website":return s?"Fetched":"Fetching";case"url_screenshot":case"lov-url-screenshot":return s?"Took screenshot of":"Taking screenshot of";case"lov-download-to-repo":return s?"Downloaded file":"Downloading";case"generate_image":case"imagegen--generate_image":return s?"Generated image":"Generating image";case"edit_image":case"imagegen--edit_image":return s?"Edited image":"Editing image";case"web_search":case"websearch--web_search":return s?"Searched":"Searching";case"supabase_read_query":case"supabase_analytics_query":case"lov-supabase-read-query":case"supabase--read-query":case"lov-supabase-analytics-query":case"supabase--analytics-query":case"lov-experimental-supabase-project-info":case"supabase--project-info":case"lov-experimental-supabase-read-query":case"supabase--read-query":return"".concat(s?"Looked":"Looking"," at ").concat(r?"Backend":"Supabase");case"lov-experimental-supabase-insert":case"lov-supabase-insert":case"supabase--insert":return"".concat(s?"Added":"Adding"," data to ").concat(r?"Backend":"Supabase");case"lov-supabase-migration":case"lov-experimental-supabase-migration":case"supabase--migration":return"".concat(s?"Wrote":"Writing"," ").concat(r?"Backend":"Supabase"," migration");case"lov-experimental-supabase-analytics-query":case"supabase--analytics-query":return"".concat(s?"Looked":"Looking"," at ").concat(r?"Backend":"Supabase"," analytics");case"lov-experimental-supabase-configure-auth":case"supabase--configure-auth":return"Updating Auth config";case"read_project_analytics":case"analytics--read_project_analytics":return"".concat(s?"Checked":"Checking"," analytics");default:return e}},j=(e,t,s)=>{try{var a;let r=null==t?void 0:null===(a=t.file_path)||void 0===a?void 0:a.startsWith("mem://");if((["lov-write","lov-search-replace","lov-line-replace"].includes(e)||"lov-view"===e)&&r)return"";switch(e){case"read_file":case"scrape_website":case"url_screenshot":return(null==t?void 0:t.arg0)||"";case"lov-view":case"lov-delete":case"lov-write":case"lov-search-replace":case"lov-line-replace":return(null==t?void 0:t.file_path)||"";case"lov-rename":return(null==t?void 0:t.original_file_path)&&(null==t?void 0:t.new_file_path)?"".concat(t.original_file_path," to ").concat(t.new_file_path):"";case"lov-download-to-repo":return(null==t?void 0:t.target_path)||"";case"generate_image":case"edit_image":return(null==t?void 0:t.prompt)||"";case"web_search":case"lov-search-files":return(null==t?void 0:t.query)||"";case"lov-add-dependency":case"lov-remove-dependency":return(null==t?void 0:t.package)||"";case"lov-list-dir":return(null==t?void 0:t.dir_path)||"";case"lov-read-console-logs":return"console logs";case"lov-read-network-requests":return"network logs";case"lov-fetch-website":case"lov-url-screenshot":return(null==t?void 0:t.url)||"";case"supabase_read_query":case"lov-supabase-read-query":return s?"Read from database":"Reading from database";case"supabase_analytics_query":case"lov-supabase-analytics-query":return s?"Retrieved logs":"Retrieving logs";default:return""}}catch(e){return""}},b=(e,t)=>{var s;if("lov-view"===e&&(null==t?void 0:null===(s=t.file_path)||void 0===s?void 0:s.startsWith("mem://")))return"lightbulb_2";switch(e){case"lov-download-to-repo":return"download";case"web_search":case"websearch--web_search":return"search";case"generate_image":case"edit_image":case"imagegen--generate_image":case"imagegen--edit_image":return"draw";case"lov-view":return"scan";case"lov-search-replace":case"lov-line-replace":case"lov-write":return"edit_document";case"lov-rename":return"draft";case"lov-delete":return"scan_delete";case"lov-add-dependency":return"extension";case"lov-remove-dependency":return"extension_off";case"lov-think":case"read_file":return"emoji_objects";case"lov-search-files":case"lov-list-dir":return"document_search";case"lov-read-console-logs":case"lov-read-network-requests":return"monitor_heart";case"scrape_website":case"lov-fetch-website":return"tv";case"url_screenshot":case"lov-url-screenshot":return"screenshot_monitor";case"supabase_read_query":return"table";case"supabase_analytics_query":return"history";case"read_project_analytics":return"analytics";default:return"code"}},y=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"light",r="dark"===s?x.A:x.g;switch(e){case"lov-experimental-supabase-read-query":case"lov-experimental-supabase-insert":case"lov-experimental-supabase-migration":case"lov-experimental-supabase-analytics-query":if(!t.query)return null;return(0,a.jsx)(i.Z,{language:"sql",customStyle:{fontSize:"12px"},style:r,children:t.query});default:return null}},w=n.memo(e=>{let{name:t,parsedData:s,done:i=!0,isShimmering:x=!1,duration:w,collapsed:_=!0,onHeightChange:N}=e,C=(0,p.iZ)(e=>e.project),k=(0,l.Iu)(C),S=v(t,s,i,w,k),E=j(t,s,i),I=b(t,s),{resolvedTheme:P}=(0,r.F)(),A=y(t,s,P),{setCurrentFile:z}=(0,h.r)(),{switchToView:M}=(0,g.Z)(),[Z,D]=(0,n.useState)(!0),L=(0,n.useRef)(null),R=(0,n.useRef)(null),[T,O]=(0,n.useState)(0);(0,n.useEffect)(()=>{_&&D(!0)},[_]);let F=!_&&!!A,U=(0,n.useCallback)(()=>!(!E||E.startsWith("mem://"))&&f.has(t)&&E&&E.includes("."),[E,t]),V=(0,c.Z)("md"),W=(0,n.useCallback)(e=>{if(e.stopPropagation(),E&&U()&&!V){let e=E;if("lov-rename"===t&&E.includes(" to ")){let t=E.split(" to ");e=t[1]||t[0]}z(e),M("codeEditor")}},[E,U,t,z,M,V]);return(0,n.useEffect)(()=>{if(R.current){let e=new ResizeObserver(()=>{R.current&&(O(R.current.scrollHeight),null==N||N())});return e.observe(R.current),O(R.current.scrollHeight),()=>e.disconnect()}},[N]),(0,a.jsxs)("div",{ref:L,className:"flex flex-col text-muted-foreground",children:[(0,a.jsxs)("div",{className:(0,u.cn)("flex h-6 items-center gap-1.5 whitespace-nowrap text-base font-medium md:text-sm",F&&"cursor-pointer"),onClick:()=>F&&D(!Z),children:[F&&(0,a.jsx)(d.Z,{name:"chevron_right",size:"small",className:(0,u.cn)("rotate-90 transition-transform duration-200",Z&&"rotate-0")}),(0,a.jsx)("div",{className:"mb-px mr-1 flex shrink-0 items-center",children:t.includes("supabase")?k?(0,a.jsx)(d.Z,{name:"database",size:"small"}):(0,a.jsx)(m.Z,{className:"h-4 w-auto",viewBox:"0 0 109 113"}):(0,a.jsx)(d.Z,{name:I,size:"small",className:"text-muted-foreground"})}),(0,a.jsx)(o.N,{className:"flex-shrink-0 font-normal",isShimmering:x,children:S}),E&&(0,a.jsx)("span",{className:(0,u.cn)("relative w-fit max-w-xs truncate rounded-md bg-secondary px-2 py-0 text-start text-xs font-normal text-muted-foreground",U()&&"cursor-pointer transition-colors hover:bg-secondary/80"),"aria-label":E,title:E,onClick:W,children:(0,a.jsx)(o.N,{isShimmering:x,style:{animationDelay:"1.95s",animationTimingFunction:"ease-out"},className:"truncate",children:E})})]}),(0,a.jsx)("div",{ref:R,className:"overflow-hidden",style:{height:Z?0:T,opacity:Z?0:1},children:A})]})});w.displayName="ToolUseCard"},56959:function(e,t,s){"use strict";var a=s(52155),r=s(59561),n=s(99792),i=s(84183),l=s(4578);t.Z=e=>{let{onClick:t,isBookmarked:s,className:o}=e;return(0,a.jsxs)(i.u,{children:[(0,a.jsx)(i.aJ,{asChild:!0,children:(0,a.jsx)(r.z,{variant:"ghost",size:"icon",className:(0,l.cn)("group/bookmark h-auto w-auto shrink-0 hover:bg-transparent",o),onClick:t,children:(0,a.jsx)(n.Z,{name:s?"bookmark_fill":"bookmark",size:"small",className:(0,l.cn)("text-muted-foreground transition-colors duration-150 ease-in-out group-hover/bookmark:opacity-75",s?"text-affirmative-primary":"")})})}),(0,a.jsx)(i._v,{children:s?"Remove bookmark from history":"Bookmark in history"})]})}},48946:function(e,t,s){"use strict";s.d(t,{z:function(){return sg},Y:function(){return sf}});var a=s(52155),r=s(98244),n=s(84864),i=s(4578),l=s(21198),o=s(44854),d=s(88182),c=s(38109),u=s(42262),m=s(17779),p=s(96895),h=s(99792),x=s(70778),g=s(25649),f=s.n(g);let v=(0,r.memo)(e=>{let{children:t,className:s,components:r}=e;return(0,a.jsx)("div",{className:s,children:(0,a.jsx)(u.UG,{components:r,children:t})})});v.displayName="MemoizedReactMarkdown";let j=e=>{let{match:t,codeContent:s,prismTheme:n}=e,[i,l]=(0,r.useState)(!1),o=async()=>{await navigator.clipboard.writeText(String(s)),l(!0),setTimeout(()=>l(!1),2e3)};return(0,a.jsxs)("div",{className:"relative my-2 rounded-md bg-muted",children:[(0,a.jsx)("button",{className:"absolute right-2 top-2 rounded-md bg-secondary p-1 transition-colors hover:bg-muted-hover",onClick:o,children:(0,a.jsx)(h.Z,{name:i?"check":"content_copy",className:"h-4 w-4 text-primary transition-all duration-300"})}),(0,a.jsx)("div",{className:"max-w-full overflow-x-auto font-mono",children:(0,a.jsx)(m.Z,{children:String(s).replace(/\n$/,""),style:n,language:t[1],wrapLongLines:!0,PreTag:"div",customStyle:{padding:"1em",margin:0}})})]})},b=(0,r.memo)(e=>{let{children:t,displayCursor:s,persisted:n}=e,l=!(0,r.useRef)(n).current,o=(0,p.C)(t),{resolvedTheme:u}=(0,c.F)(),m=(0,r.useMemo)(()=>"dark"===u?x.A:x.g,[u]),h=(0,r.useMemo)(()=>({code(e){let{node:t,className:s,children:r}=e,n=/language-(\w+)/.exec(s||"");return n?(0,a.jsx)(j,{match:n,codeContent:r,prismTheme:m}):(0,a.jsx)("span",{className:"mx-px mb-1 inline-block -translate-y-px rounded-md bg-secondary px-1.5 py-1 font-mono text-[13.5px] leading-[13.5px]",children:r})}}),[m]);return(0,a.jsxs)(d.E.div,{initial:{opacity:l?0:1},animate:{opacity:1},transition:{duration:1,ease:"easeOut"},className:"relative max-w-full",children:[l?(0,a.jsx)(v,{className:(0,i.cn)("prose prose-zinc prose-markdown-mobile absolute inset-x-0 top-0 max-w-full dark:prose-invert md:prose-markdown prose-h1:mb-2 prose-h1:text-xl prose-h1:font-medium prose-h2:text-lg prose-h2:font-medium prose-h3:text-base prose-h3:font-medium prose-pre:my-2 prose-pre:whitespace-pre-wrap prose-pre:break-words prose-pre:bg-background prose-ol:my-2 prose-ul:my-2 prose-li:my-0",f().customProse,s&&f().cursor),components:h,children:o}):null,(0,a.jsx)(v,{className:(0,i.cn)("prose prose-zinc prose-markdown-mobile max-w-full dark:prose-invert md:prose-markdown prose-h1:mb-2 prose-h1:text-xl prose-h1:font-medium prose-h2:text-lg prose-h2:font-medium prose-h3:text-base prose-h3:font-medium prose-pre:my-2 prose-pre:whitespace-pre-wrap prose-pre:break-words prose-pre:bg-background prose-ol:my-2 prose-ul:my-2 prose-li:my-0",f().customProse,s&&f().cursor,l&&"pointer-events-none opacity-0"),components:h,children:t})]})});b.displayName="PromptBox";var y=s(59561),w=s(87294),_=s(48535),N=s(77162),C=s(94127),k=s(70980),S=s(28069),E=s(86818),I=s(59253),P=s(70766);let A=e=>{let{actionProps:t}=e,{switchToView:s,exitView:n,activeView:o}=(0,I.Z)(),d=(0,l.aK)(e=>t.messageId?e.messages[t.messageId]:null),c=(0,l.tV)(t.editId),u=(0,P.VJ)(e=>e.activeMessageId)===t.messageId&&("codeViewer"===o||"error"===o),m=(0,r.useMemo)(()=>{var e;return(null==d?void 0:d.type)==="aiMessage"&&(null===(e=d.errors)||void 0===e?void 0:e.filter(e=>!e.dont_show))||[]},[d]),p=(0,w.Z)("md"),{setView:x}=(0,S.zp)(),g=(0,r.useCallback)(()=>{var e;let a=!!(null==c?void 0:null===(e=c.diff)||void 0===e?void 0:e.length);u?n():(p&&x(S.$.PREVIEW),s("codeViewer",{code:t.code,errors:m,messageId:t.messageId,editId:null==c?void 0:c.id,hasDiffs:a}))},[c,p,u,t.code,t.messageId,m,s,n,x]);return(0,a.jsxs)(y.z,{size:"sm",className:(0,i.cn)("h-6 gap-1 px-1.5 py-0.5 text-sm font-normal transition-all duration-150 ease-in-out hover:bg-muted-hover md:h-5 md:text-xs",u&&"bg-affirmative ring-1 ring-affirmative-primary hover:bg-accent/80"),variant:"ghost",onClick:g,children:[(0,a.jsx)(h.Z,{name:"code",size:"small"}),(0,a.jsx)("span",{children:"Code"})]})};var z=s(84183),M=s(89671),Z=s(99526),D=s(17195),L=s(96659),R=s(81922),T=s(22136),O=s(10990),F=s(21517);let U=e=>{let{editId:t,commitSha:s}=e,n=(0,T.I)(),i=(0,F.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.latest_commit_sha}),o=(0,R.u)(e=>e.setCurrentPage),d=(0,R.u)(e=>e.currentPage),{project_id:c}=(0,Z.useParams)(),u=(0,l.tV)(t),m=(0,L.C)(),p=(0,O.Y)({editId:null==u?void 0:u.id,commitSha:null==u?void 0:u.commit_sha}),{isDisabled:h,disabledReason:x}=(0,r.useMemo)(()=>p?{isDisabled:!0,disabledReason:"Cannot restore to an active edit"}:s?n.isPending?{isDisabled:!0,disabledReason:"Restore is in progress"}:m?{isDisabled:!0,disabledReason:(0,a.jsx)("p",{className:"max-w-sm",children:"Cannot revert while there is an active operation in progress (e.g. chat or revert). Please wait for the operation to complete."})}:{isDisabled:m||n.isPending||!s||p,disabledReason:"Disabled"}:{isDisabled:!0,disabledReason:"Not a valid restore target"},[m,n.isPending,s,p]),g=s===i,f=(0,r.useCallback)(e=>{let{eventName:a}=e;t&&(u&&u.pages&&u.pages.length>0&&!u.pages.find(e=>e.name===d)&&o("index"),D.ZP.capture(a,{edit_id:t,commit_sha:s,disabled:h,disabled_reason:x,is_latest_commit:g,is_active_edit:p,project_id:c}),n.mutateAsync({edit:{id:t}}))},[s,d,x,u,t,h,p,c,n,o]);return{onRevert:t?f:void 0,isLatestCommit:g,isDisabled:h,isPending:n.isPending,disabledReason:x}},V=e=>{let{actionProps:t}=e,{onRevert:s,isDisabled:r,isPending:n,disabledReason:l}=U({editId:t.editId,commitSha:t.commitSha}),o=(0,a.jsxs)(y.z,{size:"sm",className:(0,i.cn)("h-6 gap-1 px-1.5 py-0.5 text-sm font-normal transition-colors duration-150 ease-in-out hover:bg-muted-hover md:h-5 md:text-xs"),variant:"ghost",onClick:()=>{s&&s({eventName:M.SL.CODE_CARD.RESTORE_CLICKED})},disabled:r||n,children:[(0,a.jsx)(h.Z,{name:"restart_alt",size:"small",className:n?"animate-spin-reverse":""}),(0,a.jsx)("span",{children:"Restore"})]});return r&&l?(0,a.jsxs)(z.u,{children:[(0,a.jsx)(z.aJ,{asChild:!0,children:(0,a.jsx)("span",{className:"flex items-center rounded",tabIndex:0,children:o})}),(0,a.jsx)(z._v,{children:(0,a.jsx)("p",{children:l})})]}):o},W=(0,r.memo)(e=>{let{children:t,...s}=e;return(0,a.jsx)(y.z,{size:"sm",variant:"ghost",className:"h-5 gap-1 px-1.5 py-0.5 text-xs font-normal transition-colors duration-150 ease-in-out hover:bg-muted-hover",...s,children:t})});W.displayName="CodeCardActionButton";let H=(0,r.memo)(e=>{let{children:t,className:s}=e;return(0,a.jsx)("div",{className:(0,i.cn)("absolute -right-2 bottom-0 translate-y-1/2",s),children:(0,a.jsx)("div",{className:"flex items-center gap-1 rounded-lg border border-muted-border bg-muted p-0.5",children:t})})});H.displayName="BaseCodeCardActions";let K=(0,r.memo)(e=>(0,a.jsxs)(H,{children:[(0,a.jsx)(V,{actionProps:e}),(0,a.jsx)(A,{actionProps:e})]}));K.displayName="CodeCardActions";let q=e=>"parts"in e&&"done"in e,J={[C.N.CODE_DIFF]:"I couldn't apply your changes because the edit strategy I chose failed.",[C.N.FILE_EDITED_WITHOUT_PERMISSION]:"I couldn't apply your changes because I tried to edit a file that I don't have permission to edit.",[C.N.EXCLUDED_FILE_EDITED]:"I couldn't apply your changes because it resulted in unwanted changes",[C.N.NO_CODE_CHANGE]:"I couldn't apply your changes because the code changes I suggested were the same as the previous code."},Y=e=>{var t,s;let{errors:n,messageParts:l,edit:o,projectId:c}=e,{exitView:u,switchToView:m,activeView:p}=(0,I.Z)(),x=(0,P.VJ)(e=>e.activeMessageId),g=(0,w.Z)("md"),{setView:f}=(0,S.zp)(),v=(0,_.qV)({projectId:c,errorIds:(null==n?void 0:n.map(e=>e.id))||[],setErrors:e=>{}}),j=null==n?void 0:null===(t=n[0])||void 0===t?void 0:t.type,b=(0,r.useMemo)(()=>{let e=J[j];return e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{children:e}),(0,a.jsx)("p",{children:"Please rephrase your request or provide more details."})]}):null},[j]),{onClick:N,isPending:C}=(0,E.hw)({projectId:c,errors:n}),A=n[0].message_id||void 0,z="error"===p&&A===x,M=(0,r.useCallback)(()=>{if(z)u();else{var e;let t=null==l?void 0:l.parts.find(q),s=!!(null==o?void 0:null===(e=o.diff)||void 0===e?void 0:e.length);m("error",{errors:n,code:t,messageId:A,editId:null==o?void 0:o.id,hasDiffs:s}),g&&f(S.$.PREVIEW)}},[z,null==o?void 0:null===(s=o.diff)||void 0===s?void 0:s.length,null==o?void 0:o.id,n,u,g,A,null==l?void 0:l.parts,f,m]),Z=(0,k.bk)(e=>e.isSendChatMessageMutationPending),D=C||Z||0===n.length;return n&&v?(0,a.jsxs)("div",{className:"mt-4 flex flex-col gap-4 pb-4",children:[(0,a.jsxs)(d.E.div,{className:"relative flex w-5/6 max-w-xs pr-9",initial:{opacity:0},animate:{opacity:1},transition:{ease:"easeOut",duration:.5},children:[(0,a.jsx)(H,{className:"pr-9",children:(0,a.jsxs)(W,{onClick:N,loading:C,disabled:D,children:[!C&&(0,a.jsx)(h.Z,{name:"bolt",size:"small"}),(0,a.jsx)("span",{children:"Try to fix"})]})}),(0,a.jsx)("div",{className:"w-full",children:(0,a.jsxs)(y.z,{onClick:M,variant:"outline",className:(0,i.cn)("flex h-auto w-full items-start gap-2 rounded-xl p-3 text-base font-medium shadow-none md:text-sm","border border-warning-primary bg-warning text-warning-foreground","transition-colors duration-150 ease-in-out","hover:border-warning-primary/80 hover:bg-warning/80",{"border-affirmative-primary/50 bg-affirmative text-affirmative-foreground hover:border-affirmative-primary/40 hover:bg-accent/90":z}),children:[(0,a.jsx)("div",{className:"flex h-5 items-center",children:(0,a.jsx)(h.Z,{name:"warning",size:"small"})}),(0,a.jsxs)("div",{className:"flex w-full flex-col gap-0 overflow-hidden text-left",children:[(0,a.jsx)("span",{className:"truncate font-medium",children:"Error"}),(0,a.jsx)("span",{className:(0,i.cn)("truncate text-base font-normal md:text-sm"),children:E.v7[n[0].type]})]}),(0,a.jsx)(h.Z,{name:"chevron_right"})]})})]}),b]}):null},B=e=>{let{errors:t,messageParts:s,edit:r}=e,n=(0,N.D)(),i=null==t?void 0:t.filter(e=>!e.dont_show);return i&&0!==i.length?(0,a.jsx)(Y,{edit:r,errors:i,messageParts:s,projectId:n}):null};var X=s(37298),G=s(56852),$=s(54816),Q=s(86338),ee=s(66258),et=s.n(ee),es=s(13018),ea=s(37156),er=s(50484),en=s(56166),ei=s(13273),el=s(94671);let eo=()=>{let{userData:e}=(0,ea.SE)();return(0,en.D)({mutationFn:async t=>(0,el.SJ)().put("/user/".concat(e.id),{tips:t}),onError:e=>{(0,ei.Eo)(e)}})},ed=e=>!e||!e.visual_edits_dismissed_at&&!e.visual_edits_temporarily_closed,ec=e=>{let{url:t}=e,[s,n]=(0,r.useState)(!0),i=(0,es.dl)(er.P.BetaTesters),{snapshot:{getUserMessageCount:o}}=(0,l.mx)(),{userData:d}=(0,ea.SE)(),c=eo(),u=1>=o(),m=(0,r.useMemo)(()=>ed(null==d?void 0:d.tips),[null==d?void 0:d.tips]);return u&&s&&i&&m?(0,a.jsx)("div",{className:"w-full",children:(0,a.jsxs)("div",{className:"rounded-lg bg-muted p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between pb-4",children:[(0,a.jsxs)("span",{className:"flex items-center gap-2 text-base font-medium text-popover-foreground",children:[(0,a.jsx)(h.Z,{name:"my_location"}),(0,a.jsx)("h1",{className:"text-base font-medium",children:"Visual Edits"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{className:"text-base text-muted-foreground hover:underline",onClick:()=>{D.ZP.capture(M.SL.VIDEO_PLAYER.DONT_SHOW_AGAIN_CLICKED),c.mutate({visual_edits_dismissed_at:new Date().toISOString()}),n(!1)},children:"Don't show again"}),(0,a.jsx)("button",{className:"text-muted-foreground",onClick:()=>{D.ZP.capture(M.SL.VIDEO_PLAYER.CLOSE_CLICKED),c.mutate({visual_edits_temporarily_closed:new Date().toISOString()}),n(!1)},children:(0,a.jsx)(h.Z,{name:"close"})})]})]}),(0,a.jsx)("div",{className:"overflow-hidden rounded-lg",children:(0,a.jsx)(et(),{url:t,controls:!0,width:"100%",height:"100%",playbackRate:2.5,onPlay:()=>{D.ZP.capture(M.SL.VIDEO_PLAYER.PLAY_STARTED)}})})]})}):null};var eu=s(3989),em=s(19214),ep=s(5620),eh=s(12703),ex=s(14070),eg=s(52465),ef=()=>{let[e,t]=(0,r.useState)(!1),[s,n]=(0,r.useState)(""),i=(0,F.iZ)(e=>e.project),{updateProject:l}=(0,F.d2)();(0,r.useEffect)(()=>{(null==i?void 0:i.custom_instructions)&&n(i.custom_instructions)},[i]);let o=async()=>{try{l({custom_instructions:s},{onSuccess:()=>{D.ZP.capture(M.SL.KNOWLEDGE.SAVED),eh.Am.success("Custom instructions updated",{description:"Your custom instructions have been saved successfully."})}}),t(!1)}catch(e){eh.Am.error("Error",{description:"Failed to update custom instructions. Please try again."})}};return(0,a.jsxs)(ex.Vq,{open:e,onOpenChange:t,children:[(0,a.jsx)(ex.hg,{asChild:!0,children:(0,a.jsxs)(y.z,{className:"w-fit gap-2 whitespace-nowrap",variant:"outline",size:"sm",onClick:()=>t(!0),children:[(0,a.jsx)(h.Z,{name:"school",className:"text-muted-foreground"}),"Manage knowledge"]})}),(0,a.jsxs)(ex.cZ,{size:"lg",children:[(0,a.jsx)(ex.fK,{children:(0,a.jsx)(ex.$N,{children:"Manage Knowledge"})}),(0,a.jsxs)(ex.Be,{children:["Add custom context and instructions for your project. Lovable will use it in every edit. Use it to:",(0,a.jsxs)("ul",{className:"mt-2 list-disc pl-5",children:[(0,a.jsx)("li",{children:"Define project-specific rules or guidelines"}),(0,a.jsx)("li",{children:"Set coding style preferences (e.g., indentation, naming conventions)"}),(0,a.jsx)("li",{children:"Include external documentation or style guides"})]})]}),(0,a.jsx)(eg.g,{value:s,onChange:e=>n(e.target.value),placeholder:"Enter your custom instructions and context here...",className:"resize-none",rows:16}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)(y.z,{onClick:o,children:"Save"})})]})]})},ev=s(10178),ej=s(72602),eb=s(96869),ey=s(25243),ew=s(7815),e_=s(3011),eN=s(39230);let eC=e=>{let t=e.reduce((e,t)=>(e[t.key]=ey.Z_().min(1,{message:"".concat(t.name," is required")}),e),{});return ey.Ry(t)},ek=e=>e.toLowerCase().split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ").replace(/api/i,"API"),eS=(0,r.memo)(e=>{let{secretFormActions:t,isMostRecentMessage:s}=e,[n,i]=(0,r.useState)(!1),l=(0,N.D)(),{mutate:o}=(0,ev.mo)({projectId:l}),d=(0,r.useMemo)(()=>t.map(e=>({key:e.name,name:ek(e.name)})),[t]),c=(0,r.useMemo)(()=>eC(d),[d]),u=(0,eb.cI)({resolver:(0,ej.F)(c),defaultValues:t.reduce((e,t)=>(e[t.name]="",e),{})});(0,r.useEffect)(()=>{n&&u.reset()},[n,u]);let m=(0,en.D)({mutationFn:async e=>{let t={secrets:Object.entries(e).map(e=>{let[t,s]=e;return{name:t,value:s}})},s=(0,el.SJ)();await s.post("/projects/".concat(l,"/supabase/secrets"),t)},onSuccess:()=>{eh.Am.success("API Keys added successfully"),i(!1),o({body:{id:(0,eN.Fd)(),message:"I have now added the API keys you asked for."}})},onError:e=>{(0,ei.Eo)(e)}}),p=(0,r.useCallback)(async e=>{await m.mutateAsync(e)},[m]);return(0,a.jsxs)(ex.Vq,{open:n,onOpenChange:i,children:[(0,a.jsx)(ex.hg,{children:(0,a.jsxs)(y.z,{disabled:!s,variant:"outline",size:"sm",className:"flex items-center gap-1 overflow-hidden text-ellipsis whitespace-nowrap",children:[(0,a.jsx)(h.Z,{name:"key",size:"small"}),"Add API Key",1===t.length?"":"s"]})}),(0,a.jsxs)(ex.cZ,{className:"sm:max-w-[425px]",children:[(0,a.jsxs)(ex.fK,{children:[(0,a.jsx)(ex.$N,{asChild:!0,children:(0,a.jsxs)("h1",{className:"text-2xl font-medium",children:["Add API Key",1===t.length?"":"s"]})}),(0,a.jsxs)(ex.Be,{className:"text-muted-foreground",children:["Enter your API Key",1===t.length?"":"s"," to continue. Manage this later from the Supabase menu."," ",(0,a.jsx)(G.default,{href:"https://docs.lovable.dev/integrations/supabase#storing-secrets-with-supabase",className:"text-primary underline hover:no-underline",target:"_blank",children:"Learn more"})]})]}),(0,a.jsx)(ew.l0,{...u,children:(0,a.jsxs)("form",{onSubmit:u.handleSubmit(p),className:"space-y-4",children:[d.map(e=>(0,a.jsx)(ew.Wi,{control:u.control,name:e.key,render:t=>{let{field:s}=t;return(0,a.jsxs)(ew.xJ,{children:[(0,a.jsx)(ew.lX,{children:e.name}),(0,a.jsx)(ew.NI,{children:(0,a.jsx)(e_.I,{placeholder:"Enter API Key",type:"password",autoComplete:"off",autoSave:"off",...s})}),(0,a.jsx)(ew.zG,{})]})}},e.key)),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(ex.GG,{asChild:!0,children:(0,a.jsx)(y.z,{type:"button",disabled:m.isPending,variant:"outline",children:"Cancel"})}),(0,a.jsx)(y.z,{loading:m.isPending,type:"submit",children:"Submit"})]})]})})]})]})});eS.displayName="AddApiKeysButton";var eE=s(25938);let eI=e=>{let{done:t}=e;return(0,a.jsxs)(ex.cZ,{className:"gap-4 outline-none focus:ring-0",size:"lg",children:[(0,a.jsxs)("div",{className:"flex flex-col items-start gap-4",children:[(0,a.jsx)(h.Z,{name:"shopify",className:"h-9 w-9"}),(0,a.jsxs)(ex.fK,{children:[(0,a.jsx)(ex.$N,{className:"text-2xl md:text-3xl",children:"Connect to Shopify"}),(0,a.jsx)(ex.Be,{children:"Shopify adds e-commerce functionality to your website. Choose your setup path below."})]})]}),(0,a.jsxs)(eE.mQ,{defaultValue:"no-store",className:"w-full",children:[(0,a.jsxs)(eE.dr,{className:"grid w-full grid-cols-2",children:[(0,a.jsx)(eE.SP,{value:"no-store",children:"I don't have a store"}),(0,a.jsx)(eE.SP,{value:"have-store",children:"I already have a store"})]}),(0,a.jsx)(eE.nU,{value:"no-store",className:"mt-4",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"font-medium text-foreground",children:"Getting started:"}),(0,a.jsxs)("ol",{className:"list-inside list-decimal space-y-2 text-muted-foreground",children:[(0,a.jsxs)("li",{children:["Head to"," ",(0,a.jsx)(G.default,{href:"https://shopify.com/free-trial",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"shopify.com/free-trial"})," ","and create your store"]}),(0,a.jsxs)("li",{children:["Once logged into your Shopify Admin at"," ",(0,a.jsx)(G.default,{href:"https://admin.shopify.com",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"admin.shopify.com"}),", find your Store ID in the address bar:"," ",(0,a.jsx)("code",{className:"rounded bg-muted px-1 py-0.5 text-xs",children:"https://admin.shopify.com/store/[STORE-ID]"})]}),(0,a.jsx)("li",{children:"Paste it in the chat to get started"})]})]})}),(0,a.jsx)(eE.nU,{value:"have-store",className:"mt-4 space-y-4",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("p",{className:"font-medium text-foreground",children:"Connect your existing store:"}),(0,a.jsxs)("ol",{className:"list-inside list-decimal space-y-2 text-muted-foreground",children:[(0,a.jsxs)("li",{children:["Log into your Shopify Admin at"," ",(0,a.jsx)("a",{href:"https://admin.shopify.com",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"admin.shopify.com"})]}),(0,a.jsxs)("li",{children:["Copy your Store ID from the URL:"," ",(0,a.jsx)("code",{className:"rounded bg-muted px-1 py-0.5 text-xs",children:"https://admin.shopify.com/store/STORE-ID"})]}),(0,a.jsx)("li",{children:"Copy it, then paste it in the chat to get started"})]})]})})]}),(0,a.jsx)(ex.cN,{fullWidthButtons:!0,className:"flex-col",children:(0,a.jsx)(y.z,{onClick:()=>{t()},className:"mt-3 w-full",variant:"outline",children:"I have my Shopify Store ID"})})]})},eP=e=>{let t=document.createElement("div");return t.innerHTML=e,(t.textContent||t.innerText||"").replace(/\n\s*\n/g,"\n\n").trim()};function eA(e){let{open:t,onOpenChange:s,onFeedbackSubmit:n,messageId:i,projectId:l,onCancel:o,initialContent:d}=e,[c,u]=(0,r.useState)(""),[m,p]=(0,r.useState)([]);(0,r.useEffect)(()=>{t&&u(d||"")},[t,d]);let h=e=>{p(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])};return(0,a.jsx)(ex.Vq,{open:t,onOpenChange:e=>{!e&&(c.length>0||m.length>0)&&D.ZP.capture("message_feedback:dialog_cancelled",{messageId:i,projectId:l,action:"close",hadContent:c.length>0,hadCategories:m.length>0}),e||(u(""),p([]),null==o||o()),s(e)},children:(0,a.jsx)(ex.cZ,{children:(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-medium text-foreground",children:"Help us improve"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Please tell us why this response wasn't helpful to you."}),(0,a.jsx)("div",{className:"mt-4 grid grid-cols-2 gap-2",children:["Design is off","Unrelated changes made","Functionality is broken","Other"].map(e=>(0,a.jsx)(y.z,{variant:m.includes(e)?"default":"outline",className:"w-full justify-start pl-4 ".concat(m.includes(e)?"border border-primary":""),size:"lg",onClick:()=>h(e),children:e},e))})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"text-sm text-muted-foreground",children:"Additional Feedback"}),(0,a.jsx)(eg.g,{placeholder:"This was not helpful because ...",value:c,className:"min-h-24 resize-none",onChange:e=>u(e.target.value)})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(y.z,{onClick:()=>{D.ZP.capture("message_feedback:dialog_cancelled",{messageId:i,projectId:l,action:"cancel",hadContent:c.length>0,hadCategories:m.length>0}),u(""),p([]),s(!1),null==o||o()},size:"sm",variant:"secondary",children:"Cancel"}),(0,a.jsx)(y.z,{onClick:()=>{n({content:c,categories:m}),u(""),p([]),s(!1)},size:"sm",variant:"default",children:"Submit"})]})]})})})}let ez=(0,r.memo)(e=>{let{message:t}=e,s=(0,F.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.id}),n=(0,el.SJ)(),[i,l]=(0,r.useState)(t.feedbackSentiment||null),[o,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)(!1);(0,r.useEffect)(()=>{l(t.feedbackSentiment||null)},[t.feedbackSentiment]);let m=(0,en.D)({mutationFn:async e=>{let{sentiment:a,content:r,categories:i}=e;if(!s)throw Error("Project ID is required");let l={sentiment:a};r&&(l.content=r),i&&i.length>0&&(l.category=i.join(", ")),await n.post("/projects/".concat(s,"/messages/").concat(t.id,"/feedback"),l)},onSuccess:()=>{eh.Am.success("Thanks for your feedback!")},onError:e=>{eh.Am.error("Failed to save feedback",{description:(null==e?void 0:e.message)||"Please try again"})}}),p=async()=>{try{let e=eP(t.content);await navigator.clipboard.writeText(e),u(!0),setTimeout(()=>u(!1),2e3),D.ZP.capture("message_copy",{messageId:t.id,projectId:s})}catch(e){(0,ei.Eo)(e)}},x=(0,w.Z)("md");return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mt-1.5 flex flex-shrink-0 items-center gap-3 pr-1",children:[(0,a.jsx)("button",{onClick:()=>{let e="positive"===i?null:"positive";l(e),e&&(m.mutate({sentiment:e}),D.ZP.capture("message_feedback:thumbs_up"))},className:"flex items-center gap-1 transition-colors focus:outline-none ".concat("positive"===i?"text-white-600 hover:text-white-700":"text-muted-foreground hover:text-foreground"),title:"Helpful",children:(0,a.jsx)(h.Z,{size:x?"default":"small",name:"positive"===i?"thumb_up-fill":"thumb_up"})}),(0,a.jsx)("button",{onClick:()=>{"negative"===i?D.ZP.capture("message_feedback:dialog_opened_for_edit",{messageId:t.id,projectId:s,hadPreviousContent:!!t.feedbackContent}):l("negative"),d(!0)},className:"flex items-center gap-1 transition-colors focus:outline-none ".concat("negative"===i?"text-white-600 hover:text-white-700":"text-muted-foreground hover:text-foreground"),title:"Not helpful",children:(0,a.jsx)(h.Z,{size:x?"default":"small",name:"negative"===i?"thumb_down-fill":"thumb_down"})}),(0,a.jsx)("button",{onClick:p,className:"flex items-center gap-1 text-muted-foreground transition-colors hover:text-foreground focus:outline-none",title:c?"Copied!":"Copy message",children:(0,a.jsx)(h.Z,{size:x?"default":"small",name:c?"check":"content_copy"})})]}),(0,a.jsx)(eA,{open:o,onOpenChange:d,onFeedbackSubmit:e=>{m.mutate({sentiment:"negative",content:e.content,categories:e.categories})},messageId:t.id,projectId:s,onCancel:()=>{t.feedbackContent||l(null)},initialContent:t.feedbackContent})]})});ez.displayName="MessageFeedbackButtons";var eM=s(13350),eZ=s(26696);let eD=e=>{let{messageId:t,runState:s,toolUseId:r}=e,n=(0,N.D)(),i=(0,F.iZ)(e=>e.project),l=(0,eM.Iu)(i),{mutateAsync:o,isPending:d}=(0,ev.mo)({projectId:n}),c=async()=>{await o({body:{message:"I have reviewed the SQL and it looks good. Please run it.",id:(0,eN.Fd)(),mode:eZ.S.INSTANT,run_sql_in_message_with_id:t,prev_session_id:r?t:void 0},projectId:n})};return l?null:(0,a.jsx)("div",{children:(0,a.jsx)(y.z,{variant:"default",size:"sm",className:"gap-2 py-2",onClick:c,disabled:void 0!==s&&"not_started"!==s||d,children:"not_started"===s||void 0===s?"Apply changes":"running"===s?"Applying changes...":"failed"===s?"Failed to apply changes":"SQL already executed"})})},eL=e=>e.startsWith("https://supabase.com/dashboard/project/")||e.includes("?settings=supabase")?(0,a.jsx)(X.default,{width:16,height:16,src:"/icons/supabase_logo.svg",alt:"Supabase"}):(0,a.jsx)(h.Z,{name:"arrow_outward"});function eR(e){let{linkActions:t}=e;return t&&0!==t.length?(0,a.jsx)(a.Fragment,{children:null==t?void 0:t.map(e=>{let t=e.url.startsWith("/projects/");return(0,a.jsx)(y.z,{asChild:!0,variant:"outline",size:"sm",className:"flex items-center gap-1 overflow-hidden text-ellipsis whitespace-nowrap",children:(0,a.jsxs)(G.default,{href:e.url,target:t?void 0:"_blank",rel:"noopener noreferrer",children:[eL(e.url),(0,a.jsx)("span",{className:"truncate",children:e.text})]})},e.url)})}):null}function eT(e){let{messagePromptActions:t}=e,s=(0,F.iZ)(e=>e.projectId),r=(0,eu.hT)(e=>e.chatMode),{setChatMode:n}=(0,eu.VK)(),{isAgentModeDefault:i}=(0,Q.v)(),{mutate:l,isPending:o}=(0,ev.OU)({projectId:s});return t&&0!==t.length?(0,a.jsx)(a.Fragment,{children:null==t?void 0:t.map(e=>(0,a.jsx)(y.z,{asChild:!0,variant:"outline",size:"sm",disabled:o,onClick:()=>{r===eu.jE.CHAT_ONLY&&n(i?eu.jE.AGENT:eu.jE.DEFAULT),l({body:{id:(0,$.Z)(),message:e.message}})},className:"flex cursor-pointer items-center gap-1 overflow-hidden text-ellipsis whitespace-nowrap",children:(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(h.Z,{name:"chat_bubble",size:"small"}),(0,a.jsx)("span",{className:"truncate",children:e.text})]})},e.message))}):null}function eO(e){let{providerCardActions:t}=e,s=(0,em.z)(eI);return(0,a.jsx)(a.Fragment,{children:null==t?void 0:t.map((e,t)=>"shopify"===e.provider&&(0,a.jsxs)(ep.Zb,{className:"flex w-full flex-1",children:[(0,a.jsxs)(ep.Ol,{className:"flex flex-row items-center gap-2",children:[(0,a.jsx)(h.Z,{name:"shopify"}),(0,a.jsx)(ep.ll,{children:"Connect to Shopify"})]}),(0,a.jsxs)(ep.aY,{className:"w-full",children:[(0,a.jsxs)("div",{className:"flex flex-row items-center gap-2 text-sm",children:[(0,a.jsx)(h.Z,{name:"bar_chart"}),"Set up your store"]}),(0,a.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:"Shopify adds e-commerce functionality to your website. Paste your Shopify Store ID in the chat to get started."}),(0,a.jsx)(y.z,{className:"mt-4 w-full font-normal",variant:"outline",onClick:()=>s({childProps:{done:()=>{s(!1)}}}),children:"Find my Shopify Store ID"})]})]},"".concat(e.provider,"-").concat(t)))})}let eF=e=>{var t,s;let{message:n,messageId:o,lovActions:c,sqlRunState:u,persisted:m}=e,{isMostRecentMessage:p}=(0,l.mx)(),{migrateActions:h,linkActions:x,knowledgeAction:g,messagePromptActions:f,secretFormActions:v,providerCardActions:j}=(0,r.useMemo)(()=>{let e=null==c?void 0:c.filter(e=>"lov_action__migrate"===e.type&&e.done),t=null==c?void 0:c.filter(e=>"lov_action__link"===e.type),s=null==c?void 0:c.filter(e=>"lov_action__message_prompt"===e.type),a=null==c?void 0:c.filter(e=>"lov_action__secret_form"===e.type);return{migrateActions:e,linkActions:t,knowledgeAction:null==c?void 0:c.find(e=>"lov_action__knowledge"===e.type),messagePromptActions:s,secretFormActions:a,providerCardActions:null==c?void 0:c.filter(e=>"lov_action__provider_card"===e.type)}},[c]),b=j&&j.length>0;return(0,a.jsxs)(d.E.div,{className:"flex max-w-full flex-1 flex-col gap-4 overflow-hidden",initial:{opacity:m?1:0},animate:{opacity:1},transition:{ease:"easeOut",duration:1},children:[m&&(0,a.jsx)(ec,{url:"https://customer-8etxbtq55jiz5gtf.cloudflarestream.com/0989fc00edc27647d46bd169d87b7200/manifest/video.m3u8"}),(0,a.jsxs)("div",{className:(0,i.cn)("flex items-start justify-between gap-4 overflow-hidden",b&&"flex-col"),children:[(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsxs)("div",{className:"flex w-full min-w-0 flex-1 flex-wrap items-center gap-2",children:[(null!==(s=null==h?void 0:h.length)&&void 0!==s?s:0)>0&&(0,a.jsx)(eD,{messageId:o,runState:u,toolUseId:null==h?void 0:null===(t=h[0])||void 0===t?void 0:t.toolUseId},"migrate"),(0,a.jsx)(eR,{linkActions:x}),(0,a.jsx)(eT,{messagePromptActions:f}),v&&v.length>0&&(0,a.jsx)(eS,{secretFormActions:v,isMostRecentMessage:p(o)}),g&&(0,a.jsx)(ef,{})]}),b&&(0,a.jsx)(eO,{providerCardActions:j})]}),m&&(0,a.jsx)(ez,{message:n})]})]})};var eU=s(52162),eV=s(29306);let eW=e=>{let t=(0,P.VJ)(e=>e.activeEditId),{activeView:s}=(0,I.Z)(),a=(0,l.aK)(e=>e.edits),r=t?a[t]:null,n=(0,O.Y)({editId:null==e?void 0:e.id,commitSha:null==e?void 0:e.commit_sha}),i=null==r?void 0:r.revert_target_edit_id,o=(null==r?void 0:r.id)===(null==e?void 0:e.id)||!!i&&i===(null==e?void 0:e.id);return{isActive:o&&"snapshot"===s,isActiveCode:o&&"codeViewer"===s,shouldShowCurrentEditHighlight:n&&"preview"===s&&!!e}};var eH=s(17176);let eK=e=>{var t;let{edit:s,messageId:a,code:n}=e,i=(0,F.iZ)(e=>e.project),{switchToView:l,exitView:o}=(0,I.Z)(),d=(0,O.Y)({editId:null==s?void 0:s.id,commitSha:null==s?void 0:s.commit_sha}),{isActive:c,isActiveCode:u}=eW(s),m=(0,r.useMemo)(()=>{if((null==s?void 0:s.commit_sha)&&i)return(0,eH.t)({projectId:null==i?void 0:i.id,sha:null==s?void 0:s.commit_sha})},[null==s?void 0:s.commit_sha,i]);return{handleOpenPreview:(0,r.useCallback)(e=>{if(e.altKey){window.open(m,"_blank");return}if(c||d){o();return}l("snapshot",{previewUrl:m,messageId:a,editId:null==s?void 0:s.id})},[c,d,o,s,a,m,l]),handleOpenCode:(0,r.useCallback)(()=>{var e;let t=!!(null==s?void 0:null===(e=s.diff)||void 0===e?void 0:e.length);u?o():l("codeViewer",{code:n,errors:void 0,messageId:a,editId:null==s?void 0:s.id,hasDiffs:t})},[null==s?void 0:null===(t=s.diff)||void 0===t?void 0:t.length,null==s?void 0:s.id,u,n,a,l,o])}};var eq=s(25871),eJ=s(56959);let eY=e=>{var t,s;let{onClick:n,children:l,edit:o,message:d,code:c,isLoading:u}=e,m=(0,F.iZ)(e=>e.project),{toggleBookmark:p}=(0,eq.g)((null==m?void 0:m.id)||""),{isActive:h,shouldShowCurrentEditHighlight:x}=eW(o),g=(0,r.useCallback)(e=>{e.stopPropagation(),(null==o?void 0:o.id)&&p(o.id,!!o.bookmarked)},[o,p]);return(0,a.jsxs)("div",{className:"flex w-full items-start gap-1",children:[(0,a.jsxs)("div",{className:"relative w-full",children:[!!o&&(0,a.jsx)(K,{editId:null!==(t=null==o?void 0:o.id)&&void 0!==t?t:void 0,commitSha:null!==(s=null==o?void 0:o.commit_sha)&&void 0!==s?s:void 0,messageId:d.id,code:c}),(0,a.jsx)(y.z,{onClick:n,variant:"outline",className:(0,i.cn)("flex h-auto w-full max-w-56 cursor-pointer gap-2 rounded-xl p-3 text-base font-medium shadow-none sm:max-w-xs md:text-sm",u?"items-center":"items-start","border border-muted-border bg-muted text-foreground","transition-all duration-150 ease-in-out","hover:border-border hover:bg-muted-hover",{"border-affirmative-primary bg-affirmative hover:border-affirmative-primary/80 hover:bg-affirmative/80":x||h,"hover:cursor-auto hover:border-affirmative-primary hover:bg-affirmative":x}),children:l})]}),(null==o?void 0:o.id)&&(0,a.jsx)("div",{className:"flex h-8 w-8 flex-shrink-0 items-center justify-center",children:(0,a.jsx)(eJ.Z,{onClick:g,isBookmarked:!!o&&!!o.bookmarked&&(null==o?void 0:o.bookmarked),className:"mt-3"})})]})};var eB=s(21091);let eX=e=>"edit"===e.variant?(0,a.jsx)(eG,{...e}):(0,a.jsx)(e$,{...e}),eG=e=>{let{message:t,edit:s,onClick:r,isActive:n,code:i}=e,l=!0;"aiMessage"===t.type&&(l=i.done||"running"!==t.status);let d=(0,o.zL)(i),c=(0,O.Y)({editId:null==s?void 0:s.id,commitSha:null==s?void 0:s.commit_sha}),u="aiMessage"===t.type&&!t.stopped&&!l;return(0,a.jsxs)(eY,{edit:s,message:t,code:i,onClick:r,isLoading:u,children:[d>0&&(0,a.jsx)("div",{className:"flex h-5 items-center",children:(0,a.jsx)(h.Z,{name:"language",size:"small"})}),l?(0,a.jsx)(e1,{message:t,isCurrentEdit:c,edit:s,isActive:n,code:i}):i&&(0,a.jsx)(e0,{isActive:n,code:i,messageStopped:"aiMessage"===t.type&&t.stopped}),(0,a.jsx)(h.Z,{name:"chevron_right"})]})},e$=e=>{let{message:t,edit:s,onClick:r,isActive:n}=e,i=(0,O.Y)({editId:null==s?void 0:s.id,commitSha:null==s?void 0:s.commit_sha});return(0,a.jsxs)(eY,{edit:s,message:t,code:void 0,onClick:r,isLoading:!1,children:[(0,a.jsx)(e1,{message:t,isCurrentEdit:i,edit:s,isActive:n}),(0,a.jsx)(h.Z,{name:"chevron_right"})]})},eQ=(0,r.memo)(e=>{let{message:t,edit:s,code:r}=e,{isActive:n}=eW(s),{handleOpenCode:i,handleOpenPreview:l}=eK({edit:s,messageId:t.id,code:r}),o=(0,w.Z)("md"),{setView:c}=(0,S.zp)(),u="aiMessage"===t.type&&t.persisted;return(0,a.jsx)(d.E.div,{className:"relative flex w-5/6 max-w-xs pb-4",initial:{opacity:u?1:0},animate:{opacity:1},transition:{ease:"easeOut",duration:1},children:(0,a.jsx)(eX,{variant:"edit",code:r,message:t,edit:null!=s?s:null,onClick:e=>{o&&c(S.$.PREVIEW),s?l(e):i()},isActive:n})})});eQ.displayName="CodeCard";let e0=(0,r.memo)(e=>{let{isActive:t,code:s,messageStopped:n}=e,[l,o]=(0,r.useState)(""),c=!n;(0,r.useEffect)(()=>{s.parts.length>0&&o(e=>e5(s)||e)},[s]);let u=c?l||"...":l;return(0,a.jsx)("div",{className:"min-h-[1.375rem] min-w-0 flex-1",children:(0,a.jsx)(eU.M,{mode:"popLayout",children:(0,a.jsx)(d.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2},children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:(0,i.cn)("truncate text-muted-foreground",{"text-foreground":t}),children:u}),c&&(0,a.jsx)(eV.T,{text:"",className:"mt-0"})]})},u)})})});e0.displayName="EditingTitle";let e1=(0,r.memo)(e=>{let{message:t,edit:s,code:n,isActive:l,isCurrentEdit:d}=e,{title:c,body:u}=(0,r.useMemo)(()=>{let e=void 0!==n?(0,o.zL)(n):0;if(s){var a;return{title:"".concat(null!==(a=s.commit_message)&&void 0!==a?a:"no commit message"),body:d?"Preview Latest":"Preview"}}if(0===e&&"aiMessage"===t.type&&void 0!==t.thinkingTimeMs)return{title:"Saving changes...",body:"View more"};let r="aiMessage"===t.type?t.status:"completed",i="Saving changes...";return"stopped"===r&&(i="Generation stopped"),"completed"!==r||t.editId||(i="Failed to save changes"),{title:"Edited ".concat(e," file").concat(1===e?"":"s"),body:i}},[t,d,s,n]);return(0,a.jsxs)("div",{className:"flex w-full flex-col gap-1 overflow-hidden text-left",children:[(0,a.jsx)("span",{className:(0,i.cn)("truncate",{"text-foreground":l}),children:c}),(0,a.jsx)("span",{className:"truncate font-normal",children:u})]})});e1.displayName="FinishedEditingTitle";let e2=e=>{if(!e)return"";let t=e.split(/[\/\\]/);return t[t.length-1]},e5=e=>{for(let t=e.parts.length-1;t>=0;t--){let s=e.parts[t];if("writing_file"===s.type||"edit"===s.type)return"Writing ".concat(e2(s.file_path));if("delete"===s.type)return"Deleting ".concat(e2(s.file_path));if("rename"===s.type)return"Renaming ".concat(e2(s.original_file_path));else if("add_dependency"===s.type)return"Installing ".concat(s.dependency);else if("remove_dependency"===s.type)return"Uninstalling ".concat(s.removed_dependency);else if("tool_use"===s.type){let e=(0,eB.f)(s.name||"",s.parsedData,!1);if(e)return e;{let e=s.name||"";return e.split("-").pop()||e}}}return"Thinking..."};var e9=s(73207);let e6=e=>{let{name:t,parsedData:s}=e;switch(t){case"lov-view":case"lov-write":case"lov-search-replace":case"lov-line-replace":return(null==s?void 0:s.file_path)||"";default:return""}},e7=e=>["lov-view","lov-write","lov-search-replace","lov-line-replace"].includes(e),e8=e=>["lov-search-replace","lov-line-replace","lov-write","lov-delete","lov-rename"].includes(e),e4=e=>{if(0===e.length)return[];let t=[],s=[],a="";for(let r of e){let e=e7(r.name),n=e?e6(r):"";if(e&&n&&n===a&&s.length>0)s.push(r);else{if(s.length>0){let e=s[s.length-1],a=s.every(e=>e.done);t.push({...e,done:a})}e&&n?(s=[r],a=n):e||(s=[],a="",t.push(r))}}if(s.length>0){let e=s[s.length-1],a=s.every(e=>e.done);t.push({...e,done:a})}return t},e3=e=>{let{toolUses:t,isShimmering:s}=e,r=t.some(e=>e8(e.name)),n=t.filter(e=>e8(e.name)).length,i=t.length,l=r?n:i,o=r?"".concat(l," edit").concat(1!==l?"s":""," made"):"".concat(l," tool").concat(1!==l?"s":""," used");return(0,a.jsxs)("div",{className:"flex h-6 items-center gap-1.5 whitespace-nowrap text-base font-medium text-muted-foreground md:text-sm",children:[(0,a.jsx)("div",{className:"mb-px mr-1 flex shrink-0 items-center",children:(0,a.jsx)(h.Z,{name:r?"edit_document":"emoji_objects",size:"small",className:"text-muted-foreground"})}),(0,a.jsx)(e9.N,{className:"flex-shrink-0 font-normal",isShimmering:s,children:o})]})},te=e=>{let{toolUses:t,isStreaming:s=!1,isLastElement:n=!1,messageCompleted:l=!1}=e,[o,d]=(0,r.useState)(!1),c=(0,r.useMemo)(()=>e4(t),[t]),u=(0,r.useMemo)(()=>0===c.length?"":"".concat(c[0].name,"-").concat(Object.keys(c[0].parsedData).join("-")),[c.length>0?c[0].name:"",c.length>0?Object.keys(c[0].parsedData).join("-"):""]),m=n&&!l,p=t.some(e=>!e.done),h=c.length>1,x=(0,r.useRef)(null),[g,f]=(0,r.useState)(0),v=(0,r.useRef)(null),j=(0,r.useCallback)(()=>{v.current&&clearTimeout(v.current),v.current=setTimeout(()=>{x.current&&f(x.current.scrollHeight)},50)},[]);if((0,r.useEffect)(()=>()=>{v.current&&clearTimeout(v.current)},[]),(0,r.useEffect)(()=>{x.current&&f(x.current.scrollHeight)},[x,o,c]),0===c.length)return null;if(!h)return(0,a.jsx)(eB.Y,{name:c[0].name,parsedData:c[0].parsedData,done:c[0].done,isShimmering:m,duration:c[0].duration,collapsed:!1});let b=c[c.length-1];return(0,a.jsxs)("div",{className:"relative flex w-full flex-col",children:[(0,a.jsx)(y.z,{onClick:()=>d(!o),variant:"outline",className:(0,i.cn)("absolute right-0 top-0 z-10 flex h-6 items-center justify-center px-1.5 py-1 text-base font-normal transition-all duration-300 ease-out md:text-sm"),"aria-label":o?"Collapse tool uses":"Expand tool uses",children:o?"Hide":"Show all"}),(0,a.jsx)("div",{className:"relative overflow-hidden transition-all duration-300 ease-in-out",style:{height:o?"".concat(g,"px"):"24px"},children:o?(0,a.jsx)("div",{ref:x,className:"absolute top-0 flex w-full flex-col gap-2",children:c.map((e,t)=>(0,a.jsx)("div",{className:"transition-all duration-300 ease-out",children:(0,a.jsx)(eB.Y,{collapsed:!1,onHeightChange:j,name:e.name,parsedData:e.parsedData,done:e.done,isShimmering:m&&t===c.length-1&&!e.done,duration:e.duration})},"".concat(u,"-").concat(t)))}):(0,a.jsx)("div",{className:"flex h-full items-end",children:p||!l&&n?(0,a.jsx)("div",{className:"flex h-6 items-center",children:(0,a.jsx)(eB.Y,{name:b.name,parsedData:b.parsedData,done:b.done,isShimmering:m&&!b.done,duration:b.duration,collapsed:!0})}):(0,a.jsx)(e3,{toolUses:c,isShimmering:!1})})})]})},tt=(0,r.memo)(e=>{let{mermaid:t,className:s}=e,{switchToView:r,activeView:n,exitView:l}=(0,I.Z)(),{setView:o}=(0,S.zp)(),c=(0,P.VJ)(e=>e.mermaidContent),u=(0,w.Z)("md"),m="mermaid"===n&&(null==c?void 0:c.mermaidCode)===t.mermaidCode,p=e=>{if(!e)return"Diagram";let t=e.trim().toLowerCase();return t.startsWith("graph")?"Flowchart":t.startsWith("sequencediagram")?"Sequence":t.startsWith("classdiagram")?"Class":t.startsWith("erdiagram")?"Entity Relationship":t.startsWith("journey")?"User Journey":t.startsWith("gitgraph")?"Git Graph":t.startsWith("pie")?"Pie Chart":t.startsWith("gantt")?"Gantt Chart":t.startsWith("statediagram")?"State":t.startsWith("mindmap")?"Mind Map":"Diagram"},x=p(t.mermaidCode),g=!t.done;return(0,a.jsx)(d.E.div,{className:"relative flex w-5/6 max-w-xs pb-4",initial:{opacity:0},animate:{opacity:1},transition:{ease:"easeOut",duration:1},children:(0,a.jsx)(y.z,{onClick:e=>{var s;e.stopPropagation(),t.done&&(m?l():(r("mermaid",t),u&&(null==o||o(S.$.PREVIEW))),D.ZP.capture(M.SL.MERMAID.DIAGRAM_OPENED,{diagram_type:p(t.mermaidCode),code_length:(null===(s=t.mermaidCode)||void 0===s?void 0:s.length)||0}))},variant:"outline",className:(0,i.cn)("flex h-auto w-full cursor-pointer gap-2 rounded-xl p-3 text-sm font-medium shadow-none",g?"items-center":"items-start","border border-muted-border bg-muted text-foreground","transition-all duration-150 ease-in-out",g?"opacity-60 hover:border-muted-border hover:bg-muted":"hover:border-border hover:bg-muted-hover",m&&"border-affirmative-primary bg-affirmative hover:border-affirmative-primary hover:bg-affirmative hover:opacity-80",s),disabled:g,children:g?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"flex h-5 items-center",children:(0,a.jsx)(h.Z,{name:"progress_activity",size:"small",className:"animate-spin"})}),(0,a.jsx)("span",{className:"flex-1 text-left",children:"Generating diagram..."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"flex h-5 items-center",children:(0,a.jsx)(h.Z,{name:"auto_stories",size:"small"})}),(0,a.jsx)("span",{className:"flex-1 text-left",children:x}),(0,a.jsx)(h.Z,{name:"chevron_right"})]})})})}),ts=e=>{let{codeContent:t}=e,[s,n]=(0,r.useState)(!1),i=async()=>{await navigator.clipboard.writeText(String(t)),n(!0),setTimeout(()=>n(!1),2e3)},{resolvedTheme:l}=(0,c.F)(),o="dark"===l?x.A:x.g;return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("button",{className:"hover:bg-card-hover absolute right-2 top-2 rounded-md bg-secondary p-1 transition-colors",onClick:i,children:(0,a.jsx)(h.Z,{name:s?"check":"content_copy",className:"h-4 w-4 text-foreground transition-all duration-300"})}),(0,a.jsx)("div",{className:"max-w-full overflow-x-auto",children:(0,a.jsx)(m.Z,{children:String(t).replace(/\n$/,""),style:o,language:"sql",wrapLongLines:!0,PreTag:"div"})})]})},ta="Lovable tool use: Approved.\n\ncontext: 6951EAA2-1264-4A1A-A86D-817E462202C7",tr=e=>{let t=(0,N.D)(),s=(0,l.$m)(),a=(null==s?void 0:s.messageId)===e.id,{mutateAsync:r,isPending:n}=(0,ev.mo)({projectId:t});return{onSubmit:async s=>{await r({body:{message:ta,id:(0,eN.Fd)(),mode:eZ.S.INSTANT,prev_session_id:e.id,user_input:s},projectId:t})},isLatestMessage:a,isPending:n}};function tn(e){let{form:t,disabled:s,userInputBlock:n}=e,[i,l]=(0,r.useState)(!1),[o,d]=(0,r.useState)(!1),{name:c,pattern:u,label:m,helpLink:p,link:x,linkTitle:g,...f}=n.data;return(0,a.jsx)(ew.Wi,{control:t.control,name:c,rules:{...f,pattern:u?new RegExp(u):void 0},render:e=>{let{field:t}=e;return(0,a.jsxs)(ew.xJ,{className:"mt-2 flex flex-col gap-0 rounded-2xl bg-secondary p-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(ew.lX,{className:"ml-0.5 flex items-center gap-1 text-base font-normal",children:[(0,a.jsx)("span",{className:"align-text-bottom leading-loose",children:m}),p&&(0,a.jsx)(y.z,{variant:"ghost",size:"icon-sm",className:"h-6 hover:bg-transparent",children:(0,a.jsx)(G.default,{href:p,target:"_blank",rel:"noopener noreferrer",children:(0,a.jsx)(h.Z,{name:"help",size:"small"})})})]}),x&&(0,a.jsx)(y.z,{variant:"ghost",size:"icon-sm",className:"flex h-6 items-center gap-1 font-normal text-muted-foreground hover:bg-transparent",asChild:!0,children:(0,a.jsxs)(G.default,{href:x,target:"_blank",rel:"noopener noreferrer",children:[g||"Learn more",(0,a.jsx)(h.Z,{name:"arrow_outward",size:"small"})]})})]}),(0,a.jsx)(ew.NI,{children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-2 mt-0 flex items-center gap-2",children:[(0,a.jsx)(e_.I,{className:"h-8 bg-background ".concat(o?"invalid:border-destructive-foreground invalid:text-destructive-foreground focus:invalid:ring-destructive":""),disabled:s,type:"secret"!==n.type||i?"text":"password",...t,onBlur:e=>{d(!0),t.onBlur()}}),"secret"===n.type&&(0,a.jsx)(y.z,{variant:"ghost",size:"icon-sm",disabled:s,className:"h-6 hover:bg-transparent",onClick:e=>{e.preventDefault(),l(!i)},children:(0,a.jsx)(h.Z,{name:i?"visibility_off":"visibility",size:"small"})})]}),(0,a.jsx)(tl,{disabled:s,type:"submit"})]})}),(0,a.jsx)(ew.zG,{})]})}})}let ti=e=>{let{message:t,disabled:s,userInput:r,onSubmit:n}=e,i=(0,eb.cI)();return(0,a.jsx)(ew.l0,{...i,children:(0,a.jsx)("form",{onSubmit:i.handleSubmit(n),children:r.map((e,r)=>{switch(e.type){case"instructions":return(0,a.jsx)(b,{displayCursor:!1,persisted:t.persisted,children:e.data.text},r);case"input":case"secret":return(0,a.jsx)(tn,{form:i,disabled:s,userInputBlock:e},r);default:return null}})})})},tl=e=>{let{disabled:t,type:s,onClick:r}=e;return(0,a.jsx)(y.z,{type:s,variant:"outline",onClick:r,disabled:t,children:"Approve"})},to=e=>e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()),td=e=>{let{onSubmit:t,text:s,disabled:r}=e;return(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Tool use"}),(0,a.jsxs)("div",{className:"flex flex-row items-center gap-8",children:[(0,a.jsx)("div",{children:(0,a.jsx)("p",{className:"m-0 text-base",children:to(s)})}),(0,a.jsx)(tl,{disabled:r,onClick:()=>t({})})]})]})},tc=e=>{let{message:t,toolUse:s}=e,{onSubmit:r,isLatestMessage:n,isPending:i}=tr(t);return(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)("div",{className:"max-w-full",children:s.userInput?(0,a.jsx)(ti,{userInput:s.userInput,disabled:!n||i,message:t,onSubmit:r}):(0,a.jsx)(td,{onSubmit:r,disabled:!n||i,text:s.name})})})},tu=e=>{var t;let{message:s,toolUse:r}=e,{onSubmit:n,isLatestMessage:i,isPending:l}=tr(s),o=(null===(t=r.parsedData)||void 0===t?void 0:t.secret_name)||"Secret";return(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)("div",{className:"max-w-full",children:(0,a.jsx)(ti,{userInput:[{type:"secret",data:{name:"secret_value",label:o,required:!0}}],disabled:!i||l,message:s,onSubmit:n})})})},tm=e=>"parts"in e&&"done"in e,tp=e=>"lovSql"in e&&"done"in e,th=e=>"mermaidCode"in e&&"done"in e,tx=e=>"content"in e&&""===e.content.trim(),tg=e=>{var t;let{message:s,edit:r,messageParts:n}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(tf,{message:s,messageParts:n,edit:r}),s.stopped&&(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)("span",{className:"inline-flex items-center text-muted-foreground",children:"This message was cancelled."})}),s.errors&&(0,a.jsx)(B,{edit:r,messageParts:n,errors:null!==(t=s.errors)&&void 0!==t?t:null}),(0,a.jsx)(eF,{message:s,messageId:s.id,lovActions:null==n?void 0:n.lovActions,sqlRunState:s.sqlRunState,persisted:s.persisted})]})},tf=e=>{let{message:t,messageParts:s,edit:r}=e;if(!s)return t.content.length>0?(0,a.jsx)(b,{displayCursor:!1,persisted:t.persisted,children:t.content||""}):null;let n=[],i=[],l=s.parts.some(e=>(0,o.Cg)(e)&&!e.done),d=e=>{i.length>0&&(n.push((0,a.jsx)(te,{toolUses:i,isStreaming:l,isLastElement:e,messageCompleted:t.persisted},"tool-group-".concat(n.length))),i=[])};for(let e=0;e<s.parts.length;e++){let l=s.parts[e];if((0,o.Cg)(l)){if(l.failed)continue;if(l.name.includes("add_secret"))d(!1),n.push((0,a.jsx)(tu,{message:t,toolUse:l},e));else if(l.requiresApproval&&"lov-supabase-migration"!==l.name&&"supabase--migration"!==l.name)d(!1),n.push((0,a.jsx)(tc,{message:t,toolUse:l},e));else if(i.push({name:l.name,parsedData:l.parsedData,done:l.done,duration:l.duration}),("lov-supabase-migration"===l.name||"supabase--migration"===l.name)&&l.parsedData&&l.parsedData.query){let t=l.parsedData.query.replace(/\\n/g,"\n").replace(/\\t/g,"	").replace(/\\r/g,"\r");n.push((0,a.jsx)(ts,{codeContent:t},e))}}else if(!tx(l)){if(d(!1),tm(l))n.push((0,a.jsx)(eQ,{message:t,edit:r,code:l},e));else if(tp(l))n.push((0,a.jsx)(ts,{codeContent:l.lovSql},e));else if(th(l))n.push((0,a.jsx)(tt,{mermaid:l},e));else if("content"in l)n.push((0,a.jsx)(b,{displayCursor:!1,persisted:t.persisted,children:l.content},e));else throw Error("Unknown part type")}}return d(!0),(0,a.jsx)(a.Fragment,{children:n})},tv={},tj=e=>{let{message:t,isFirstAIMessage:s}=e,n=(0,l.tV)(t.editId),d=t.timeToFirstTokenMs;void 0===d?tv[t.id]=!0:tv[t.id]&&(tv[t.id]=!1);let c=(0,r.useMemo)(()=>t.content?function(e,t){if((null==e?void 0:e.parts.length)&&e.parts.length>0){let s=e.parts.find(e=>"object"==typeof e&&"type"in e&&"tool_use"===e.type&&"duration"in e);if(s){if(!t)return s.duration=void 0,e;let a=s.duration+Math.floor(t/1e3);s.duration=a}}return e}((0,o.hP)(t.content),d):null,[t.id,t.content,d]);return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-4 overflow-auto pl-8 text-left text-base leading-[22px]"),style:{overflowWrap:"anywhere"},children:(0,a.jsx)(tg,{message:t,edit:n,messageParts:c})})},tb=e=>{let{branchName:t}=e;return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{children:"Switched branch to"}),(0,a.jsx)("div",{className:"flex items-center gap-2 rounded-full border border-muted-border bg-muted px-2 py-0.5",children:(0,a.jsx)("p",{children:t})})]})};var ty=s(62970),tw=s(77658),t_=s(35127),tN=s(36190),tC=s(53259),tk=s(33864);let tS=e=>{let{remixedProjectId:t,isLoading:s=!1}=e;return(0,a.jsxs)(ex.cZ,{children:[(0,a.jsxs)(ex.fK,{children:[(0,a.jsx)(ex.$N,{children:s?"Remixing Project Snapshot...":"Project Snapshot Remixed Successfully"}),(0,a.jsx)(ex.Be,{children:s?"Please wait while we remix your project snapshot. This may take a moment.":"Your project snapshot has been remixed to your local development environment."})]}),(0,a.jsx)(ex.cN,{children:s?(0,a.jsxs)(y.z,{disabled:!0,children:[(0,a.jsx)(h.Z,{name:"progress_activity",size:"small",className:"animate-spin"}),"Remixing..."]}):(0,a.jsx)(y.z,{asChild:!0,children:(0,a.jsx)("a",{href:"http://localhost:3000/projects/".concat(t),target:"_blank",rel:"noreferrer",children:"Open Remixed Project"})})})]})};var tE=s(33877),tI=s(52078),tP=s(26052),tA=s(26047),tz=s(44647);let tM=e=>"https://us.posthog.com/project/47074/llm-observability/traces/".concat(e),tZ=e=>{let{className:t}=e;return(0,a.jsx)(tP.C,{variant:"outline",className:t,children:"ADMIN"})},tD=e=>!!e&&!!(e.data_opt_out||(0,tz.gG)(e.plan)),tL=e=>{let{messageId:t,editId:s}=e,n=(0,N.D)(),i=(0,tA.v)(),l=(0,em.z)(tS),[o,d]=(0,r.useState)(!1),c=tD((0,tE.hO)(e=>e.projectWorkspace)),u=async()=>{l({childProps:{isLoading:!0}}),d(!0);try{let e=(0,el.SJ)(),s=await e.post("/projects/".concat(n,"/remix/snapshot"),{message_id:t,keep_supabase_connection:!0});l({childProps:{remixedProjectId:s.project_id,isLoading:!1}})}catch(e){eh.Am.error("Failed to remix project snapshot",{description:"An error occurred while remixing the project snapshot to local development."}),l(!1)}finally{d(!1)}},{switchToView:m}=(0,I.Z)();return i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(tC.VD,{}),(0,a.jsxs)(tC.Xi,{className:"w-full gap-2",onClick:()=>{m("debug",t)},children:[(0,a.jsx)(h.Z,{name:"bug_report",size:"small"}),(0,a.jsx)("span",{children:"Debug"}),(0,a.jsx)(tZ,{className:"ml-auto"})]}),!c&&(0,a.jsxs)(tC.Xi,{className:"w-full gap-2",onClick:()=>{m("annotation",t)},children:[(0,a.jsx)(h.Z,{name:"edit",size:"small"}),(0,a.jsx)("span",{children:"Annotate"}),(0,a.jsx)(tZ,{className:"ml-auto"})]}),!c&&(0,a.jsxs)(tC.Xi,{className:"w-full gap-2",onClick:u,disabled:o,children:[(0,a.jsx)(h.Z,{name:"refresh",size:"small",className:o?"animate-spin":""}),(0,a.jsx)("span",{children:o?"Remixing...":"Remix Snapshot to Local"}),(0,a.jsx)(tZ,{className:"ml-auto"})]}),i&&(0,a.jsx)(tC.Xi,{className:"w-full gap-2",asChild:!0,children:(0,a.jsxs)("a",{href:tM(t),target:"_blank",rel:"noreferrer",children:[(0,a.jsx)(h.Z,{name:"arrow_outward",size:"small"}),(0,a.jsx)("span",{children:"Posthog: View LLM Trace"}),(0,a.jsx)(tZ,{className:"ml-auto"})]})}),(0,a.jsx)(tC.Xi,{className:"w-full gap-2",asChild:!0,children:(0,a.jsxs)("a",{href:(0,tI.pr)(n,t),target:"_blank",rel:"noreferrer",children:[(0,a.jsx)(h.Z,{name:"arrow_outward",size:"small"}),(0,a.jsx)("span",{children:"Firestore: Message"}),(0,a.jsx)(tZ,{className:"ml-auto"})]})}),s&&(0,a.jsx)(tC.Xi,{className:"w-full gap-2",asChild:!0,children:(0,a.jsxs)("a",{href:(0,tI.oo)(n,s),target:"_blank",rel:"noreferrer",children:[(0,a.jsx)(h.Z,{name:"arrow_outward",size:"small"}),(0,a.jsx)("span",{children:"Firestore: Edit"}),(0,a.jsx)(tZ,{className:"ml-auto"})]})})]}):null};var tR=s(47684);let tT=e=>{let{messageId:t}=e,s=(0,N.D)(),n=(0,tR.F)(),i=(0,r.forwardRef)((e,t)=>(0,a.jsx)(tC.Xi,{ref:t,...e,children:(0,a.jsxs)("div",{className:"flex w-full justify-between gap-4",onClick:()=>{D.ZP.capture(M.SL.ELLIPSIS.COPY_LINK_CLICKED)},children:[(0,a.jsx)("span",{children:"Copy message link"}),(0,a.jsx)(h.Z,{name:"link",size:"small",className:"ml-auto"})]})}));i.displayName="TriggerComponent";let l=n({TriggerComponent:i,textToCopy:"".concat(window.location.origin,"/projects/").concat(s,"?messageId=").concat(t)});return(0,a.jsxs)(z.u,{children:[(0,a.jsx)(z.aJ,{asChild:!0,children:l}),(0,a.jsx)(z._v,{children:"Copy link to clipboard"})]})},tO=e=>{let{commitSha:t,previewBuildStatus:s}=e,a=(0,F.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.latest_commit_sha}),{project_id:n}=(0,Z.useParams)(),i=(0,F.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.name}),l=t===a,o=(0,r.useMemo)(()=>{if(t&&i)return(0,eH.t)({projectName:i,sha:t})},[t,i]),{isDisabled:d,disabledReason:c}=(0,r.useMemo)(()=>"pending"===s?{isDisabled:!0,disabledReason:"Preview is being built..."}:"failed"===s?{isDisabled:!0,disabledReason:"Failed to build preview"}:o?{isDisabled:!1,disabledReason:void 0}:{isDisabled:!0,disabledReason:"There is no preview available for this version"},[o,s]),u=(0,r.useCallback)(e=>{let{eventName:s}=e;D.ZP.capture(s,{commit_sha:t,disabled:d,disabled_reason:c,is_latest_commit:l,preview_url:o,project_id:n})},[t,c,d,l,o,n]);return{previewUrl:o,isLatestCommit:l,isDisabled:d,disabledReason:c,onPreview:u}},tF=e=>{let{commitSha:t,previewBuildStatus:s}=e,{previewUrl:r,isDisabled:n,onPreview:i}=tO({commitSha:t,previewBuildStatus:s});return(0,a.jsx)(tC.Xi,{asChild:!0,disabled:n,children:(0,a.jsxs)("a",{className:"w-full",href:r,target:"_blank",rel:"noreferrer",onClick:()=>i({eventName:M.SL.ELLIPSIS.PREVIEW_CLICKED}),children:["Preview",(0,a.jsx)(h.Z,{name:"arrow_outward",className:"ml-auto",size:"small"})]})})},tU=e=>{let{editId:t,commitSha:s}=e,{onRevert:r,isDisabled:n}=U({editId:t,commitSha:s});return(0,a.jsxs)(tC.Xi,{className:"w-full",onClick:()=>r&&r({eventName:M.SL.ELLIPSIS.RESTORE_CLICKED}),disabled:n,children:["Restore",(0,a.jsx)(h.Z,{name:"restart_alt",className:"ml-auto",size:"small"})]})},tV=e=>{let{messageId:t,editId:s,costCredits:r,className:n,createdAt:i,senderName:o="Lovable"}=e,d=(0,l.tV)(s);return(0,a.jsxs)(tC.h_,{children:[(0,a.jsx)(tC.$F,{asChild:!0,className:n,children:(0,a.jsx)(y.z,{variant:"ghost",size:"icon-sm",children:(0,a.jsx)(h.Z,{name:"more_horiz",size:"small"})})}),(0,a.jsxs)(tC.AW,{align:"end",children:[(0,a.jsx)(tT,{messageId:t}),(0,a.jsx)(tF,{commitSha:null==d?void 0:d.commit_sha}),(0,a.jsx)(tU,{editId:s,commitSha:null==d?void 0:d.commit_sha}),void 0!==r&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(tC.VD,{}),(0,a.jsxs)(tC.Xi,{className:"cursor-default justify-between focus:bg-transparent focus:text-foreground",onSelect:e=>e.preventDefault(),children:[(0,a.jsx)("span",{children:"Credits used"}),(0,tk.H)(r)]})]}),(0,a.jsx)(tL,{messageId:t,editId:s})]})]})},tW=e=>e<1e3?"1s":e<6e4?"".concat((e/1e3).toFixed(0),"s"):"".concat(Math.floor(e/6e4),"m ").concat(Math.floor(e%6e4/1e3),"s"),tH=e=>"userCommit"!==e.type&&"userMessage"!==e.type,tK=e=>{let{previousMessageId:t}=e,s=(0,l.aK)(e=>t?e.messages[t]:void 0);return s&&"revertSuccess"!==s.type&&!tH(s)?(0,a.jsx)(tJ,{className:"mb-2"}):null},tq=e=>{let{message:t}=e,s=(0,ty.z)(e=>e.showHistory),r=(0,t_.zq)();return s?null:(0,a.jsxs)("div",{className:"mb-3 flex min-w-0 items-center gap-1 text-ellipsis text-nowrap text-muted-foreground @container md:text-sm",children:[(0,a.jsxs)("div",{className:"flex min-w-0 flex-1 items-center leading-none",children:[(0,a.jsx)(tJ,{className:"shrink-0 leading-none"}),r&&void 0!==t.thinkingTimeMs&&t.thinkingTimeMs>0&&("completed"===t.status||"stopped"===t.status)&&(0,a.jsxs)("span",{className:"ml-2 mt-px hidden min-w-0 truncate whitespace-nowrap opacity-100 transition-opacity duration-150 ease-out group-hover:opacity-100 @md:inline-block md:opacity-0",children:["Worked for ",tW(t.thinkingTimeMs)]}),(0,a.jsxs)(z.u,{children:[(0,a.jsx)(z.aJ,{asChild:!0,children:(0,a.jsx)("span",{className:(0,i.cn)("ml-auto mt-px flex-shrink cursor-default overflow-hidden opacity-100 transition-opacity duration-150 ease-out group-hover:opacity-100 md:opacity-0"),children:(0,tN._g)(t.createdAt)})}),(0,a.jsx)(z._v,{children:t.createdAt.toLocaleString()})]})]}),(0,a.jsx)(tV,{className:"shrink-0",messageId:t.id,editId:t.editId,costCredits:t.costCredits,createdAt:t.createdAt})]})},tJ=e=>{let{className:t}=e;return(0,a.jsxs)("div",{className:(0,i.cn)("flex items-center gap-2 pl-2",t),children:[(0,a.jsx)(tw.xx,{className:(0,i.cn)("mr-1.5 h-3.5 md:mr-1")}),(0,a.jsx)("span",{className:(0,i.cn)("whitespace-nowrap text-lg font-medium md:text-base"),children:"Lovable"})]})};var tY=s(75970),tB=s(84516),tX=s(60468);let tG=e=>{let{message:t}=e,{authUser:s}=(0,tY.Eu)(),r=(0,tB.c)(e=>e.collaborators).find(e=>e.id===t.userId),n=(0,tE.hO)(e=>e.membership),i=r||n;if((null==r?void 0:r.id)===(null==s?void 0:s.uid)||(null==n?void 0:n.user_id)===(null==s?void 0:s.uid)||!i)return null;let l=i.display_name===t.userId?i.email:i.display_name;return(0,a.jsxs)("div",{className:"mt-4 flex max-w-full items-center gap-1.5 self-start truncate pl-2 text-sm font-medium",children:[(0,a.jsx)(tX.Y,{user:{id:t.userId||"",username:l||""},className:"h-5 w-5 text-xs"}),(0,a.jsx)(G.default,{className:"min-w-0 truncate hover:underline",href:"/@".concat(i.username),children:l})]})},t$=e=>{let{message:t,previousMessageId:s}=e;switch(t.type){case"userCommit":return null;case"userMessage":return(0,a.jsx)(tG,{message:t});case"branchSwitched":case"revertSuccess":return(0,a.jsx)(tK,{message:t,previousMessageId:s});case"aiMessage":return(0,a.jsx)(tq,{message:t})}};var tQ=s(34550),t0=s(92044);let t1=e=>{let{shortCommitHash:t,scrollToEdit:s,newUI:i=!1}=e,{loadMessagesFromId:o}=(0,l.mx)(),{exitView:c,switchToView:u,activeView:m}=(0,I.Z)(),{setActiveEditId:p}=(0,P.RA)(),x=(0,l.uO)(t),g=(0,P.VJ)(e=>e.activeMessageId),f=(0,l.Fm)(null==x?void 0:x.id),v=g===(null==x?void 0:x.id)&&"codeViewer"===m,[j,b]=(0,r.useState)("idle");(0,r.useEffect)(()=>{v&&p(null==x?void 0:x.id)},[v,x,p]);let y=(0,r.useCallback)(()=>{x&&(v?(D.ZP.capture(M.SL.CONSOLE.EXITED_VIA_CARD),c()):(D.ZP.capture(M.SL.CODE_CARD.VIEW_CODE_CLICKED),u("codeViewer",{code:void 0,errors:void 0,messageId:x.id,editId:x.id,hasDiffs:!0})))},[x,v,c,u]);if(!x)return null;let w=async()=>{b("loading");try{x.type===t0.I.type.DEVELOPER_UPDATE?(await o({messageId:x.id,id_type:"edit_id"}),s({type:"shortCommitHash",value:t})):(await o({messageId:x.id,id_type:"edit_id"}),s({type:"editId",value:x.id})),b("success")}catch(e){eh.Am.error("Could not scroll to edit. Try refreshing the page."),b("error"),n.logging.warn("Firestore error - RevertChipV2 - scroll to edit",{error:e,editId:null==x?void 0:x.id,shortCommitHash:t})}},_="loading"===j;return i?f?"aiMessage"!==f.type?(tQ.Tb(Error("RevertChip: message is not an AI message"),{level:"error"}),null):(0,a.jsx)("div",{className:"flex flex-col gap-2 leading-[22px]",style:{overflowWrap:"anywhere"},children:(0,a.jsxs)(d.E.div,{className:"relative mb-6 mt-3 flex w-5/6 max-w-sm",initial:{opacity:1},animate:{opacity:1},transition:{ease:"easeOut",duration:1},children:[_&&(0,a.jsx)("div",{className:"absolute inset-0 z-10 flex items-center justify-center rounded-md bg-background/80",children:(0,a.jsx)(h.Z,{className:"animate-spin",name:"progress_activity",size:"small"})}),(0,a.jsx)(eX,{variant:"revert",message:f,edit:x,onClick:y,isActive:v})]})}):null:(0,a.jsxs)("button",{className:"flex items-center disabled:opacity-50",onClick:w,disabled:_,children:[(0,a.jsx)("span",{className:"ml-6 mr-2 text-sm text-muted-foreground",children:"Restored"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 rounded-full border border-muted-border bg-muted px-3 py-1.5 transition-colors hover:bg-muted-hover",children:[(0,a.jsx)("span",{className:"max-w-xs truncate text-sm",title:x.commit_message,"aria-label":x.commit_message,children:x.commit_message}),_&&(0,a.jsx)(h.Z,{className:"ml-1 animate-spin",name:"progress_activity",size:"small"})]})]})},t2=e=>{var t,s,r;let{message:n}=e,o=(0,l.uO)(n.shortCommitHash),c={done:!0,parts:null!==(s=null==o?void 0:null===(t=o.diff)||void 0===t?void 0:t.map(e=>({type:"writing_file",file_path:e.file_path,done:!0,content:e.new_content})))&&void 0!==s?s:[]},u=(0,O.Y)({editId:null==o?void 0:o.id,commitSha:null==o?void 0:o.commit_sha}),{isActive:m}=eW(o),p=eK({edit:o,messageId:n.id,code:c});return o?(0,a.jsx)(d.E.div,{className:"relative ml-6 flex w-5/6 max-w-xs pb-4",initial:{opacity:1},animate:{opacity:1},transition:{ease:"easeOut",duration:1},children:(0,a.jsxs)(eY,{edit:o,message:n,code:c,onClick:p.handleOpenPreview,children:[(0,a.jsx)("div",{className:"flex h-5 items-center",children:(0,a.jsx)(tw.xR.GitHub,{className:"mt-px h-4 w-4 text-foreground"})}),(0,a.jsxs)("div",{className:"flex w-full flex-col gap-1 overflow-hidden text-left",children:[(0,a.jsx)("span",{className:(0,i.cn)("truncate",{"text-foreground":m}),children:null!==(r=o.commit_message)&&void 0!==r?r:"No commit message"}),(0,a.jsx)("span",{className:"truncate font-normal",children:u?"Active Edit":"See Preview"})]}),(0,a.jsx)(h.Z,{name:"chevron_right"})]})}):null};var t5=s(91935),t9=s(18587);let t6=(0,r.memo)(e=>{var t;let{messageId:s,edit:n,simplified:o=!1}=e,{commit_sha:d}=null!=n?n:{},{switchToView:c,exitView:u,activeView:m}=(0,I.Z)(),p=(0,P.VJ)(e=>e.activeEditId),h=(0,l.aK)(e=>e.edits),x=p?h[p]:null,g=(0,F.iZ)(e=>e.project),{toggleBookmark:f}=(0,eq.g)((null==g?void 0:g.id)||""),v=(0,r.useMemo)(()=>{if(d&&g)return(0,eH.t)({projectId:null==g?void 0:g.id,sha:d})},[d,g]),j=(0,O.Y)({editId:null==n?void 0:n.id,commitSha:null!==(t=null==n?void 0:n.commit_sha)&&void 0!==t?t:void 0}),b=n&&(null==x?void 0:x.id)===(null==n?void 0:n.id)&&"snapshot"===m||j&&!x&&!m,w=(0,r.useMemo)(()=>{if(!(null==n?void 0:n.created_at))return null;let e=new Date(1e3*n.created_at.seconds);return{relative:(0,t5.l)(e,new Date),absolute:(0,t9.WU)(e,"MMM d, yyyy, h:mm a")}},[n]),_=(0,r.useCallback)(e=>{if(e.altKey){window.open(v,"_blank");return}if(b||j){u();return}c("snapshot",{messageId:s,editId:null==n?void 0:n.id,previewUrl:v})},[n,u,b,j,s,v,c]),N=(0,r.useCallback)(e=>{e.stopPropagation(),(null==n?void 0:n.id)&&f(n.id,!!n.bookmarked)},[n,f]),C=(0,r.useMemo)(()=>{if(n){let{commit_message:e,reverted:t}=null!=n?n:{};return(0,a.jsxs)("div",{className:"flex w-full flex-col gap-1 overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-x-2 gap-y-1",children:[(0,a.jsx)("span",{className:"flex items-center gap-1 truncate",children:e}),(j||t)&&!o&&(0,a.jsx)(tP.C,{className:"border-0 py-0",variant:j?"default":"destructive",children:j?"Current":"Reverted"})]}),(0,a.jsx)("span",{className:"text-sm font-normal text-muted-foreground",children:w?(0,a.jsx)(a.Fragment,{children:w.absolute}):b?"Click to Exit Preview":"Click to Preview"})]})}return(0,a.jsxs)("div",{className:"flex w-full flex-col overflow-hidden",children:[(0,a.jsx)("span",{children:"No preview available"}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"\xa0"})]})},[n,b,j,w,o]);return(0,a.jsxs)(y.z,{onClick:_,disabled:!n,className:(0,i.cn)("mb-2 flex h-auto w-full cursor-pointer items-start gap-2 rounded-lg p-3 text-left text-sm font-medium transition-colors duration-150 ease-in-out","border border-muted-border bg-muted text-foreground","hover:border-border hover:bg-muted-hover",{"border-affirmative-primary bg-affirmative hover:border-affirmative-primary hover:bg-affirmative/80":b},{"hover:cursor-auto hover:bg-affirmative":b&&j}),children:[(0,a.jsx)(eJ.Z,{onClick:N,isBookmarked:!!n&&!!n.bookmarked&&(null==n?void 0:n.bookmarked),className:"mt-[3px]"}),C]})});t6.displayName="LegacyPreviewCard";let t7=e=>{var t;let{message:s}=e,r=(0,l.tV)(s.editId);return(null==r?void 0:null===(t=r.diff)||void 0===t?void 0:t.length)?(0,a.jsx)(eQ,{code:{done:!0,parts:r.diff.map(e=>({type:"writing_file",file_path:e.file_path,done:!0,content:e.new_content}))},message:s,edit:r}):(0,a.jsx)("div",{className:"relative w-5/6 max-w-xs",children:(0,a.jsx)(t6,{edit:r,messageId:s.id})})};var t8=s(37355),t4=s(10683);let t3=e=>{let{download:t}=(0,t8.F)(),[s,a]=(0,r.useState)(void 0),{store:n,cacheImageUrl:i}=(0,l.mx)(),o=n.getState().imageUrlCache,d="".concat(e.dir_name,"/").concat(e.file_name),c=(0,r.useRef)(!1);return(0,r.useEffect)(()=>{c.current||(c.current=!0,(async()=>{if(o[d]){a(o[d]);return}let{url:s}=await t({dir_name:e.dir_name,file_name:e.file_name});a(s),i(d,s)})())},[t,e,d,o,i]),s},se=e=>{var t;let{images:s,optimistImageUrls:r}=e,n=s.length+(null!==(t=null==r?void 0:r.length)&&void 0!==t?t:0)===1;return(0,a.jsxs)("div",{className:(0,i.cn)("mb-2 ml-auto flex max-w-[240px] flex-wrap justify-end gap-2 md:max-w-[240px]"),children:[null==r?void 0:r.map((e,t)=>(0,a.jsx)(ss,{imageUrl:e,singleImage:n},t)),s.map((e,t)=>(0,a.jsx)(st,{image:e,singleImage:n},t))]})},st=e=>{let{image:t,singleImage:s}=e,r=t3(t);return(0,a.jsx)(ss,{imageUrl:r,singleImage:s})},ss=e=>{let{imageUrl:t,singleImage:s}=e,{setSelectedImageUrl:n}=(0,l.mx)(),o=(0,t4.Eh)(e=>e.setImages),d=(0,t4.Eh)(e=>e.images),[c,u]=(0,r.useState)(!1),[m,p]=(0,r.useState)(!1),[x,g]=(0,r.useState)(!1),[f,v]=(0,r.useState)(!1),j=(0,w.Z)("md"),b=(0,r.useCallback)(()=>{t&&n(t)},[t,n]),_=(0,r.useCallback)(async e=>{if(e.stopPropagation(),t&&!c){v(!0),setTimeout(()=>v(!1),500);try{let e=await fetch(t),s=await e.blob();await navigator.clipboard.write([new ClipboardItem({[s.type]:s})]),u(!0),D.ZP.capture(M.SL.CHAT.IMAGE_COPIED,{image_type:s.type,image_size:s.size}),setTimeout(()=>{u(!1)},2e3)}catch(e){(0,ei.Eo)("Failed to copy image")}}},[t,c]),N=(0,r.useCallback)(async e=>{if(e.stopPropagation(),t&&!m){if(d.length>=10){eh.Am.error("Image limit reached",{description:"Please limit your message to ".concat(10," images.")});return}v(!0),setTimeout(()=>v(!1),500),p(!0);try{let e=await fetch(t),s=await e.blob(),a="image-".concat(Date.now(),".").concat(s.type.split("/")[1]||"png"),r=new File([s],a,{type:s.type}),n={url:URL.createObjectURL(r),name:a,uploading:!1,uploaded:!1,id:(0,$.Z)()};o(e=>[...e,n]),g(!0),D.ZP.capture(M.SL.CHAT.IMAGE_ADDED_TO_INPUT,{image_type:s.type,image_size:s.size,current_image_count:d.length+1}),setTimeout(()=>{g(!1)},2e3)}catch(e){(0,ei.Eo)("Failed to add image to chat")}finally{p(!1)}}},[t,m,d.length,o]);return(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)(y.z,{variant:"ghost",className:(0,i.cn)("relative inline-block p-0 hover:bg-transparent",{"h-[120px] w-[200px] md:h-[90px] md:w-[160px]":s,"h-24 w-24 md:h-16 md:w-16":!s}),type:"button",disabled:!t,onClick:b,children:t?(0,a.jsxs)("div",{className:"group/image-hover relative h-full w-full",children:[(0,a.jsx)("img",{loading:"lazy",src:t,alt:"chat image",className:"h-full w-full rounded-lg border object-cover"}),!j&&(0,a.jsxs)("div",{className:(0,i.cn)("pointer-events-none absolute inset-0 flex items-center justify-center gap-1 rounded-lg bg-black/50 opacity-0 transition-opacity duration-200",{"group-hover/image-hover:opacity-100":!f,"opacity-100":f}),children:[(0,a.jsx)(y.z,{variant:"secondary",size:"icon-sm",onClick:_,disabled:c,className:"pointer-events-auto h-6 w-6 bg-white/90 text-black hover:bg-white disabled:bg-white/90 disabled:text-black disabled:opacity-100",children:(0,a.jsx)(h.Z,{name:c?"check":"content_copy",className:"h-3 w-3"})}),(0,a.jsx)(y.z,{variant:"secondary",size:"icon-sm",onClick:N,disabled:m||x,className:"pointer-events-auto h-6 w-6 bg-white/90 text-black hover:bg-white disabled:bg-white/90 disabled:text-black disabled:opacity-100",children:(0,a.jsx)(h.Z,{name:x?"check":"add_photo_alternate",className:"h-3 w-3"})})]})]}):(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center rounded-lg border bg-background/80",children:(0,a.jsx)(h.Z,{name:"progress_activity",size:"small",className:"animate-spin"})})})})};var sa=s(36839),sr=s(4918);let sn=e=>{let{content:t,open:s,onOpenChange:r,openText:n,closedText:l}=e;return(0,a.jsxs)(sr.z,{open:s,onOpenChange:r,className:"mt-4 max-w-[300px] overflow-hidden rounded-lg border border-muted-border",children:[(0,a.jsx)(sr.w,{asChild:!0,children:(0,a.jsxs)(y.z,{variant:"secondary",className:(0,i.cn)("h-10 w-full justify-between pr-2 text-sm font-medium transition-all duration-200 ease-out",s&&"rounded-b-none"),children:[s?n:l,(0,a.jsx)(h.Z,{name:s?"unfold_less":"unfold_more",size:"small",className:"transition-transform duration-200 ease-out"})]})}),(0,a.jsx)(d.E.div,{initial:{height:0},animate:{height:s?"auto":0},exit:{height:0},transition:{type:"spring",bounce:0,duration:.4},style:{overflow:"hidden"},children:(0,a.jsx)("pre",{className:"rounded-b-md border-t border-muted-border bg-secondary p-4 py-2 text-sm",children:(0,a.jsx)("code",{className:"block max-h-[300px] overflow-x-auto overflow-y-auto whitespace-pre-wrap break-words",children:t})})})]})},si=e=>{let{messageContent:t}=e,{error:s}=sl(t),[n,i]=(0,r.useState)(!1);return(0,a.jsx)(sn,{content:s,open:n,onOpenChange:i,openText:"Error",closedText:"Error"})};function sl(e){let t=e.match(/([\s\S]+)```([\s\S]+)```\n+$/);return t?{error:t[2].trim(),text:t[1].trim()}:(n.logging.error("no_error_message_found_in_input",{input:e}),{error:"",text:e})}let so=()=>(0,a.jsxs)("div",{className:"w-full rounded-lg border border-muted-border",children:[(0,a.jsxs)("div",{className:"flex h-10 w-full items-center justify-between rounded-b-none px-4 pr-2 text-sm font-medium",children:["Security Review",(0,a.jsx)(h.Z,{name:"security",size:"small"})]}),(0,a.jsx)("div",{className:"rounded-b-md border-t border-muted-border p-4 py-2 text-sm",children:(0,a.jsx)("span",{className:"text-muted-foreground",children:"Analyzing codebase for security vulnerabilities"})})]}),sd=e=>{let{content:t}=e,[s,n]=(0,r.useState)(!1);return(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{children:"Write the code to create a new integration or update the existing integration with Supabase."}),(0,a.jsx)(sn,{content:t,open:s,onOpenChange:n,openText:"Hide detailed instructions",closedText:"Show detailed instructions"})]})},sc=e=>{let{content:t,selectedElements:s,containsError:r,tags:n,isSecurityReview:i}=e;return(0,a.jsxs)("div",{children:[(0,a.jsx)(sp,{selectedElements:s}),i?(0,a.jsx)(so,{}):(0,a.jsx)(sh,{content:t,containsError:r}),(0,a.jsx)(su,{content:t,tags:n})]})},su=e=>{let{content:t,tags:s}=e;return s.includes("supabase-integration-update")?(0,a.jsx)(sd,{content:t}):null},sm=e=>{let{elementType:t}=e,s=(0,sa.a)(t);return s?(0,a.jsx)(h.Z,{name:s,className:"size-4 text-black dark:text-white"}):null},sp=e=>{let{selectedElements:t}=e;return 0===t.length?null:(0,a.jsx)("div",{className:"mb-2 flex flex-wrap gap-2",children:t.map((e,t)=>{var s,r;return(0,a.jsxs)(z.u,{children:[(0,a.jsx)(z.aJ,{asChild:!0,children:(0,a.jsxs)("div",{className:(0,i.cn)((0,y.d)({variant:"outline",size:"sm"}),"flex items-center gap-2 text-xs"),children:[(0,a.jsx)(sm,{elementType:e.elementType}),(0,a.jsx)("span",{children:e.elementType})]})}),(0,a.jsxs)(z._v,{side:"top",children:["Line ",e.lineNumber," in ",null===(r=e.filePath)||void 0===r?void 0:null===(s=r.split)||void 0===s?void 0:s.call(r,"/").pop()]})]},t)})})},sh=e=>{let{content:t,containsError:s}=e,{text:n,error:i}=(0,r.useMemo)(()=>s?sl(t):{text:t,error:null},[t,s]);return(0,a.jsxs)(a.Fragment,{children:[n,i&&(0,a.jsx)(si,{messageContent:t})]})},sx=e=>{let{message:t}=e,{authUser:s}=(0,tY.Eu)(),r=(0,tB.c)(e=>e.collaborators).find(e=>e.id===t.userId),n=(0,tE.hO)(e=>e.membership);if(t.content.includes(ta))return null;let l=(null==r?void 0:r.id)===(null==s?void 0:s.uid)||(null==n?void 0:n.user_id)===(null==s?void 0:s.uid);return(0,a.jsxs)("div",{className:(0,i.cn)("flex flex-col",l?"items-end":"items-start pl-8"),children:[(0,a.jsx)(se,{images:t.images,optimistImageUrls:t.optimistImageUrls}),(0,a.jsx)("div",{className:(0,i.cn)("overflow-wrap-anywhere overflow-auto whitespace-pre-wrap rounded-xl bg-transparent px-0 py-1.5 text-lg leading-[22px] md:text-base",{"max-w-[80%] bg-secondary px-3 py-3":l}),children:(0,a.jsx)(sc,{content:t.content,selectedElements:t.selectedElements,containsError:t.containsError,tags:t.tags,isSecurityReview:t.isSecurityReview})})]})},sg=(0,r.memo)(e=>{let{messageId:t,previousMessageId:s,isLastMessage:o=!1,newMessageMinHeight:d,scrollToEdit:c}=e,u=(0,l.aK)(e=>e.messages[t]),m=(0,l.aK)(e=>e.sortedMessageIds).indexOf(t),p=(0,r.useMemo)(()=>(null==u?void 0:u.type)==="aiMessage"&&(1===m||m<2),[u,m]),h=(0,r.useMemo)(()=>{if(!u)return null;switch(u.type){case"userMessage":return(0,a.jsx)(sx,{message:u});case"userCommit":return(0,a.jsx)(t2,{message:u});case"aiMessage":return(0,a.jsx)(tj,{message:u,isFirstAIMessage:p});case"branchSwitched":return(0,a.jsx)(tb,{branchName:u.branchName});case"revertSuccess":return(0,a.jsx)(t1,{shortCommitHash:u.shortCommitHash,scrollToEdit:c});case"manualEdit":var e;return(0,a.jsxs)("div",{className:"ml-6",children:[(0,a.jsx)(t7,{message:u}),u.errors&&(0,a.jsx)(B,{errors:null!==(e=u.errors)&&void 0!==e?e:null})]});default:return n.logging.error("Unknown message role",{message:u}),null}},[u,p,c]),x=(0,r.useMemo)(()=>({minHeight:o&&d?d+"px":"auto"}),[o,d]);return u?(0,a.jsxs)("div",{className:(0,i.cn)("group flex flex-col pb-4 pr-2",{"pb-20":o&&"aiMessage"===u.type}),"data-message-id":u.id,"data-message-edit-id":sf(u),style:x,id:u.id,children:[(0,a.jsx)(t$,{message:u,previousMessageId:s}),(0,a.jsx)("div",{className:(0,i.cn)({"pl-2":"userMessage"!==u.type,"pl-1 md:pl-0":"aiMessage"===u.type}),children:h})]}):null});sg.displayName="ChatItem";let sf=e=>{if("aiMessage"===e.type)return e.editId}},45060:function(e,t,s){"use strict";s.d(t,{t:function(){return eL}});var a=s(52155),r=s(17195),n=s(98244),i=s(86338),l=s(51117),o=s(81858),d=s(62970),c=s(76816),u=s(76647),m=s(53259),p=s(99792),h=s(69130),x=s(75748),g=s(89671),f=s(4578),v=s(83250),j=s(77658);let b=e=>{let{onFileUpload:t}=e,s=(0,o.T_)("ChatInputActionMenu"),[i,l]=(0,n.useState)(!1),{isMac:b}=(0,h.Z)(),{openSettings:y}=(0,c.r)(),{canEdit:w}=(0,x.t)(),_=(0,u.G)(),N=(0,d.z)(e=>e.showHistory),{setShowHistory:C}=(0,d.VF)();return(0,a.jsxs)(m.h_,{open:i,onOpenChange:l,children:[(0,a.jsx)(m.$F,{asChild:!0,children:(0,a.jsx)("button",{className:(0,f.cn)("flex size-6 items-center justify-center rounded-full border border-muted-border text-muted-foreground outline-none duration-150 ease-out","shrink-0 transition-colors hover:bg-muted-hover",i&&"bg-muted-active"),children:(0,a.jsx)(p.Z,{name:"add",size:"small",className:(0,f.cn)("transition-transform",i&&"rotate-[135deg]")})})}),(0,a.jsxs)(m.AW,{align:"start",className:"min-w-[240px]",children:[_&&(0,a.jsxs)(m.Xi,{onClick:()=>y("github"),children:[(0,a.jsx)(j.xR.GitHub,{className:"h-4 w-4"}),(0,a.jsx)("p",{children:"GitHub"})]}),(0,a.jsxs)(m.Xi,{onClick:()=>{N||r.ZP.capture(g.SL.TABS.HISTORY_OPENED),C(e=>!e)},children:[(0,a.jsx)(p.Z,{name:"history_2"}),(0,a.jsx)("p",{children:s("history")})]}),w&&(0,a.jsxs)(m.Xi,{onClick:()=>y("knowledge"),children:[(0,a.jsx)(p.Z,{name:"school"}),(0,a.jsx)("p",{children:s("knowledge")})]}),w&&(0,a.jsxs)(m.Xi,{onClick:()=>y("project"),children:[(0,a.jsx)(p.Z,{name:"settings"}),(0,a.jsx)("p",{children:s("projectSettings")}),b?(0,a.jsx)(m.KM,{className:"hidden sm:flex",children:"."}):(0,a.jsx)(m.KM,{className:"hidden sm:flex",children:"Ctrl."})]}),_&&(0,a.jsxs)(m.Xi,{onClick:()=>y("supabase"),children:[(0,a.jsx)(v.Z,{className:"h-4 w-auto",viewBox:"0 0 109 113"}),(0,a.jsx)("p",{children:"Supabase"})]}),(0,a.jsx)(m.VD,{}),(0,a.jsxs)(m.Xi,{onClick:t,children:[(0,a.jsx)(p.Z,{name:"add_photo_alternate"}),(0,a.jsx)("p",{children:s("attach")})]})]})]})};var y=s(66112),w=s(73181),_=s(52162),N=s(88182),C=s(71919),k=s(93946),S=s(36839);let E=e=>{let{elementType:t}=e,s=(0,S.a)(t);return s?(0,a.jsx)(p.Z,{name:s,fill:"white",className:"size-4"}):null},I=(0,n.memo)(()=>{let e=(0,C.UC)(e=>e.selectedElements),{removeSelectedElement:t}=(0,C.S9)(),s=e=>{var t,s;return"Line ".concat(e.lineNumber," in ").concat(null===(s=e.filePath)||void 0===s?void 0:null===(t=s.split)||void 0===t?void 0:t.call(s,"/").pop())},[r,i]=(0,n.useState)(null),l=(0,n.useCallback)(()=>{r&&t(r)},[r,t]);return(null==e?void 0:e.length)?(0,a.jsx)("div",{className:"bg-transparent",children:(0,a.jsx)("ul",{className:"flex flex-wrap gap-2",children:(0,a.jsx)(_.M,{mode:"popLayout",children:e.map(e=>(0,a.jsx)(N.E.li,{initial:{opacity:0,scale:.6},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.6,transition:{duration:.15}},transition:{duration:.1,ease:[.5,1,.89,1],opacity:{duration:.1}},layoutId:"".concat(e.filePath,"-").concat(e.lineNumber),children:(0,a.jsx)(k.Z,{label:s(e),side:"top",children:(0,a.jsxs)("button",{className:"flex h-full w-full cursor-pointer items-center gap-0.5 rounded-md p-1 pr-2 hover:bg-background",onMouseEnter:()=>i(e),onMouseLeave:()=>i(null),onClick:l,children:[(0,a.jsx)(_.M,{mode:"wait",children:(0,a.jsx)(N.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"flex-shrink-0",children:r!==e?(0,a.jsx)(E,{elementType:e.elementType}):(0,a.jsx)(p.Z,{name:"close",size:"small"})},r===e?"close":"element")}),(0,a.jsx)("span",{className:"flex-grow select-none truncate text-left text-xs",children:"".concat(e.elementType)})]})})},"".concat(e.filePath,"-").concat(e.lineNumber)))})})}):null});I.displayName="ChatInputSelectElementsRow",(0,n.memo)(e=>{var t,s;let{element:r,onRemoveElement:i}=e,[l,o]=(0,n.useState)(!1);return(0,a.jsx)(k.Z,{label:"Line ".concat(r.lineNumber," in ").concat(null===(s=r.filePath)||void 0===s?void 0:null===(t=s.split)||void 0===t?void 0:t.call(s,"/").pop()),side:"top",children:(0,a.jsxs)("button",{onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),className:"group/select-element flex h-full w-full cursor-pointer items-center gap-0.5 rounded-md p-1 pr-2 hover:bg-background",onClick:()=>i(r),children:[(0,a.jsx)(_.M,{mode:"wait",children:(0,a.jsx)(N.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"flex-shrink-0",children:l?(0,a.jsx)(p.Z,{name:"close",size:"small"}):(0,a.jsx)(E,{elementType:r.elementType})},l?"close":"element")}),(0,a.jsx)("span",{className:"flex-grow select-none truncate text-left text-xs",children:"".concat(r.elementType)})]})})}).displayName="ChatInputSelectElement";var P=s(20827),A=s(93023),z=s(21198),M=s(3989),Z=s(59561),D=s(58915),L=s(84183);let R="chat-mode-nudge-last-shown",T=()=>{try{let e=localStorage.getItem(R);if(!e)return!0;let t=parseInt(e,10);return Date.now()-t>=12096e5}catch(e){return!0}},O=()=>{try{localStorage.setItem(R,Date.now().toString())}catch(e){}},F=e=>{let{projectId:t}=e,s=(0,o.T_)("ChatModeToggle"),{isAgentModeDefault:l}=(0,i.v)(),d=(0,M.hT)(e=>e.chatMode===M.jE.CHAT_ONLY),{setChatMode:c}=(0,M.VK)(),u=(0,z.iY)(),[m,h]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{h(!!(null==u?void 0:u.isStuck)&&!d&&!(null==u?void 0:u.chatOnly)&&T())},[u,d]),(0,a.jsxs)(D.J2,{open:m,children:[(0,a.jsx)(D.xo,{asChild:!0,children:(0,a.jsx)("div",{children:(0,a.jsxs)(L.u,{children:[(0,a.jsx)(L.aJ,{asChild:!0,children:(0,a.jsxs)(Z.z,{type:"button",variant:"outline",size:"sm",onClick:()=>{r.ZP.capture("chat_mode_toggled",{state:d,project_id:t,stuck_popover_shown:m}),h(!1),m&&O(),d&&O(),c(d?l?M.jE.AGENT:M.jE.DEFAULT:M.jE.CHAT_ONLY)},className:(0,f.cn)("flex h-6 gap-1 rounded-full border py-0 pl-1.5 pr-2.5 font-normal text-muted-foreground hover:border-border hover:bg-transparent md:hover:bg-accent md:hover:text-muted-foreground",{"border-affirmative-primary bg-affirmative-primary text-affirmative-primary-foreground hover:border-affirmative-primary hover:bg-affirmative-primary hover:text-affirmative-primary-foreground md:hover:bg-affirmative-primary/90 md:hover:text-affirmative-primary-foreground":d}),children:[(0,a.jsx)(p.Z,{name:"emoji_objects",size:"small"}),s("chat")]})}),(0,a.jsx)(L._v,{className:"hidden max-w-[35ch] md:flex",children:(0,a.jsx)("p",{children:s("chatTooltip")})})]})})}),(0,a.jsxs)(D.yk,{children:[(0,a.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,a.jsx)("p",{className:"font-medium text-popover-foreground",children:s("feelingStuck")}),(0,a.jsx)(p.Z,{name:"close",className:"cursor-pointer text-muted-foreground",onClick:()=>{h(!1),c(M.jE.DEFAULT),O(),r.ZP.capture("stuck_popover_dismissed",{project_id:t,message_id:null==u?void 0:u.id})}})]}),(0,a.jsx)("p",{className:"text-muted-foreground",children:s("useChatMode")})]})]})};var U=s(79151),V=s(10086),W=s(52922),H=s(77162);let K=e=>{let{className:t,disabled:s=!1,isSendingDisabled:r=!1}=e,i=(0,H.v)(),{showStopAction:l,mutation:o}=(0,W.q)({projectId:null!=i?i:void 0}),d=(0,n.useCallback)(async()=>{await o.mutateAsync()},[o]);return i&&(l||o.isPending)?(0,a.jsx)("button",{type:"button",className:(0,f.cn)("flex size-6 items-center justify-center rounded-full bg-foreground text-background transition-opacity duration-150 ease-out disabled:cursor-not-allowed disabled:opacity-50",t),disabled:o.isPending,onClick:d,children:(0,a.jsx)(p.Z,{name:"stop_fill",size:"small"})}):(0,a.jsx)("button",{id:"chatinput-send-message-button",type:"submit",className:(0,f.cn)("flex size-6 items-center justify-center rounded-full bg-foreground text-background transition-opacity duration-150 ease-out disabled:cursor-not-allowed disabled:opacity-50",t),disabled:r||s,children:(0,a.jsx)(p.Z,{name:"arrow_upward_alt_600",size:"default"})})};var q=s(87294),J=s(88515),Y=function(){let e=navigator.userAgent.toLowerCase();return/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(e)},B=s(35127),X=s(22774),G=s(37156);let $=new X.XMLParser({ignoreAttributes:!1,preserveOrder:!0,trimValues:!0}),Q=()=>{let[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)(!1),r=(0,n.useRef)(void 0),i=(0,n.useRef)(void 0),{userData:l}=(0,G.SE)(),o=(0,z.$m)(),d=null==o?void 0:o.messageId,c=null==o?void 0:o.message,u=(0,n.useCallback)(e=>{let t="<lov-actions>",s=e.indexOf(t),a=e.indexOf("</lov-actions>",s);if(-1===s||-1===a)return[];let r=e.substring(s+t.length,a);try{let e=$.parse(r),t=[];return Array.isArray(e)&&e.forEach(e=>{if(e["lov-suggestion"]){var s,a;let r=e["lov-suggestion"],n=null===(s=e[":@"])||void 0===s?void 0:s["@_message"],i=Array.isArray(r)?null===(a=r[0])||void 0===a?void 0:a["#text"]:null==r?void 0:r["#text"];n&&i&&t.push({title:i.trim(),message:n.trim()})}}),t}catch(e){return console.error("Error parsing lov-actions XML:",e),[]}},[]),m=(0,n.useMemo)(()=>c&&"aiMessage"===c.type?u(c.content):[],[c,u]),p=m.length>0;return(0,n.useEffect)(()=>{d&&d!==r.current&&(r.current=d,a(!1),i.current=void 0)},[d]),(0,n.useEffect)(()=>{let e=(null==l?void 0:l.suggestions_enabled)===!0;if(!e){a(!1);return}p&&c&&d&&d!==i.current&&c.persisted&&e&&(t(m),a(!0),i.current=d)},[p,d,c,m,null==l?void 0:l.suggestions_enabled]),{suggestions:e,isVisible:s,hideSuggestions:(0,n.useCallback)(()=>{a(!1)},[])}};var ee=s(98260),et=s(95652),es=s(10683);let ea=e=>{let{suggestions:t,isVisible:s=!0}=e,{store:r}=(0,es.WR)(),i=r(e=>e.setMessage),l=e=>{i(e.message)},[o,d]=(0,n.useState)(!0),[c,u]=(0,n.useState)(!1),m=(0,n.useRef)(null);return((0,n.useEffect)(()=>{let e=m.current;if(!e||!s){d(!0),u(!1);return}e.scrollLeft=0;let t=()=>{d(0===e.scrollLeft),u(e.scrollLeft+e.clientWidth>=e.scrollWidth-1)};return t(),e.addEventListener("scroll",t),()=>e.removeEventListener("scroll",t)},[t,s]),s&&t.length)?(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"relative w-full rounded-t-lg bg-background py-2 pb-2",children:[(0,a.jsx)("div",{ref:m,className:"flex w-full flex-nowrap gap-2 overflow-x-auto px-3 pb-1 scrollbar-hide",children:t.map(e=>(0,a.jsx)(Z.z,{className:"h-7 whitespace-nowrap rounded-lg bg-muted px-3 text-sm font-normal text-foreground hover:bg-muted/80 focus:outline-none",type:"button",onClick:()=>l(e),children:e.title},e.message))}),!c&&(0,a.jsx)("div",{className:"pointer-events-none absolute right-0 top-0 h-full w-24 bg-gradient-to-l from-background to-background/0"}),!o&&(0,a.jsx)("div",{className:"pointer-events-none absolute left-0 top-0 h-full w-24 bg-gradient-to-r from-background to-background/0"})]})}):null};var er=s(33474),en=s(34255),ei=s(55302);let el=(0,en.j)("relative flex w-full flex-col rounded-t-xl md:rounded-t-3xl border border-b-0 bg-background",{variants:{variant:{secondary:"border-border md:border-muted-border",warning:"border-orange-500/50 bg-orange-500/10",error:"border-red-500/50 bg-red-500/10"}},defaultVariants:{variant:"secondary"}}),eo=e=>{let{variant:t,icon:s,title:r,description:n,children:i,primaryAction:l,secondaryAction:o,onDismiss:d,className:c,dismissible:u=!0,hoverContent:m}=e,h=(0,a.jsx)("div",{"data-nudge":!0,className:(0,f.cn)(el({variant:t}),c),children:(0,a.jsxs)("div",{className:"flex w-full items-center justify-between gap-2 pb-2 pl-4 pr-2 pt-2 md:pb-8",children:[(0,a.jsxs)("div",{className:"flex flex-1 items-start gap-2",children:[s&&(0,a.jsx)(p.Z,{name:s,className:(0,f.cn)("mt-0.5 text-base","warning"===t&&"text-warning-primary","secondary"===t&&"text-muted-foreground"),size:"small","aria-label":"warning"===t?"Warning":"Information"}),(0,a.jsxs)("div",{className:"flex flex-1 gap-1",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsx)("span",{className:"text-sm font-normal text-foreground",children:r}),n&&(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:n})]}),i]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[o&&(0,a.jsxs)(Z.z,{variant:o.variant||"outline",size:"sm",onClick:o.onClick,disabled:o.disabled,loading:o.loading,className:"gap-1.5",children:[o.icon&&(0,a.jsx)(p.Z,{name:o.icon,size:"small"}),o.label]}),l&&(0,a.jsxs)(Z.z,{variant:l.variant||"affirmative",size:"sm",onClick:l.onClick,disabled:l.disabled,loading:l.loading,className:"gap-1.5",children:[l.icon&&(0,a.jsx)(p.Z,{name:l.icon,size:"small"}),l.label]}),u&&d&&(0,a.jsx)("button",{type:"button",className:"group flex h-7 w-7 items-center justify-center hover:bg-transparent",onClick:d,children:(0,a.jsx)(p.Z,{name:"close",size:"small",className:"text-muted-foreground group-hover:opacity-50"})})]})]})});return m?(0,a.jsxs)(ei.zs,{children:[(0,a.jsx)(ei.Yi,{asChild:!0,"data-nudge":!0,children:(0,a.jsx)("div",{className:"cursor-pointer",children:h})}),(0,a.jsx)(ei.bZ,{className:"z-[2000] flex w-fit max-w-[560px] rounded-2xl border-muted-border p-4 md:w-[560px]",side:"top",align:"start",sideOffset:8,asChild:!0,children:m})]}):h};var ed=s(71131),ec=s(38864);let eu=e=>{let{projectId:t}=e,{store:s}=(0,es.WR)(),r=s(e=>e.message),[i,l]=(0,n.useState)([]),[o,d]=(0,n.useState)(!1),{openSettings:u}=(0,c.r)(),m=(0,ed.N)(),h=!!m;if((0,n.useEffect)(()=>{if(r){let e=(0,ec.s)(r);l(e),e.length>0&&d(!1)}else l([])},[r]),0===i.length||o)return null;let x=(0,a.jsx)("div",{className:"flex flex-col gap-2",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-foreground",children:"Detected API Keys"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"API keys in messages can be accessed by team members, may appear in support tickets, and are transmitted over the internet."}),(0,a.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:h?"Store them securely in Supabase instead.":"Connect Supabase first to store them securely."})]})});return(0,a.jsx)(eo,{variant:"warning",icon:"warning",title:"Sensitive API key detected",description:h?"Ask Lovable to store API keys as secrets instead of pasting them in messages.":"API keys detected in your message. Connect Supabase first, then ask Lovable to store them securely instead.",onDismiss:()=>{d(!0)},hoverContent:x,children:(0,a.jsxs)("div",{className:"my-2",children:[!h&&(0,a.jsxs)(Z.z,{variant:"outline",size:"sm",onClick:()=>{u("supabase")},children:[(0,a.jsx)(j.xR.Supabase,{className:"h-4 w-4"}),"Connect Supabase"]}),m&&(0,a.jsx)(Z.z,{variant:"outline",size:"sm",asChild:!0,children:(0,a.jsxs)("a",{href:"https://supabase.com/dashboard/project/".concat(m.id,"/settings/functions"),target:"_blank",rel:"noreferrer",children:[(0,a.jsx)(p.Z,{name:"key",className:"h-4 w-4 text-xs"}),(0,a.jsx)("span",{className:"text-xs",children:"Manage Secrets"}),(0,a.jsx)(p.Z,{name:"arrow_outward",className:"h-4 w-4 text-xs text-muted-foreground"})]})}),(0,a.jsx)(Z.z,{variant:"link",size:"sm",asChild:!0,children:(0,a.jsxs)("a",{href:"https://docs.lovable.dev/features/security",target:"_blank",rel:"noreferrer",children:[(0,a.jsx)(p.Z,{name:"help",className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"Learn more about security"}),(0,a.jsx)(p.Z,{name:"arrow_outward",className:"h-4 w-4 text-xs text-muted-foreground"})]})})]})})};var em=s(37298),ep=s(56852);let eh="legacy-mode-nudge-last-shown",ex=[{icon:"code",title:"Smarter Code Edits",description:"90% fewer errors and improved generations"},{icon:"devices",title:"New Capabilities",description:"Web search, image generation and more"},{icon:"trending_up",title:"Adaptive Pricing",description:"Pay based on actions, not messages"}],eg=()=>{try{let e=localStorage.getItem(eh);if(!e)return!0;let t=parseInt(e,10);return Date.now()-t>=864e5}catch(e){return!0}},ef=()=>{try{localStorage.setItem(eh,Date.now().toString())}catch(e){}},ev=e=>{let{projectId:t}=e,s=(0,B.zq)(),{agentModeEnabled:l,setAgentMode:o}=(0,i.v)(),d=(0,M.hT)(e=>e.chatMode)===M.jE.CHAT_ONLY,[c,u]=(0,n.useState)(!1);if((0,n.useEffect)(()=>{u(!l&&eg())},[l]),!s||d||!c)return null;let m=(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("div",{className:"relative hidden w-1/3 flex-shrink-0 md:block",children:(0,a.jsx)(em.default,{src:"/img/announcements/agent-release.png",alt:"Meet Agent Mode",fill:!0,className:"rounded-lg object-cover"})}),(0,a.jsxs)("div",{className:"flex w-2/3 flex-1 flex-col gap-4 py-4",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("p",{className:"text-xl font-medium text-card-foreground",children:"Meet Agent Mode"}),(0,a.jsx)("p",{className:"text-base text-muted-foreground",children:"Here is what's new:"})]}),(0,a.jsx)("div",{className:"flex flex-col gap-4",children:ex.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"mt-0.5 flex h-8 w-8 flex-shrink-0 items-center justify-center rounded-lg bg-secondary",children:(0,a.jsx)(p.Z,{name:e.icon,size:"small",className:"text-secondary-foreground"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium leading-tight text-card-foreground",children:e.title}),(0,a.jsx)("p",{className:"text-sm leading-tight text-muted-foreground",children:e.description})]})]},e.title))}),(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"mt-0.5 flex h-8 w-8 flex-shrink-0 items-center justify-center rounded-lg bg-transparent"}),(0,a.jsx)("div",{children:(0,a.jsx)("p",{className:"text-sm leading-tight text-muted-foreground",children:(0,a.jsxs)(ep.default,{href:"https://lovable.dev/blog/agent-mode-beta",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 hover:underline",children:["Read more ",(0,a.jsx)(p.Z,{name:"arrow_outward",size:"small"})]})})})]})]})]});return(0,a.jsx)(eo,{variant:"secondary",icon:"info",title:"Agent mode produces 90% less errors",primaryAction:{label:"Try Now",onClick:()=>{o(!0),u(!1),ef(),r.ZP.capture("legacy_mode_nudge_activated",{project_id:t})},variant:"affirmative"},onDismiss:()=>{u(!1),ef(),r.ZP.capture("legacy_mode_nudge_dismissed",{project_id:t})},hoverContent:m})};var ej=s(57967),eb=s(45417),ey=s(72163),ew=s(21517),e_=s(26052),eN=s(76332);let eC="supabase-security-nudge-last-shown",ek=()=>{try{let e=localStorage.getItem(eC);if(!e)return!0;let t=parseInt(e,10);return Date.now()-t>=864e5}catch(e){return!0}},eS=()=>{try{localStorage.setItem(eC,Date.now().toString())}catch(e){}},eE=e=>({name:e.name,title:e.name,level:"error"===e.level?"ERROR":"WARN",description:e.description}),eI=e=>{var t,s,i,l,o;let{projectId:d}=e,{openSettings:u}=(0,c.r)(),m=(0,ew.iZ)(e=>e.project),[h,x]=(0,n.useState)(!1),g=(0,B.ZG)(),f=!!(null==m?void 0:null===(t=m.supabase_project_config)||void 0===t?void 0:t.supabase_project_id),{securitySummary:v,scanData:j,isLoading:b}=(0,ey.y)(),{securityWarnings:y,isLoadingWarnings:w,hasSupabaseErrors:_}=(0,ej.N)({projectId:null==m?void 0:m.id,supabaseProjectId:null==m?void 0:null===(s=m.supabase_project_config)||void 0===s?void 0:s.supabase_project_id,setShowPublishConfirmDialog:e=>{},shouldFetchSecurityWarnings:!g&&f}),{handleSecurityReview:N,isSendingSecurityReview:C,isSecurityReviewDisabled:k,securityReviewDisabledReason:S}=(0,eb.C)({projectId:null==m?void 0:m.id}),{errorCount:E,warningCount:I,hasErrors:P,isLoading:A}=g?{errorCount:v.errorCount,warningCount:v.warnCount,hasErrors:v.errorCount>0,isLoading:b}:{errorCount:(null==y?void 0:null===(i=y.supabase)||void 0===i?void 0:i.errors)||0,warningCount:(null==y?void 0:null===(l=y.supabase)||void 0===l?void 0:l.warnings)||0,hasErrors:_,isLoading:w};(0,n.useEffect)(()=>{x(!0===P&&!A&&ek())},[P,A]);let z=()=>{N(),x(!1),r.ZP.capture("supabase_security_nudge_reviewed",{project_id:d,error_count:E,warning_count:I})};if(!h)return null;let M=E+I,D=g?Object.values((null==j?void 0:j.results)||{}).flatMap(e=>e.items||[]).map(eE):(null==y?void 0:null===(o=y.supabase)||void 0===o?void 0:o.details)||[],R=D.filter(e=>"ERROR"===e.level),T=D.filter(e=>"WARN"===e.level),O=P?R:T,F=P?"".concat(E," Error").concat(E>1?"s":""):"".concat(I," Warning").concat(I>1?"s":""),U=(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsxs)("p",{className:"text-xl font-medium text-card-foreground",children:[M," Security Issues Detected"]}),(0,a.jsxs)("p",{className:"text-base text-muted-foreground",children:[P?"Critical errors":"Warnings"," found in your Supabase project:"]})]}),(0,a.jsxs)("div",{className:"max-h-64 overflow-y-auto",children:[O.slice(0,3).map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between py-1.5",children:[(0,a.jsxs)(L.u,{children:[(0,a.jsx)(L.aJ,{asChild:!0,children:(0,a.jsxs)("div",{className:"flex cursor-default items-center gap-1.5",children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:e.title}),(0,a.jsx)(p.Z,{name:"info",size:"small",className:"text-muted-foreground"})]})}),(0,a.jsx)(L._v,{children:(0,a.jsx)("p",{children:e.description})})]}),(0,a.jsx)(e_.C,{variant:"ERROR"===e.level?"destructive":"warning",children:"ERROR"===e.level?"Error":"Warning"})]},e.name)),O.length>3&&(0,a.jsxs)("p",{className:"py-1.5 text-sm font-medium text-muted-foreground",children:["+ ",O.length-3," more"," ",P?"error":"warning",O.length-3>1?"s":"","..."]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsxs)(Z.z,{variant:"secondary",size:"sm",onClick:()=>{var e;let t=null==m?void 0:null===(e=m.supabase_project_config)||void 0===e?void 0:e.supabase_project_id;t&&window.open("".concat("https://supabase.com/dashboard/project/".concat(t,"/advisors/security")).concat(P?"":"?preset=WARN&id="),"_blank","noopener,noreferrer"),r.ZP.capture("supabase_security_nudge_external_view",{project_id:d,error_count:E,warning_count:I})},className:"gap-1.5",children:["View in Supabase",(0,a.jsx)(p.Z,{name:"arrow_outward",size:"small"})]}),(0,a.jsx)(eN.b,{showTooltip:!!S,tooltipContent:S,children:(0,a.jsx)(Z.z,{variant:"affirmative",size:"sm",onClick:z,disabled:k,loading:C,className:"gap-1.5",children:"Security Review"})})]})]});return(0,a.jsx)(eo,{variant:"secondary",icon:"error",title:g?"Security":"Supabase security",primaryAction:{label:"Review",onClick:g?()=>u("security"):z,variant:"affirmative",loading:!g&&C,disabled:!g&&k},onDismiss:()=>{x(!1),eS(),r.ZP.capture("supabase_security_nudge_dismissed",{project_id:d,error_count:E,warning_count:I})},hoverContent:g?void 0:U,children:(0,a.jsx)(e_.C,{variant:P?"destructive":"warning",className:"flex-shrink-0 gap-1",children:F})})};var eP=s(56551),eA=s(35046),ez=s(7287),eM=s(59253),eZ=s(77105);let eD=()=>{let e=(0,H.v)(),t=(0,C.UC)(e=>e.isVisualEditingActive),{setIsVisualEditorPanelOpen:s,turnOffVisualEditing:i}=(0,C.S9)(),{startLiveMode:l}=(0,ez.My)(),{hasUnsavedChanges:o,refreshPreview:d}=(0,ee.v)(),c=(0,eA.A7)(e=>e.clearPendingChanges),{activeView:u}=(0,eM.Z)(),{setBlocker:m,clearBlocker:x}=(0,eZ.sV)(),g=(0,n.useCallback)(()=>{i(),o&&(c(),d()),x(),r.LJ.capture("visual_editor_toggled",{state:!t,project_id:e})},[i,t,e,c,x,d,o]),v=()=>{s(!0),l(),r.LJ.capture("visual_editor_toggled",{state:t,project_id:e})},j=()=>{t?g():v()},b=t&&o,{isMac:y}=(0,h.Z)(),w=b||"preview"!==u;return(0,n.useEffect)(()=>{t&&(b?m({title:"You have unsaved changes",description:"Are you sure you want to exit the visual editor? You will lose your unsaved changes."}):x(),"preview"!==u&&g())},[b,m,x,t,u,g]),(0,eP.y1)("alt+s",e=>{e.preventDefault(),w||j()},{enableOnFormTags:!0},[w,j]),(0,a.jsxs)(L.u,{instant:b,children:[(0,a.jsx)(L.aJ,{className:"flex py-0",type:"button",asChild:!0,children:(0,a.jsxs)(Z.z,{id:"visual-editor-toggle",type:"button",variant:"outline",size:"sm",onClick:j,disabled:w,className:(0,f.cn)("flex h-6 gap-1 rounded-full border py-0 pl-1.5 pr-2.5 font-normal text-muted-foreground hover:border-border hover:bg-transparent md:hover:bg-accent md:hover:text-muted-foreground",{"border-affirmative-primary bg-affirmative-primary text-affirmative-primary-foreground hover:border-affirmative-primary hover:bg-affirmative-primary hover:text-affirmative-primary-foreground md:hover:bg-affirmative-primary/90 md:hover:text-affirmative-primary-foreground":t}),children:[(0,a.jsx)(p.Z,{name:"visual_edits",size:"small"}),"Edit"]})}),(0,a.jsx)(L._v,{children:(0,a.jsx)("p",{children:b?"Save or discard to exit":"Select to edit (".concat(y?"S":"Alt+S",")")})})]})},eL=e=>{let{chatPanelRef:t,children:s}=e,r=(0,d.z)(e=>e.showHistory);return(0,q.Z)("md")?s:r?null:(0,a.jsx)(eT,{chatPanelRef:t})},eR=e=>e.charAt(0).toUpperCase()+e.slice(1),eT=(0,n.memo)(e=>{let{chatPanelRef:t}=e,s=(0,B.zq)(),o=(0,B.Zp)(),d=(0,B.aI)(),{isAgentModeDefault:c}=(0,i.v)(),{setSelectedImageUrl:u}=(0,z.mx)(),{hasUnsavedChanges:m}=(0,ee.v)(),p=(0,H.v)(),h=(0,C.UC)(e=>e.isVisualEditingActive),{setChatMode:x}=(0,M.VK)(),{message:f,sendChatMessage:v,isSendingDisabled:j,AuthDialogComponent:_}=(0,er.i)(),{dropzoneElement:N,openFileUpload:k,getInputProps:S}=(0,J.j)({portalTargetRef:t}),E=h&&m,Z=(0,C.UC)(e=>{var t;return null===(t=e.selectedElements)||void 0===t?void 0:t[0]}),D=Y(),[R,T]=(0,n.useState)(!1),{suggestions:O,isVisible:W,hideSuggestions:q}=Q(),X=(0,n.useCallback)(async()=>{if(q(),(0,ec.G)(f)){r.ZP.capture(g.SL.CHAT.API_KEY_DETECTED,{project_id:p}),T(!0);return}await v()},[p,v,f,q]);return(0,a.jsxs)("div",{className:"flex max-h-[calc(100%-37px)] shrink-0 flex-col overflow-visible",children:[(0,a.jsx)(et.s,{isOpen:R,onDismiss:()=>T(!1),onConfirm:()=>{T(!1),v(),r.ZP.capture(g.SL.CHAT.API_KEY_WARNING_DISMISSED,{project_id:p})}}),d&&(0,a.jsx)(ea,{suggestions:O,isVisible:W}),(0,a.jsx)("div",{className:"relative top-6",children:!D&&p&&(0,a.jsxs)("div",{className:"[&_[data-nudge]:not(:first-child)]:hidden",children:[(0,a.jsx)(eu,{projectId:p}),(0,a.jsx)(eI,{projectId:p}),s&&(0,a.jsx)(ev,{projectId:p})]})}),(0,a.jsxs)(l.x,{className:"relative mr-2 md:mr-0",onSubmit:X,AuthDialogComponent:_,children:[(0,a.jsx)(w.T,{setSelectedImageUrl:u}),!h&&(0,a.jsx)(I,{}),(0,a.jsxs)(L.u,{children:[(0,a.jsx)(L.aJ,{asChild:!0,children:(0,a.jsx)("div",{children:(0,a.jsx)(P.E,{autoSize:!0,minHeight:40,className:"m-1 rounded-md p-0",disabled:E,forceShowPlaceholder:!1,placeholder:Z?"Ask Lovable to modify ".concat(eR(Z.elementType),"..."):"Ask Lovable...",enableSlashCommands:!1,isChatModeActive:!1,onEnableChatMode:()=>x(M.jE.CHAT_ONLY),onDisableChatMode:()=>x(c?M.jE.AGENT:M.jE.DEFAULT)})})}),(0,a.jsx)(L._v,{hidden:!h||!m,children:(0,a.jsx)("p",{children:"Save to continue"})})]}),(0,a.jsx)(A.yo,{}),(0,a.jsxs)(y.s,{children:[(0,a.jsx)("input",{id:"file-upload",className:"hidden",...S()}),N,(0,a.jsx)(b,{onFileUpload:k}),!D&&(0,a.jsx)(eD,{}),(0,a.jsxs)("div",{className:"ml-auto flex items-center gap-1",children:[p&&(0,a.jsx)(F,{projectId:p}),(0,a.jsxs)("div",{className:"ml-1 flex items-center gap-2",children:[(0,a.jsx)(U.r,{}),o&&p?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(V.O,{projectId:p}),(0,a.jsx)(K,{disabled:E,isSendingDisabled:j})]}):(0,a.jsx)(K,{disabled:E,isSendingDisabled:j})]})]})]})]}),(0,a.jsx)("div",{className:"z-10 h-2 w-full bg-background"})]})});eT.displayName="ChatInputV2NormalContent"},41173:function(e,t,s){"use strict";s.d(t,{A:function(){return p}});var a=s(52155),r=s(56852),n=s(98244),i=s(59561),l=s(76332),o=s(14070),d=s(99792),c=s(96659),u=s(22136),m=s(70980);let p=()=>{let e=(0,c.C)(),{mutate:t,isPending:s}=(0,u.I)({skipSafetyCheck:!0}),p=(0,m.bk)(e=>e.editIdToConfirmRestoreFor),{setEditIdToConfirmRestoreFor:h}=(0,m.Xr)(),{disabled:x,disabledReason:g}=(0,n.useMemo)(()=>s?{disabled:!0,disabledReason:"Restore is in progress"}:e?{disabled:!0,disabledReason:(0,a.jsx)("p",{className:"max-w-sm",children:"Cannot transfer project while there is an active operation in progress (e.g. chat or revert). Please wait for the operation to complete."})}:{disabled:!1,disabledReason:null},[e,s]);return(0,a.jsx)(o.Vq,{open:!!p,onOpenChange:e=>!e&&h(void 0),children:(0,a.jsxs)(o.cZ,{children:[(0,a.jsx)(o.fK,{children:(0,a.jsx)(o.$N,{children:"Cant revert database changes"})}),(0,a.jsx)(o.Be,{children:"The database was modified since this version. Lovable cant revert database changes automatically. Youll need to update the database manually."}),(0,a.jsxs)(o.cN,{children:[(0,a.jsx)(i.z,{variant:"outline",children:(0,a.jsxs)(r.default,{href:"https://docs.lovable.dev/integrations/supabase",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 overflow-hidden text-ellipsis whitespace-nowrap",children:[(0,a.jsx)("span",{className:"truncate",children:"Learn more"}),(0,a.jsx)(d.Z,{name:"arrow_outward"})]})}),(0,a.jsx)(l.b,{showTooltip:x,tooltipContent:g,children:(0,a.jsx)(o.GG,{asChild:!0,children:(0,a.jsxs)(i.z,{variant:"affirmative",onClick:()=>t({edit:{id:p}}),disabled:x,children:["Proceed Anyway",s&&(0,a.jsx)(d.Z,{className:"ml-1 animate-spin",name:"progress_activity",size:"small"})]})})})]})]})})}},30025:function(e,t,s){"use strict";s.d(t,{W:function(){return r}});var a=s(98244);let r=e=>{let{listRef:t,containerRef:s}=e,[r,n]=(0,a.useState)(!1),[i,l]=(0,a.useState)(!1),[o,d]=(0,a.useState)(!1),c=(0,a.useCallback)(()=>setTimeout(()=>{if(!t.current)return;let e=t.current.scrollSize-t.current.viewportSize-t.current.scrollOffset<84,s=t.current.scrollOffset<84,a=t.current.scrollSize>t.current.viewportSize;l(e),d(s),n(a)},0),[t]),u=(0,a.useCallback)(()=>{t.current&&t.current.scrollTo(t.current.scrollSize)},[t]);return(0,a.useEffect)(()=>{let e=s.current;if(!e)return;let t=new MutationObserver(c);t.observe(e,{childList:!0,subtree:!0});let a=new ResizeObserver(c);return a.observe(e),c(),()=>{t.disconnect(),a.disconnect()}},[s,c]),{isScrollable:r,isScrolledToEnd:i,isScrolledToStart:o,checkScrollPosition:c,scrollToEnd:u}}},33474:function(e,t,s){"use strict";s.d(t,{i:function(){return v}});var a=s(52155),r=s(98244),n=s(86338),i=s(75970),l=s(39230),o=s(3989),d=s(62797),c=s(11134),u=s(93023),m=s(10683),p=s(76268),h=s(7287),x=s(21517),g=s(71919),f=s(36190);let v=()=>{let{closeVisualEditsPanel:e}=(0,g.S9)(),{agentModeEnabled:t}=(0,n.v)(),{sendChatMessage:s,hasActiveLock:v}=(0,c.O)(),{clearEditorState:j,restoreEditorState:b}=(0,m.WR)(),y=(0,x.iZ)(e=>e.project),{authUser:w}=(0,i.Eu)(),[_,N]=(0,r.useState)(!1),[C,k]=(0,r.useState)(!1),[S,E]=(0,r.useState)(()=>(0,f.Y)()),I=(0,m.Eh)(e=>e.images);(0,m.Eh)(e=>e.setImages);let P=(0,m.Eh)(e=>e.message),A=(0,g.UC)(e=>e.selectedElements),{setSelectedElements:z}=(0,g.S9)(),M=(0,o.hT)(e=>e.chatMode),{setChatMode:Z}=(0,o.VK)(),{startLiveMode:D}=(0,h.My)();(0,r.useEffect)(()=>{let e=setInterval(()=>{E((0,f.Y)())},1e3);return()=>clearInterval(e)},[]),(0,r.useEffect)(()=>{let e=()=>{E((0,f.Y)())};return window.addEventListener("focus",e),()=>window.removeEventListener("focus",e)},[]);let L=(0,r.useMemo)(()=>I.some(e=>!e.uploaded),[I]),R=(0,r.useMemo)(()=>v||C||!y,[v,C,y]),T=(0,r.useMemo)(()=>R||0===P.length||w&&L||(0,u.L0)(P)||S.isRateLimited,[R,P,w,L,S.isRateLimited]),{isAgentModeDefault:O}=(0,n.v)(),F=(0,r.useCallback)(async()=>{if(T)return;if(S.isRateLimited){console.warn("Cannot send message: rate limited");return}if(M===o.jE.CHAT_ONLY&&P.toLowerCase().includes("lov-action")&&Z(O?o.jE.AGENT:o.jE.DEFAULT),!w){N(!0);return}let a={selectedElements:A};k(!0),D();try{e(),await s({body:{id:(0,l.Fd)(),message:P,images:I.map(e=>({image_id:e.id,type:p.V.USER_UPLOAD})),selected_elements:A,optimisticImageUrls:I.map(e=>e.url),chat_only:M===o.jE.CHAT_ONLY,agent_mode:t?"enabled":"disabled"},options:{clear:()=>{j(),z([])},restore:()=>{b(),z(a.selectedElements)}}})}finally{k(!1)}},[T,S.isRateLimited,M,P,w,I,A,D,Z,e,s,j,z,b,t]);return{message:P,sendChatMessage:F,isSendingDisabled:T,isLocked:R,isSubmitting:C,isRateLimited:S.isRateLimited,rateLimitSecondsRemaining:S.secondsRemaining,AuthDialogComponent:(0,a.jsx)(d.o,{open:_,onOpenChange:N})}}},52922:function(e,t,s){"use strict";s.d(t,{q:function(){return u}});var a=s(56166),r=s(98244),n=s(12703),i=s(94671),l=s(96659),o=s(90163),d=s(21198),c=s(17001);function u(e){let{projectId:t}=e,s=(0,i.SJ)(),u=(0,o.b)(),[m,p]=(0,r.useState)(void 0),{addStoppedMessageId:h,setLatestStreamedMessage:x,updateMessage:g}=(0,d.mx)(),f=(0,d.aK)(e=>e.sortedMessageIds),v=(0,d.aK)(e=>e.messages),j=(0,r.useMemo)(()=>null==f?void 0:f.findLast(e=>{var t;return(null===(t=v[e])||void 0===t?void 0:t.type)==="userMessage"}),[f,v]),b=(0,r.useMemo)(()=>null==f?void 0:f.findLast(e=>{var t;return(null===(t=v[e])||void 0===t?void 0:t.type)==="aiMessage"}),[f,v]),y=(0,l.C)(),w=(0,a.D)({mutationFn:async()=>{if(!t)throw Error("No projectId found");if(u){if(!("content"in u))throw Error("Invalid message type");x({...u,stopped:!0})}return s.post("/projects/".concat(t,"/chat/").concat(j,"/cancel"))},onMutate:()=>{let e=b&&v[b];if(e&&"aiMessage"===e.type){let t=e.content===c.u?"This message was cancelled.":e.content;g(b,{...e,content:t,status:"stopped",stopped:!0},!0)}},onSuccess:()=>{h(null==u?void 0:u.id),p(j),x(void 0)},onError:()=>{n.Am.error("Failed to stop message",{description:"Please try again"})}});return{showStopAction:j!==m&&y,mutation:w}}},57480:function(e,t,s){"use strict";s.d(t,{T:function(){return l},r:function(){return o}});var a=s(52155),r=s(98244),n=s(71919);let i=(0,r.createContext)({currentFile:null,states:{},openTabs:[],targetFileAndLineRange:null,setCurrentFile:()=>{},setStates:()=>{},setOpenTabs:()=>{},openFileAtLine:()=>{},openFileAtLineRange:()=>{},clearLineHighlight:()=>{}});function l(e){let{children:t}=e,[s,l]=(0,r.useState)(null),[o,d]=(0,r.useState)({}),[c,u]=(0,r.useState)([]),[m,p]=(0,r.useState)(null),h=(0,n.UC)(e=>e.selectedElements),x=(0,n.UC)(e=>e.isVisualEditingActive),g=(0,r.useCallback)((e,t)=>{let s=t||1;p({filePath:e,startLine:s,endLine:s}),u(t=>t.includes(e)?t:[...t,e]),l(e)},[]),f=(0,r.useCallback)((e,t,s)=>{p({filePath:e,startLine:t,endLine:s||t}),u(t=>t.includes(e)?t:[...t,e]),l(e)},[]),v=(0,r.useCallback)(()=>{p(null)},[]);(0,r.useEffect)(()=>{x||0!==h.length||v()},[x,h,v]);let j=(0,r.useMemo)(()=>({currentFile:s,setCurrentFile:l,states:o,setStates:d,openTabs:c,setOpenTabs:u,targetFileAndLineRange:m,openFileAtLine:g,openFileAtLineRange:f,clearLineHighlight:v}),[s,o,c,m,g,f,v]);return(0,a.jsx)(i.Provider,{value:j,children:t})}let o=()=>{let e=(0,r.useContext)(i);if(void 0===e)throw Error("useCodeEditor must be used within a CodeEditorProvider");return e}},78159:function(e,t,s){"use strict";s.d(t,{p:function(){return L}});var a=s(52155),r=s(98244),n=s(12703),i=s(61222),l=s(99792),o=s(21198),d=s(21517),c=s(30025),u=s(48946),m=s(56959),p=s(59561),h=s(25871),x=s(17176),g=s(4578),f=s(58010),v=s(10990),j=s(59253),b=s(70766);let y=(0,r.memo)(e=>{var t;let{messageId:s,edit:n,isRevertMessage:i,isUnderDaySection:c}=e,{commit_sha:u}=null!=n?n:{},{switchToView:y,exitView:w,activeView:_}=(0,j.Z)(),N=(0,b.VJ)(e=>e.activeEditId),C=(0,o.aK)(e=>e.edits),k=N?C[N]:null,S=(0,d.iZ)(e=>e.project),{toggleBookmark:E}=(0,h.g)((null==S?void 0:S.id)||""),I=(0,r.useMemo)(()=>{if(u&&S)return(0,x.t)({projectId:null==S?void 0:S.id,sha:u})},[u,S]),P=(0,v.Y)({editId:null==n?void 0:n.id,commitSha:null!==(t=null==n?void 0:n.commit_sha)&&void 0!==t?t:void 0}),A=n&&(null==k?void 0:k.id)===(null==n?void 0:n.id)&&"snapshot"===_||P&&!k&&!_,z=(0,r.useMemo)(()=>{if(!(null==n?void 0:n.created_at))return null;let e=new Date(1e3*n.created_at.seconds);return c?(0,f.LJ)(e):(0,f.sb)(e)},[n,c]),M=(0,r.useCallback)(e=>{if(e.altKey){window.open(I,"_blank");return}if(A||P){w();return}y("snapshot",{messageId:s,editId:null==n?void 0:n.id,previewUrl:I})},[n,w,A,P,s,I,y]),Z=(0,r.useCallback)(e=>{e.stopPropagation(),(null==n?void 0:n.id)&&E(n.id,!!n.bookmarked)},[n,E]),{commit_message:D}=null!=n?n:{};return(0,a.jsxs)("div",{className:"flex h-11 min-w-0 items-center gap-1 md:h-10 md:px-3",children:[i?(0,a.jsx)(l.Z,{name:"restart_alt",className:"mb-px text-muted-foreground",size:"small"}):(0,a.jsx)(m.Z,{onClick:Z,isBookmarked:!!n.bookmarked&&(null==n?void 0:n.bookmarked),className:(0,g.cn)(!n.bookmarked&&"md:opacity-0 md:group-hover:opacity-100")}),(0,a.jsx)(p.z,{onClick:M,disabled:!n,className:(0,g.cn)("group flex h-10 w-full cursor-pointer items-center gap-2 rounded-lg px-2.5 text-left text-base font-medium transition-colors duration-150 ease-in-out md:h-9 md:text-sm","min-w-0 bg-background text-foreground hover:bg-muted-hover",{"bg-affirmative text-affirmative-foreground hover:bg-affirmative/80":A&&!i}),children:(0,a.jsxs)("div",{className:"flex w-full min-w-0 items-center justify-between gap-2 overflow-hidden",children:[(0,a.jsx)("div",{className:"flex min-w-0 items-center gap-x-2 gap-y-1 font-normal",children:i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"text-base text-muted-foreground md:text-sm",children:"Restored"}),(0,a.jsx)("div",{className:"min-w-0 gap-1 truncate rounded-sm border border-muted-border bg-background px-2 py-px",children:D})]}):(0,a.jsx)("span",{className:"items-center gap-1 truncate",children:D})}),(0,a.jsx)("span",{className:(0,g.cn)("text-sm font-normal text-muted-foreground md:text-xs",A&&!i&&"text-affirmative-foreground"),children:z&&(0,a.jsx)(a.Fragment,{children:z.absolute})})]})})]})});y.displayName="HistoryCardContent";let w=e=>{let{messageId:t,isUnderDaySection:s=!1}=e,r=(0,o.aK)(e=>e.messages[t]),n=(0,o.tV)((null==r?void 0:r.type)==="aiMessage"||(null==r?void 0:r.type)==="manualEdit"?null==r?void 0:r.editId:void 0),i=(0,o.uO)((null==r?void 0:r.type)==="userCommit"||(null==r?void 0:r.type)==="revertSuccess"?null==r?void 0:r.shortCommitHash:void 0);if(!r||!["aiMessage","manualEdit","userCommit","revertSuccess"].includes(r.type))return null;let l="userCommit"===r.type||"revertSuccess"===r.type?i:n;return l?(0,a.jsx)("div",{className:"group flex flex-col","data-message-id":r.id,"data-message-edit-id":(0,u.Y)(r),children:(0,a.jsx)(y,{messageId:r.id,edit:l,isRevertMessage:"revertSuccess"===r.type,isUnderDaySection:s})}):null};var _=s(18587),N=s(5068),C=s(64493),k=s(17990),S=s(19021),E=s(5520);let I=e=>{let{message:t,edits:s,latestPublishedTimestamp:a}=e,r=s[t.editId];return a&&r?r.created_at.toDate()>a:!a&&!!r},P=e=>{let{message:t,latestPublishedTimestamp:s}=e;return s&&t.createdAt?t.createdAt>s:!s&&!!t.createdAt},A=e=>{let{message:t,edits:s,latestPublishedTimestamp:a}=e;return"revertSuccess"===t.type?I({message:t,edits:s,latestPublishedTimestamp:a}):P({message:t,latestPublishedTimestamp:a})},z=e=>{let{messageIds:t,messages:s}=e,a=new Map;return t.forEach(e=>{let t=s[e];if(!(null==t?void 0:t.createdAt))return;let r=(0,_.WU)(t.createdAt,"yyyy-MM-dd");a.has(r)||a.set(r,[]),a.get(r).push(e)}),a},M=e=>{let{messagesByDate:t}=e,s=(0,N.b)(new Date),a=(0,C.z)(s,{weekStartsOn:1}),r=e=>(0,k.z)(e)?"Today":(0,S.g)(e)?"Yesterday":(0,E._)(e,{start:a,end:s})?(0,_.WU)(e,"EEEE"):(0,_.WU)(e,"MMMM d");return Array.from(t.entries()).sort((e,t)=>{let[s]=e,[a]=t;return a.localeCompare(s)}).map(e=>{let[t,s]=e;return{label:r(new Date(t)),messageIds:s}})},Z=e=>{let{messageIds:t,messages:s}=e;return M({messagesByDate:z({messageIds:t,messages:s})})},D=e=>{let{messageIds:t,getEditByShortCommitHash:s,latestPublishedTimestamp:a}=e,r=(0,o.aK)(e=>e.edits),n=(0,o.aK)(e=>e.messages),i=[],l=[],d=[],c=e=>["manualEdit","aiMessage","revertSuccess","userCommit"].includes(e),u=e=>{if("userCommit"===e.type||"revertSuccess"===e.type){let t=s(e.shortCommitHash);return!!(null==t?void 0:t.bookmarked)}if("editId"in e&&e.editId){let t=r[e.editId];return!!(null==t?void 0:t.bookmarked)}return!1};return t.forEach(e=>{let t=n[e];if(c(t.type)&&("manualEdit"!==t.type&&"aiMessage"!==t.type||t.editId)){if(u(t)&&"revertSuccess"!==t.type&&i.push(e),A({message:t,edits:r,latestPublishedTimestamp:a})){l.push(e);return}(null==t?void 0:t.createdAt)&&d.push(e)}}),{unpublishedMessageIds:l,bookmarkedMessageIds:i,groupedDailyMessageIds:Z({messageIds:d,messages:n}),hasBookmarkedMessages:i.length>0,hasUnpublishedMessages:l.length>0,hasDailyMessages:d.length>0,splitMessageCount:i.length+l.length+d.length}},L=(0,r.memo)(()=>{var e,t;let s=(0,r.useRef)(null),u=(0,r.useRef)(null),m=(0,d.iZ)(e=>e.project),{snapshot:p,loadEarlierEdits:h}=(0,o.mx)(),x=(0,o.aK)(e=>{let t=e.messages;return Object.keys(t).sort((e,s)=>{var a,r,n,i;return((null===(r=t[e])||void 0===r?void 0:null===(a=r.createdAt)||void 0===a?void 0:a.getTime())||0)-((null===(i=t[s])||void 0===i?void 0:null===(n=i.createdAt)||void 0===n?void 0:n.getTime())||0)})}),g=(0,o.aK)(e=>e.edits),f=(0,o.aK)(e=>"loading"===e.loadingEditsStatus),v=(0,o.aK)(e=>e.hasOlderEdits),j=(0,o.aK)(e=>e.canLoadMoreEdits),b=(0,o.uO)(null!==(t=null==m?void 0:m.latest_commit_sha)&&void 0!==t?t:void 0),{isScrolledToEnd:y,checkScrollPosition:_}=(0,c.W)({listRef:u,containerRef:s}),N=(0,r.useMemo)(()=>[...x].reverse(),[x]);(0,r.useEffect)(()=>{y&&v&&j&&h().catch(()=>{n.Am.error("Failed to load earlier edits")})},[y,v,j,h]);let{unpublishedMessageIds:C,groupedDailyMessageIds:k,bookmarkedMessageIds:S,hasBookmarkedMessages:E,hasUnpublishedMessages:I,hasDailyMessages:P,splitMessageCount:A}=D({messageIds:N,latestPublishedTimestamp:(0,r.useMemo)(()=>{var e;let t=null==m?void 0:null===(e=m.published_deployment)||void 0===e?void 0:e.commit_sha;if(!t)return null;let s=Object.values(g).find(e=>e.commit_sha===t);return s?s.created_at.toDate():null},[null==m?void 0:null===(e=m.published_deployment)||void 0===e?void 0:e.commit_sha,g]),getEditByShortCommitHash:p.getEditByShortCommitHash}),z=(0,r.useRef)(void 0);return((0,r.useEffect)(()=>{if(u.current&&A>0&&void 0!==z.current&&z.current<A){let e=u.current.scrollOffset;u.current.scrollTo(e)}z.current=A},[A]),b&&(E||I||P))?(0,a.jsxs)("div",{ref:s,className:"flex min-h-0 flex-1 overflow-y-scroll",children:[(0,a.jsxs)(i.dM,{overscan:5,ref:u,onScroll:()=>{_()},children:[E&&(0,a.jsx)(R,{title:"Bookmarked",children:S.map(e=>(0,a.jsx)(w,{messageId:e},e))}),I&&(0,a.jsx)(R,{title:"Unpublished",children:C.map(e=>(0,a.jsx)(w,{messageId:e},e))}),P&&k.map(e=>{let{label:t,messageIds:s}=e;return(0,a.jsx)(R,{title:t,children:s.map(e=>(0,a.jsx)(w,{messageId:e,isUnderDaySection:!0},e))},t)})]}),f&&(0,a.jsx)("div",{className:"flex items-center justify-center gap-2 text-sm",children:(0,a.jsx)(l.Z,{className:"animate-spin",name:"progress_activity",size:"small"})})]}):null});L.displayName="HistoryPanel";let R=e=>{let{title:t,subtitle:s,children:r}=e;return(0,a.jsxs)("div",{className:"mb-4 mt-2 flex flex-col",children:[(0,a.jsxs)("p",{className:"mb-1 text-lg font-medium md:pl-3 md:text-base",children:[t,s&&(0,a.jsx)("span",{className:"ml-1 text-sm font-normal text-muted-foreground",children:s})]}),r]})}},45417:function(e,t,s){"use strict";s.d(t,{C:function(){return l}});var a=s(54816),r=s(10178),n=s(96659),i=s(84864);let l=e=>{let{projectId:t,setIsOpen:s}=e,l=(0,n.C)(),o=(0,r.mo)({projectId:t,onSuccess:()=>{null==s||s(!1)}}),d=o.isPending,c=l||d;return{isSendingSecurityReview:d,isSecurityReviewDisabled:c,securityReviewDisabledReason:l?"Wait for Lovable to finish working":null,handleSecurityReview:()=>{if(!t){i.logging.error("project id is missing, can't start security review");return}c||o.mutate({body:{message:"Please perform a comprehensive security review of my project.",id:(0,a.Z)(),security_review:!0,chat_only:!0}})}}}},57967:function(e,t,s){"use strict";s.d(t,{N:function(){return i}});var a=s(68820),r=s(98244),n=s(93846);let i=e=>{let{projectId:t,setShowPublishConfirmDialog:s,shouldFetchSecurityWarnings:i,supabaseProjectId:l}=e,{data:o,isLoading:d,isError:c}=(0,a.a)(n.W.securityWarnings({projectId:t,enabled:!!t&&!!l&&i})),u=(0,r.useMemo)(()=>{if(c)return{supabase:{errors:0,warnings:0,success:!1}};if(o){var e,t,s,a,r,n;return{supabase:{errors:null!==(a=null===(e=o.supabase)||void 0===e?void 0:e.errors)&&void 0!==a?a:0,warnings:null!==(r=null===(t=o.supabase)||void 0===t?void 0:t.warnings)&&void 0!==r?r:0,success:!0,details:null!==(n=null===(s=o.supabase)||void 0===s?void 0:s.details)&&void 0!==n?n:[]}}}return null},[o,c]),m=u&&u.supabase.errors+u.supabase.warnings>0,p=u&&u.supabase.errors>0;return{securityWarnings:u,isLoadingWarnings:d,handleReviewIssuesInDialog:()=>{if(s(!1),l){let e=u&&0===u.supabase.errors?"?preset=WARN&id=":"";window.open("".concat("https://supabase.com/dashboard/project/".concat(l,"/advisors/security")).concat(e),"_blank")}},hasSupabaseErrors:p,hasSecurityIssues:m}}},70778:function(e,t,s){"use strict";s.d(t,{A:function(){return a},g:function(){return r}});let a={'pre[class*="language-"]':{color:"#c9d1d9",background:"var(--muted)",fontSize:"13px",fontFamily:'var(--font-roboto-mono), "Roboto Mono", Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace',lineHeight:"1.5",padding:"1em",overflow:"auto"},'code[class*="language-"]':{color:"#c9d1d9",fontSize:"13px",fontFamily:'var(--font-roboto-mono), "Roboto Mono", Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace',lineHeight:"1.5"},comment:{color:"#8b949e"},boolean:{color:"#ff7b72"},number:{color:"#79c0ff"},constant:{color:"#79c0ff"},operator:{color:"#7ee787"},keyword:{color:"oklch(0.833 0.145 321.434)"},function:{color:"#d2a8ff"},variable:{color:"#c9d1d9"},"class-name":{color:"#ffa657"},"type-name":{color:"#ffa657"},"attr-name":{color:"#79c0ff"},string:{color:"#a5d6ff"},tag:{color:"#7ee787"},punctuation:{color:"#7ee787"},selector:{color:"#7ee787"},namespace:{color:"#c9d1d9"},regex:{color:"#ff7b72"},escape:{color:"#a5d6ff"},"::selection":{background:"#2d333b"}},r={'pre[class*="language-"]':{color:"#24292e",background:"var(--background)",fontSize:"13px",fontFamily:'var(--font-roboto-mono), "Roboto Mono", Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace',lineHeight:"1.5",padding:"1em",overflow:"auto"},'code[class*="language-"]':{color:"#24292e",fontSize:"13px",fontFamily:'var(--font-roboto-mono), "Roboto Mono", Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace',lineHeight:"1.5"},comment:{color:"#6e7781"},boolean:{color:"#cf222e"},number:{color:"#0550ae"},constant:{color:"#0550ae"},operator:{color:"#116329"},keyword:{color:"#3479E5"},function:{color:"#8250df"},"class-name":{color:"#953800"},"attr-name":{color:"#0550ae"},string:{color:"#0a3069"},tag:{color:"#116329"},punctuation:{color:"#116329"},"::selection":{background:"#C7E4FF"}}},96895:function(e,t,s){"use strict";s.d(t,{C:function(){return n}});var a=s(72371),r=s(98244);function n(e){let[t,s]=(0,r.useState)(0),[n,i]=(0,r.useState)(0),[l,o]=(0,r.useState)(e);return(0,r.useLayoutEffect)(()=>{l!==e&&(o(e),i(t))},[e,l,t]),(0,r.useEffect)(()=>{let t=e.split("").length-n,r=(0,a.j)(n,e.split("").length,{duration:Math.max(.1,Math.min(5,t/140)),bounce:0,onUpdate(e){s(Math.floor(e))}});return()=>r.stop()},[n,e]),e.split("").slice(0,t).join("")}},71131:function(e,t,s){"use strict";s.d(t,{N:function(){return n}});var a=s(29895),r=s(21517);function n(){var e,t;let s=(0,r.iZ)(e=>e.project),n=null==s?void 0:s.supabase_project_config,i=(0,a.S)({workspaceId:null!==(t=null==s?void 0:s.workspace_id)&&void 0!==t?t:""}),l=function(e,t){if(e.isLoading||!t||!e.supabaseOrganizations)return!1;if(e.noOrganizations)return!0;let s=e.supabaseOrganizations.find(e=>e.id===t.supabase_organization_id);return!s||"connected"!==s.status}(i,n),o=null===(e=i.supabaseOrganizations)||void 0===e?void 0:e.flatMap(e=>e.projects||[]);return!l&&o&&(null==n?void 0:n.supabase_project_id)&&o.find(e=>e.id===n.supabase_project_id)||null}},90163:function(e,t,s){"use strict";s.d(t,{U:function(){return d},b:function(){return o}});var a=s(95713),r=s(98244),n=s(92361),i=s(21198);let l=e=>{if(e.created_at&&!(e.created_at instanceof a.EK)){let{seconds:t,nanoseconds:s}=e.created_at;return{...e,created_at:new a.EK(t,s)}}return e},o=()=>{let e=(0,i.aK)(e=>e.latestStreamedMessage);return e?l(e):null},d=e=>{let{projectId:t,messageId:s}=e,[i,l]=(0,r.useState)(null);return(0,r.useEffect)(()=>{if(!t||!s)return;let e=(0,a.JU)(n.db,"projects",t,"trajectory",s);return(0,a.cf)(e,e=>{e.exists()?l(e.data()):l(null)})},[t,s]),i}},22136:function(e,t,s){"use strict";s.d(t,{I:function(){return p}});var a=s(56166),r=s(12703),n=s(77162),i=s(94671),l=s(84864),o=s(70766),d=s(70980),c=s(95713),u=s(98244),m=s(92361);let p=e=>{let{setIsSomeRevertMutationPending:t}=(0,d.Xr)(),s=(0,i.SJ)(),p=(0,n.D)(),{setActiveEditId:h}=(0,o.RA)(),{isRevertSafe:x}=function(e){let{projectId:t}=e,s=(0,u.useCallback)(async e=>{let{targetEditId:s}=e,a=await (0,c.QT)((0,c.JU)(m.db,"projects",t,"edits",s));if(!a.exists())return l.logging.warn("invalid_edit_id_for_supabase_revert_check",{editId:s}),!0;let r=a.data();return(await (0,c.PL)((0,c.IO)((0,c.hJ)(m.db,"projects",t,"trajectory"),(0,c.ar)("created_at",">",r.created_at),(0,c.ar)("sql_run_state","in",["running","succeeded"]),(0,c.Xo)("created_at","desc"),(0,c.b9)(1)))).empty},[t]);return{isRevertSafe:(0,u.useCallback)(e=>{let{targetEditId:t}=e;return s({targetEditId:t})},[s])}}({projectId:p}),{setEditIdToConfirmRestoreFor:g}=(0,d.Xr)(),f=async t=>{let{edit:a,dry_run:r,via_undo:n}=t,i=a.id;if(a.revert_target_edit_id&&(i=a.revert_target_edit_id),!(null==e?void 0:e.skipSafetyCheck)&&!await x({targetEditId:i}))return null;let l={edit_id:i,dry_run:r,via_undo:n};return s.post("/projects/".concat(p,"/revert-to-edit"),l)};return(0,a.D)({mutationFn:f,onMutate:()=>{t(!0)},onSuccess:(t,s)=>{var a;if(!t){g(s.edit.revert_target_edit_id||s.edit.id);return}if(!s.via_undo){let e=t.commit_message;void 0===e&&t.tags&&(e=t.tags.summary);let s=e?"Restored to earlier version: ".concat(e):"Restored to earlier version";r.Am.success("Success",{description:s})}null==e||null===(a=e.onSuccess)||void 0===a||a.call(e),h(t.id)},onError:e=>{var t;l.logging.error("could_not_revert_to_earlier_version",{error:e}),r.Am.error("Could not revert to earlier version",{description:null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.detail})},onSettled:()=>{t(!1)}})}},10990:function(e,t,s){"use strict";s.d(t,{Y:function(){return n}});var a=s(21198),r=s(21517);let n=e=>{var t;let s=(0,r.iZ)(e=>e.project),n=(0,a.uO)(null!==(t=null==s?void 0:s.latest_commit_sha)&&void 0!==t?t:void 0);return e.commitSha===(null==s?void 0:s.latest_commit_sha)||(null==n?void 0:n.type)=="revert"&&n.revert_target_edit_id==e.editId}},35046:function(e,t,s){"use strict";s.d(t,{A7:function(){return m},TO:function(){return c},ag:function(){return u}});var a=s(52155),r=s(98244),n=s(67801),i=s(70786);let l=e=>({files:{},pendingChanges:{},isLoading:!1,isSyncing:!1,lastSyncTimestamp:void 0,syncError:void 0,uploads:[],projectId:e,searchQuery:"",expandedSearchFiles:new Set,sidebarTab:"files"}),o=e=>(0,n.Ue)()((0,i.n)((t,s)=>({...l(e),setFile:(e,s)=>t(t=>({files:{...t.files,[e]:s}})),removeFile:e=>t(t=>{let{[e]:s,...a}=t.files;return{files:a}}),updateFileContent:(e,s)=>t(t=>({files:{...t.files,[e]:s}})),setSyncing:e=>t({isSyncing:e,lastSyncTimestamp:e?void 0:Date.now()}),setSyncError:e=>t({syncError:e,isSyncing:!1}),setLoading:e=>t({isLoading:e}),addPendingChange:e=>{let{path:s,content:a}=e;return t(e=>({pendingChanges:{...e.pendingChanges,[s]:a}}))},removePendingChange:e=>t(t=>{let{[e]:s,...a}=t.pendingChanges;return{pendingChanges:a}}),clearPendingChanges:()=>t({pendingChanges:{}}),hasUnsavedChanges:()=>{let{pendingChanges:e}=s();return Object.keys(e).length>0},reset:()=>t({...l(s().projectId)}),addUpload:e=>t(t=>({uploads:[...t.uploads,e]})),clearUploads:()=>t({uploads:[]}),setSearchQuery:e=>t({searchQuery:e}),setExpandedSearchFiles:e=>t({expandedSearchFiles:e}),setSidebarTab:e=>t({sidebarTab:e})}))),d=(0,r.createContext)(null),c=e=>{let{children:t,projectId:s}=e,n=(0,r.useRef)(o(s)),i=(0,r.useCallback)(()=>n.current.getState().pendingChanges,[]),l=(0,r.useCallback)(()=>n.current.getState().files,[]),c={store:n.current,snapshot:{getPendingChanges:i,getFiles:l}};return(0,a.jsx)(d.Provider,{value:c,children:t})};function u(){let e=(0,r.useContext)(d);if(!e)throw Error("useCodeEditorContext must be used within a CodeEditorProvider");return e}function m(e){let{store:t}=u();return t(e)}},62970:function(e,t,s){"use strict";s.d(t,{VF:function(){return d},f6:function(){return o},z:function(){return c}});var a=s(52155),r=s(98244),n=s(67801);let i=()=>(0,n.Ue)(()=>({showHistory:!1})),l=(0,r.createContext)(null),o=e=>{let{children:t}=e,s=(0,r.useRef)(i()),n={store:s.current,setShowHistory:e=>{let t=s.current,a=t.getState(),r="function"==typeof e?e(a.showHistory):e;t.setState({showHistory:r})}};return(0,a.jsx)(l.Provider,{value:n,children:t})};function d(){let e=(0,r.useContext)(l);if(!e)throw Error("useHistoryContext must be used within a HistoryProvider");return e}function c(e){let{store:t}=d();return t(e)}},28069:function(e,t,s){"use strict";s.d(t,{$:function(){return r},eP:function(){return c},gu:function(){return m},zp:function(){return u}});var a,r,n=s(52155),i=s(98244),l=s(67801);(a=r||(r={})).PREVIEW="preview",a.CHAT="chat";let o=()=>(0,l.Ue)(()=>({view:"chat",isPreviewDocked:!0,showHistoryPanel:!1})),d=(0,i.createContext)(null),c=e=>{let{children:t}=e,s=(0,i.useRef)(o()),a={store:s.current,setView:e=>{let t=s.current;"function"==typeof e?t.setState(t=>({view:e(t.view)})):t.setState({view:e})},setIsPreviewDocked:e=>{let t=s.current;"function"==typeof e?t.setState(t=>({isPreviewDocked:e(t.isPreviewDocked)})):t.setState({isPreviewDocked:e})}};return(0,n.jsx)(d.Provider,{value:a,children:t})};function u(){let e=(0,i.useContext)(d);if(!e)throw Error("useMobileContext must be used within a MobileProvider");return e}function m(e){let{store:t}=u();return t(e)}},98260:function(e,t,s){"use strict";s.d(t,{P:function(){return x},v:function(){return g}});var a=s(52155),r=s(17195),n=s(98244),i=s(13273),l=s(94671),o=s(56792),d=s(30646),c=s(84864),u=s(35046),m=s(7287),p=s(21517);let h=(0,n.createContext)(null);function x(e){let{children:t}=e,{refreshPreview:s,startLiveMode:x}=(0,m.My)(),g=(0,u.A7)(e=>e.setFile),f=(0,u.A7)(e=>e.pendingChanges),v=(0,u.A7)(e=>e.reset),j=(0,u.A7)(e=>e.clearPendingChanges),b=(0,u.A7)(e=>e.addPendingChange),y=(0,n.useRef)(null),w=(0,p.iZ)(e=>{var t;return null===(t=e.project)||void 0===t?void 0:t.id}),_=(0,u.A7)(e=>e.files),N=(0,n.useMemo)(()=>Object.entries(_),[_]),C=(0,u.A7)(e=>e.uploads),[k,S]=(0,n.useState)(!1),[E,I]=(0,n.useState)(null),[P,A]=(0,n.useState)([]),[z,M]=(0,n.useState)([]),{snapshot:Z}=(0,u.ag)(),D=(0,n.useCallback)(()=>{N&&A((0,o.x2)(N))},[N]);(0,n.useEffect)(()=>{D()},[D]);let[L,R]=(0,n.useState)(!1),T=(0,n.useCallback)(()=>{R(!0),x()},[x,R]),O=(0,m.vE)();(0,n.useEffect)(()=>{if(!L||!O)return;let e=new URL("/_sandbox/code/ws",O);return y.current=new WebSocket(e),y.current.onmessage=e=>{try{let{type:t,data:s}=JSON.parse(e.data);if("init_code"===t)v(),S(!0),s.forEach(e=>{let[t,s]=e;g(t,s)});else if("file_update"===t){let e=Z.getFiles();s.forEach(t=>{let[s,a]=t;e[s]!==a&&g(s,a)})}}catch(e){c.logging.error("Error processing WebSocket message",{project_id:w,error:e})}},y.current.onclose=e=>{e.wasClean||c.logging.error("Code WebSocket closed prematurely",{project_id:w,event:e})},y.current.onerror=e=>{c.logging.error("Code WebSocket error",{project_id:w,error:e})},()=>{var e;null===(e=y.current)||void 0===e||e.close(),y.current=null}},[O,w,v,g,L,Z]);let F=(0,n.useCallback)(async function(e){let{commitMessage:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.ZP.capture("visual_edits:sync_started");let s=Object.entries(e);if(!w)throw Error("No project id");if(0===s.length)throw Error("No changes to sync");try{let e=(0,l.SJ)(),a=await Promise.all(C.map(e=>(0,d.Sv)({dir_name:e.dir_name,file_name:e.id}).then(t=>({download_url:t.url,file_id:e.file_name})))),r=await e.post("/projects/".concat(w,"/edit-code"),{changes:s.map(e=>{let[t,s]=e;return{path:t,content:s}}),uploads:a,commit_message:t||null});if("error"in r&&r.error)throw Error("Failed to sync code");j()}catch(e){(0,i.Eo)(e),r.ZP.capture("visual_edits:sync_failed",{error:e instanceof Error?e.message:"Unknown error",changes:null==s?void 0:s.map(e=>{let[t,s]=e;return[t,s.length]}),project_id:w})}},[w,C,j]),U=Object.keys(f).length>0;return(0,a.jsx)(h.Provider,{value:{syncCode:F,ast:P,code:N,generateAst:D,refreshPreview:s,startLiveMode:T,history:z,setHistory:M,currentClassName:E,setCurrentClassName:I,addPendingChange:b,hasUnsavedChanges:U,hasInitialCode:k},children:t})}function g(){let e=(0,n.useContext)(h);if(!e)throw Error("useSandboxCode must be used within a SandboxCodeProvider");return{code:e.code,syncCode:e.syncCode,ast:e.ast,generateAst:e.generateAst,refreshPreview:e.refreshPreview,enableServer:e.startLiveMode,history:e.history,setHistory:e.setHistory,currentClassName:e.currentClassName,setCurrentClassName:e.setCurrentClassName,addPendingChange:e.addPendingChange,hasUnsavedChanges:e.hasUnsavedChanges,hasInitialCode:e.hasInitialCode}}},71919:function(e,t,s){"use strict";s.d(t,{NE:function(){return d},S9:function(){return c},UC:function(){return u}});var a=s(52155),r=s(98244),n=s(67801),i=s(70786);let l=()=>(0,n.Ue)()((0,i.n)(()=>({selectedElements:[],isVisualEditingActive:!1,isPickAndEditActive:!1,customPromptValue:"",isSaving:!1,activeEditContent:null,floatingInputState:{isVisible:!1,position:null},visualEditsPanelState:{isOpen:!1,position:null},lastPanelPosition:null}))),o=(0,r.createContext)(null),d=e=>{let{children:t}=e,s=(0,r.useRef)(l()),n={store:s.current,setSelectedElements:e=>{s.current.setState(t=>{t.selectedElements=e})},removeSelectedElement:e=>{s.current.setState(t=>{t.selectedElements=t.selectedElements.filter(t=>t.filePath!==e.filePath||t.lineNumber!==e.lineNumber)})},turnOffVisualEditing:()=>{s.current.setState(e=>{e.isVisualEditingActive=!1,e.isPickAndEditActive=!1,e.selectedElements=[],e.isSaving=!1,e.visualEditsPanelState={isOpen:!1,position:null},e.floatingInputState={isVisible:!1,position:null}})},setIsVisualEditorPanelOpen:e=>{let t=s.current;"function"==typeof e?t.setState(t=>{t.isVisualEditingActive=e(t.isVisualEditingActive)}):t.setState(t=>{t.isVisualEditingActive=e})},setIsPickAndEditActive:e=>{let t=s.current;"function"==typeof e?t.setState(t=>{t.isPickAndEditActive=e(t.isPickAndEditActive)}):t.setState(t=>{t.isPickAndEditActive=e})},showFloatingInput:e=>{s.current.setState(t=>{t.floatingInputState={isVisible:!0,position:e}})},showVisualEditsPanel:e=>{s.current.setState(t=>{t.visualEditsPanelState={isOpen:!0,position:e},t.lastPanelPosition=e})},closeVisualEditsPanel:()=>{s.current.setState(e=>{e.visualEditsPanelState={isOpen:!1,position:null},e.customPromptValue="",e.selectedElements=[]})},hideVisualEditsPanel:()=>{s.current.setState(e=>{e.visualEditsPanelState.isOpen&&(e.lastPanelPosition=e.visualEditsPanelState.position),e.visualEditsPanelState={isOpen:!1,position:null}})},setCustomPromptValue:e=>{s.current.setState(t=>{t.customPromptValue=e})},setIsSaving:e=>{s.current.setState(t=>{t.isSaving=e})},setActiveEditContent:e=>{s.current.setState(t=>{t.activeEditContent=e})}};return(0,a.jsx)(o.Provider,{value:n,children:t})};function c(){let e=(0,r.useContext)(o);if(!e)throw Error("useVisualEditorContext must be used within a VisualEditorProvider");return e}function u(e){let{store:t}=c();return t(e)}},52078:function(e,t,s){"use strict";s.d(t,{Ny:function(){return d},U1:function(){return n},fA:function(){return i},oo:function(){return o},pr:function(){return l}});var a=s(98689);let r=()=>"https://console.firebase.google.com/u/0/project/".concat(a.q.projectId,"/firestore/databases/-default-/data"),n=e=>"".concat(r(),"/~2Fprojects~2F").concat(e),i=e=>e?"".concat(r(),"/~2Fusers~2F").concat(e):"",l=(e,t)=>"".concat(n(e),"~2Ftrajectory~2F").concat(t),o=(e,t)=>"".concat(n(e),"~2Fedits~2F").concat(t),d=e=>"".concat(r(),"/~2Fworkspaces~2F").concat(e)},76647:function(e,t,s){"use strict";s.d(t,{G:function(){return n}});var a=s(26047),r=s(75748);let n=()=>{let{canEdit:e,isWorkspaceMember:t}=(0,r.t)(),s=(0,a.v)();return t&&e||s}},93946:function(e,t,s){"use strict";var a=s(52155);s(98244);var r=s(84183);t.Z=e=>{let{children:t,label:s,side:n="bottom"}=e;return(0,a.jsxs)(r.u,{children:[(0,a.jsx)(r.aJ,{asChild:!0,children:t}),(0,a.jsx)(r._v,{className:"z-[2001]",side:n,children:s})]})}},4918:function(e,t,s){"use strict";s.d(t,{w:function(){return n},z:function(){return r}});var a=s(32315);let r=a.fC,n=a.wy;a.Fw},69130:function(e,t,s){"use strict";var a=s(98244);t.Z=()=>{let[e,t]=(0,a.useState)("");return(0,a.useEffect)(()=>{t(r())},[]),{isMac:"mac"===e,isWindows:"windows"===e,isLinux:"linux"===e}};let r=()=>{let e=window.navigator.userAgentData,t=window.navigator.userAgent,s={iphone:/iphone/,ipad:/ipad|macintosh/,android:/android/},a={windows:/win/,mac:/macintosh/,linux:/linux/};if(t){let e=t.toLowerCase().replace(/^mozilla\/\d\.\d\W/,""),r=Object.keys(s).find(t=>s[t].test(e)&&window.navigator.maxTouchPoints>=1),n=Object.keys(a).find(t=>a[t].test(e));return r||n}return e?e.platform.toLowerCase():""}},25871:function(e,t,s){"use strict";s.d(t,{g:function(){return p}});var a=s(56166),r=s(17195),n=s(98244),i=s(12703),l=s(21198),o=s(62970),d=s(35938),c=s(13273),u=s(94671),m=s(89671);let p=e=>{let{updateEdit:t}=(0,l.mx)(),{setShowHistory:s}=(0,o.VF)(),p=(0,a.D)({mutationFn:async t=>{let{editId:s,bookmarked:a,previousValue:r}=t;try{let t=(0,u.SJ)();return await t.put("/projects/".concat(e,"/bookmark/").concat(s),{bookmarked:a}),{editId:s,bookmarked:a}}catch(e){throw e}},onError:(e,s)=>{if(t(s.editId,{bookmarked:s.previousValue}),e instanceof d.H){let t=s.bookmarked?"bookmark":"unbookmark";i.Am.error("Failed to ".concat(t," edit"),{description:e.message||"Please try again"});return}(0,c.Eo)(e)},onSuccess:e=>{i.Am.success(e.bookmarked?"Bookmarked to history":"Bookmark removed from history",{action:{label:"View history",onClick:()=>s(!0)}})}});return{toggleBookmark:(0,n.useCallback)(function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=!s;r.ZP.capture(a?m.SL.BOOKMARK.ADDED:m.SL.BOOKMARK.REMOVED),t(e,{bookmarked:a}),p.mutate({editId:e,bookmarked:a,previousValue:s})},[p,t]),isToggling:p.isPending}}},56792:function(e,t,s){"use strict";s.d(t,{EE:function(){return h},H2:function(){return u},R5:function(){return o},Rw:function(){return l},Xu:function(){return c},cB:function(){return m},x2:function(){return i},xA:function(){return x}});var a=s(91302),r=s(23519),n=s(8209);function i(e){let t=[];return e.map(e=>{let s,[r,n]=e;if(r.endsWith(".tsx")||r.endsWith(".ts")||r.endsWith(".jsx")||r.endsWith(".js")){try{s=(0,a.parse)(n,{sourceFilename:r,sourceType:"module",plugins:["jsx","typescript"],allowImportExportEverywhere:!0})}catch(e){return}t.push({filePath:r,ast:s})}}),t}function l(e,t){let s=e.children.find(e=>n.isJSXText(e));s?s.value=t:e.children.unshift(n.jsxText(t))}function o(e,t){Object.keys(t).forEach(s=>{e.openingElement.attributes=e.openingElement.attributes.filter(e=>{var t;return n.isJSXAttribute(e)&&(null===(t=e.name)||void 0===t?void 0:t.name)!==s}),e.openingElement.attributes.push(n.jsxAttribute(n.jsxIdentifier(s),n.stringLiteral(t[s])))})}let d=e=>n.isStringLiteral(e)?e.value:null;function c(e){let t=e.openingElement.attributes.find(e=>n.isJSXAttribute(e)&&"className"===e.name.name);return void 0===t?"":(null==t?void 0:t.value)?d(t.value):null}let u=(e,t)=>{let s=t.find(t=>t.filePath===e.filePath);if(!s)return!1;let a=!1;return(0,r.default)(s.ast,{JSXElement(t){var s;if((null===(s=t.node.loc)||void 0===s?void 0:s.start.line)===e.lineNumber&&n.isJSXElement(t.node)){let e=t.node.children;a=1===e.length&&n.isJSXText(e[0]),t.stop()}}}),a},m=(e,t,s)=>{let a=t.find(t=>t.filePath===e.filePath);if(!a)return!1;let i=!1;return(0,r.default)(a.ast,{JSXElement(t){var a;(null===(a=t.node.loc)||void 0===a?void 0:a.start.line)===e.lineNumber&&n.isJSXElement(t.node)&&(i=t.node.openingElement.attributes.some(e=>{var t;return n.isJSXAttribute(e)&&n.isStringLiteral(e.value)&&(null===(t=e.name)||void 0===t?void 0:t.name)===s}),t.stop())}}),i},p=(e,t,s)=>{let a=s.find(e=>e.filePath===t);if(!a)return null;let n=null;return(0,r.default)(a.ast,{JSXElement(t){var s;(null===(s=t.node.loc)||void 0===s?void 0:s.start.line)===e&&(n=t.node,t.stop())}}),n},h=(e,t)=>{let s=p(e.lineNumber,e.filePath,t);return s?c(s):null},x=(e,t)=>{let s=t.find(t=>t.filePath===e.filePath);if(!s)return null;let a=null,n=null;return((0,r.default)(s.ast,{JSXElement(t){var s;(null===(s=t.node.loc)||void 0===s?void 0:s.start.line)===e.lineNumber&&(a=t.node.loc.start.line,n=t.node.loc.end.line,t.stop())}}),null===a||null===n)?null:{startLine:a,endLine:n}}},36839:function(e,t,s){"use strict";s.d(t,{B:function(){return i},a:function(){return r}});let a={text:"format_size",img:"image",button:"crop_16_9",link:"link",div:"select"},r=e=>a[n(e)],n=e=>["p","span","h1","h2","h3","h4","h5","h6"].includes(e)?"text":"img"===e?"img":"button"===e?"button":"a"===e?"link":"div",i=e=>n(e.elementType)},25649:function(e){e.exports={cursor:"PromptBox_cursor__MuO9l",blink:"PromptBox_blink__F53p4",customProse:"PromptBox_customProse__C94Rw"}}}]);