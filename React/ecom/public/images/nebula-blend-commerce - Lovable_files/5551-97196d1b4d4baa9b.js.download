try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},s=(new e.Error).stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="e5dd5ed1-30d2-4c14-9eb8-641c0492d32a",e._sentryDebugIdIdentifier="sentry-dbid-e5dd5ed1-30d2-4c14-9eb8-641c0492d32a")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5551],{10416:function(e,s,t){t.d(s,{g:function(){return u},s:function(){return f}});var a=t(52155),r=t(98244),n=t(5449),i=t(40248),l=t(14070),o=t(77658),c=t(75970),d=t(45776),m=t(33877);function u(e){let{dialogDescription:s}=e,t=(0,d.useCurrentWorkspaceStore)(e=>e.currentWorkspace),r=(0,d.useCurrentWorkspaceStore)(e=>e.hasFetchedCurrentWorkspace),n=(0,d.useCurrentWorkspaceStore)(e=>e.membership),{authUser:i}=(0,c.Eu)(),l=null==n?void 0:n.role;return(0,m.MD)()?(0,a.jsx)(h,{dialogDescription:s}):(0,a.jsx)(p,{hasFetchedWorkspace:r,dialogDescription:s,myWorkspaceRole:l,workspace:t,isLoggedIn:!!i})}function h(e){let{dialogDescription:s}=e,t=(0,m.hO)(e=>e.projectWorkspace),r=(0,m.hO)(e=>e.membership),n=null==r?void 0:r.role,{authUser:i}=(0,c.Eu)(),l=(0,m.hO)(e=>e.hasFetchedProjectWorkspace);return(0,a.jsx)(p,{dialogDescription:s,myWorkspaceRole:n,workspace:t,hasFetchedWorkspace:l,isLoggedIn:!!i})}function p(e){let{dialogDescription:s,myWorkspaceRole:t,workspace:c,hasFetchedWorkspace:d,isLoggedIn:m}=e,u=!!c,{title:h,description:p}=(0,r.useMemo)(()=>d&&!u?{title:"Error",description:"Something went wrong."}:{title:"Upgrade required",description:s||"Upgrade to Pro and unlock more features & usage"},[d,u,s]);return(0,a.jsxs)(l.cZ,{className:"max-h-[90vh] overflow-y-auto md:max-w-3xl",size:"lg",children:[(0,a.jsxs)(l.fK,{children:[(0,a.jsx)(o.xx,{className:"mb-1 size-9 shrink-0"}),(0,a.jsx)(l.$N,{className:"text-2xl",children:m?h:"Upgrade required"}),(0,a.jsx)(l.Be,{className:"text-sm",children:m?p:s||"Upgrade to Pro and unlock more features & usage"})]}),m?d?c?(0,a.jsx)(n.om,{planCardContext:"outOfCredits",workspace:c,myWorkspaceRole:t,children:(0,a.jsx)(i.S,{showEnterprise:!1})}):(0,a.jsx)(f,{}):(0,a.jsx)(n._M,{}):(0,a.jsx)(n.om,{planCardContext:"loggedOut",myWorkspaceRole:void 0,children:(0,a.jsx)(i.S,{showEnterprise:!1})})]})}let f=()=>(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{children:"We couldn't load the data needed to upgrade your workspace."}),(0,a.jsxs)("p",{children:["Please refresh the page and try again. If the problem continues, contact our"," ",(0,a.jsx)("a",{href:"/support",className:"underline",children:"Support"}),"."]})]})},72124:function(e,s,t){t.d(s,{s:function(){return h}});var a=t(52155),r=t(98244),n=t(56551),i=t(12703),l=t(59561),o=t(53259),c=t(99792),d=t(45694),m=t(25483);let u=e=>{var s,t;let{selectedRole:n,onRoleChange:i,roleOptions:d,disabled:m=!1}=e,[u,h]=(0,r.useState)(!1);return m?(0,a.jsx)(l.z,{variant:"ghost",size:"sm",className:"flex-shrink-0 gap-1.5 font-normal",disabled:!0,children:null===(t=d.find(e=>e.value===n))||void 0===t?void 0:t.label}):(0,a.jsxs)(o.h_,{open:u,onOpenChange:h,children:[(0,a.jsx)(o.$F,{asChild:!0,children:(0,a.jsxs)(l.z,{variant:"ghost",size:"sm",className:"flex-shrink-0 gap-1.5 font-normal",children:[null===(s=d.find(e=>e.value===n))||void 0===s?void 0:s.label,(0,a.jsx)(c.Z,{name:"keyboard_arrow_down",size:"small"})]})}),(0,a.jsx)(o.AW,{children:(0,a.jsx)(o._x,{value:n,onValueChange:e=>{i(e),h(!1)},children:d.map(e=>(0,a.jsx)(o.qB,{value:e.value,className:"hover:bg-accent",children:e.label},e.value))})})]})},h=e=>{let{onInvite:s,isInviting:t,roleOptions:o,defaultRole:c,canSelectRoles:h=!0,placeholder:p="Add emails",completelyDisabled:f=!1,onInputChange:x}=e,[v,g]=(0,r.useState)([]),[j,b]=(0,r.useState)(""),[y,w]=(0,r.useState)(c),_=v.length>0||""!==j.trim(),k=async()=>{let e=[...v],t=j.trim();if(""===t||v.includes(t)||(e.push(t),g(e),b("")),0===e.length)return;if(e.length>0&&!e.every(e=>(0,d.Jh)(e))){1===e.length?i.Am.error("Invalid email address",{description:"Please check the email address and try again."}):i.Am.error("Invalid email address",{description:"One or more email addresses are invalid. Please check and try again."});return}let{success:a}=await s({emails:e,role:y});a&&(g([]),b(""),null==x||x(""))};(0,n.y1)("mod+enter",e=>{e.preventDefault(),t||k()},{enableOnFormTags:!0});let N=""===j.trim()&&0===v.length;return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(m.B,{tags:v,setTags:g,inputValue:j,setInputValue:e=>{b(e),null==x||x(e)},placeholder:p,disabled:f,className:"min-w-0 flex-1"}),_&&(0,a.jsx)(u,{selectedRole:y,onRoleChange:w,roleOptions:o,disabled:!h||f}),(0,a.jsx)(l.z,{onClick:k,variant:"affirmative",className:"flex-shrink-0",disabled:t||N||f,loading:t,children:"Invite"})]})}},11515:function(e,s,t){t.d(s,{Q:function(){return l}});var a=t(52155),r=t(60468),n=t(26052),i=t(4578);let l=e=>{let{id:s,username:t,displayName:l,photoURL:o,avatarClassName:c,actionComponent:d,email:m,isCurrentUser:u=!1,isInvited:h=!1,showBadge:p=!0}=e;return(0,a.jsxs)("div",{className:"flex items-center justify-start gap-3 py-1 md:flex-nowrap",children:[(0,a.jsx)(r.Y,{className:(0,i.cn)(c,h&&"opacity-60"),user:{id:s,username:null!=l?l:m},photoURL:o,isInteractive:!1}),(0,a.jsx)("div",{className:"flex min-w-0 flex-shrink items-center gap-4 ".concat(h&&"opacity-60"),children:(0,a.jsxs)("div",{className:"flex min-w-0 flex-col gap-0",children:[(0,a.jsxs)("div",{className:"flex-shrink truncate text-sm font-medium leading-tight",children:[l," ",u&&(0,a.jsx)("span",{className:"font-normal",children:"(you)"})]}),(0,a.jsx)("span",{className:"max-w-[150px] flex-shrink truncate text-xs text-muted-foreground",children:m})]})}),h&&p&&(0,a.jsx)(n.C,{variant:"outline",className:"hidden gap-1 bg-muted text-xs font-medium text-muted-foreground md:flex",children:"Invite sent"}),d&&(0,a.jsx)("div",{className:"ml-auto flex-shrink-0",children:d})]})}},59882:function(e,s,t){var a=t(52155),r=t(98244),n=t(59561),i=t(14070);s.Z=e=>{let{title:s="Remove",targetName:t,descriptionTemplate:l="Are you sure you want to remove {name}? They will no longer have access.",confirmButtonText:o="Remove",cancelButtonText:c="Cancel",onConfirm:d,onCancel:m}=e,[u,h]=(0,r.useState)(!1),p=async()=>{h(!0);try{await d()}finally{h(!1)}},f=l.replace("{name}",t);return(0,a.jsxs)(i.cZ,{size:"sm",children:[(0,a.jsxs)(i.fK,{children:[(0,a.jsx)(i.$N,{children:s}),(0,a.jsx)(i.Be,{children:f})]}),(0,a.jsxs)(i.cN,{className:"gap-2 sm:justify-end",children:[(0,a.jsx)(n.z,{variant:"outline",onClick:m,disabled:u,children:c}),(0,a.jsx)(n.z,{variant:"destructive",onClick:p,disabled:u,loading:u,children:u?"Removing...":o})]})]})}},18895:function(e,s,t){t.d(s,{I:function(){return X},C:function(){return ee}});var a=t(52155),r=t(56852),n=t(33877),i=t(73517),l=t(68820),o=t(94671);let c=e=>(0,l.a)({queryKey:["workspace",e,"maxSeats"],queryFn:async()=>{let s=(0,o.SJ)();return(await s.get("/workspaces/".concat(e,"/max-seats"))).max_seats},enabled:!!e});var d=t(98244),m=t(75970),u=t(45776),h=t(72124),p=t(59561),f=t(99792),x=t(3011),v=t(47149),g=t(44647),j=t(16125);let b=e=>"owner"===e,y=e=>"admin"===e,w=e=>(0,g.Ll)(e.plan),_={ADD_EDITOR:"claim.workspace.add_editor",ADD_ADMIN:"claim.workspace.add_admin",SEE_USAGE:"claim.workspace.see_usage",MANAGE_PLAN:"claim.workspace.manage_plan",REMOVE_EDITOR:"claim.workspace.remove_editor",REMOVE_ADMIN:"claim.workspace.remove_admin",PROJECT_MAGIC_LINK:"claim.project.magic_link"};class k{canEmailInvite(){return this.claims.has(_.ADD_EDITOR)}canSetInviteRole(){return this.claims.has(_.ADD_ADMIN)}canEditRole(){let{targetRole:e}=this.context;return y(e)?this.claims.has(_.REMOVE_ADMIN):this.claims.has(_.REMOVE_EDITOR)&&!b(e)}canSeeUsage(){return this.claims.has(_.SEE_USAGE)}canCreateSecretLink(){return this.claims.has(_.PROJECT_MAGIC_LINK)}canManagePlan(){return this.claims.has(_.MANAGE_PLAN)}canRemoveMember(){let{targetRole:e}=this.context;return y(e)?this.claims.has(_.REMOVE_ADMIN):this.claims.has(_.REMOVE_EDITOR)&&!b(e)}constructor(e){this.context=e,this.claims=new Set;let{role:s}=e,t=w(e.workspace);"free"===t?b(s)&&(this.claims.add(_.ADD_EDITOR),this.claims.add(_.SEE_USAGE),this.claims.add(_.MANAGE_PLAN),this.claims.add(_.REMOVE_EDITOR),this.claims.add(_.PROJECT_MAGIC_LINK)):(b(s)?(this.claims.add(_.ADD_EDITOR),this.claims.add(_.ADD_ADMIN),this.claims.add(_.SEE_USAGE),this.claims.add(_.MANAGE_PLAN),this.claims.add(_.REMOVE_EDITOR),this.claims.add(_.REMOVE_ADMIN),this.claims.add(_.PROJECT_MAGIC_LINK)):y(s)&&(this.claims.add(_.ADD_EDITOR),this.claims.add(_.SEE_USAGE),this.claims.add(_.REMOVE_EDITOR),this.claims.add(_.PROJECT_MAGIC_LINK)),"pro"!==t&&"ktlo"!==t||b(s)||this.claims.delete(_.PROJECT_MAGIC_LINK))}}let N=e=>new k(e),E=e=>{let{workspace:s,authUserId:t,role:a,targetRole:r}=e;return(0,d.useMemo)(()=>{let e={workspace:s,isWorkspaceOwner:t===s.owner_id,role:a,targetRole:r},n=N(e);return{canEmailInvite:()=>n.canEmailInvite(),canSetInviteRole:()=>n.canSetInviteRole(),canEditRole:()=>n.canEditRole(),canSeeUsage:()=>n.canSeeUsage(),canCreateSecretLink:()=>n.canCreateSecretLink(),canManagePlan:()=>n.canManagePlan(),canRemoveMember:()=>n.canRemoveMember(),isWorkspaceOwner:e.isWorkspaceOwner}},[s,t,a,r])};var I=t(18587),C=t(60468),M=t(42690),D=t(33864);let S=e=>{let{workspace:s,memberships:t}=e,r=new Date().getMonth()+1,n=new Date().getFullYear(),{data:i}=(0,l.a)(M.t.workspaceUsage({workspaceId:null==s?void 0:s.id,month:r,year:n})),{data:o}=(0,l.a)(M.t.workspaceUserTotalUsage({workspaceId:null==s?void 0:s.id})),c=(0,d.useMemo)(()=>null==o?void 0:o.map(e=>{let s=t.find(s=>s.user_id===e.user_id);return s?{...e,membership:s}:null}).filter(e=>null!==e).sort((e,s)=>s.count-e.count),[o,t]),m=(0,d.useMemo)(()=>null==i?void 0:i.user_usages.map(e=>{let s=t.find(s=>s.user_id===e.user_id);return s?{...e,membership:s}:null}).filter(e=>null!==e).sort((e,s)=>s.count-e.count),[i,t]);return(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsxs)("p",{className:"pb-2 text-sm text-muted-foreground",children:["Showing usage for"," ",(0,I.WU)(new Date(n,r-1),"MMMM yyyy"),"."]}),(0,a.jsx)("div",{className:"flex flex-col gap-2",children:(null==m?void 0:m.length)===0?(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"No usage data for this period. Usage will appear here once members begin using the workspace."}):null==m?void 0:m.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(C.Y,{user:{id:e.user_id,username:e.membership.display_name||e.membership.email},photoURL:e.membership.photo_url}),(0,a.jsx)("p",{className:"text-sm font-medium",children:e.membership.display_name||e.membership.email})]}),(0,a.jsxs)("div",{className:"text-muted-foreground",children:[(0,D.H)(e.count)," credit",1===e.count?"":"s"," used"]})]},e.user_id))}),c&&c.length>0&&(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"border-t pt-4",children:[(0,a.jsx)("p",{className:"pb-2 text-sm text-muted-foreground",children:"Total usage across all months."}),(0,a.jsx)("div",{className:"flex flex-col gap-2",children:c.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(C.Y,{user:{id:e.user_id,username:e.membership.display_name||e.membership.email},photoURL:e.membership.photo_url}),(0,a.jsx)("p",{className:"text-sm font-medium",children:e.membership.display_name||e.membership.email})]}),(0,a.jsxs)("div",{className:"font-medium text-muted-foreground",children:[(0,D.H)(e.count)," credit",1===e.count?"":"s"," total"]})]},e.user_id))})]})})]})};var R=t(11515),A=t(19214),P=t(59882),L=e=>{let{memberName:s,onConfirm:t,onCancel:r}=e;return(0,a.jsx)(P.Z,{title:"Remove workspace member",targetName:s,descriptionTemplate:"Are you sure you want to remove ".concat(s," from this workspace? They will no longer have access to any workspace projects or resources."),onConfirm:t,onCancel:r})},O=t(53259),T=t(7575),z=t(84183),q=t(35127),W=t(29605),U=t(56166),K=t(13273),F=t(7653),G=t(67005);let Z={owner:"Owner",admin:"Admin",member:"Editor"},J={owner:"Owners can manage all collaborators, projects, and integrations.",admin:"Admins can manage editors, projects, and integrations.",member:"Editors can only create and edit projects."},Q=e=>{var s,t;let{currentMembership:r,workspaceId:n,memberships:i,workspace:l}=e,[c,h]=(0,d.useState)(null!==(s=r.monthly_credit_limit)&&void 0!==s?s:void 0),[v,g]=(0,d.useState)(!1),j=(0,d.useRef)(null),{authUser:b}=(0,m.Eu)(),y=r.user_id===(null==b?void 0:b.uid),w=(0,A.z)(L),_=(0,u.useCurrentWorkspaceStore)(e=>e.membership),k=null==_?void 0:_.role,N=!r.joined_at||""===r.joined_at,I=E({workspace:l,authUserId:null==b?void 0:b.uid,role:k,targetRole:r.role}),C=I.canEditRole()&&!y&&!N,{updateWorkspaceMemberRole:M}=function(e){let{workspaceId:s}=e,t=(0,W.NL)(),a=(0,F.b)(),{mutateAsync:r}=(0,U.D)({mutationFn:async e=>{let{userId:t,role:a}=e,r=(0,o.SJ)();await r.put("/user/workspaces/".concat(s,"/memberships/").concat(t),{role:a})},onMutate:async e=>{await (0,G.dG)(t,s),(0,G.yt)(t,s,a,s=>s.map(s=>s.user_id===e.userId?{...s,role:e.role}:s))},onSettled:()=>{(0,G.T6)(t,s)}});return{updateWorkspaceMemberRole:r}}({workspaceId:n}),{updateWorkspaceMemberCreditLimit:D}=function(e){let{workspaceId:s}=e,t=(0,W.NL)(),a=(0,F.b)(),{mutateAsync:r}=(0,U.D)({mutationFn:async e=>{let{userId:t,monthlyCreditLimit:a}=e,r=(0,o.SJ)();await r.put("/user/workspaces/".concat(s,"/memberships/").concat(t),{monthly_credit_limit:null!=a?a:-1})},onMutate:async e=>{await (0,G.dG)(t,s),(0,G.yt)(t,s,a,s=>s.map(s=>s.user_id===e.userId?{...s,monthly_credit_limit:-1===e.monthlyCreditLimit?null:e.monthlyCreditLimit}:s))},onError:e=>{(0,K.Eo)(e)},onSettled:()=>{(0,G.T6)(t,s,a)}});return{updateWorkspaceMemberCreditLimit:r}}({workspaceId:n}),{removeWorkspaceMember:S}=function(e){let{workspaceId:s}=e,t=(0,W.NL)(),a=(0,F.b)(),{mutateAsync:r}=(0,U.D)({mutationFn:async e=>{let{userId:t}=e,a=(0,o.SJ)();await a.delete("/workspaces/".concat(s,"/memberships/").concat(t))},onMutate:async e=>{await (0,G.dG)(t,s),(0,G.yt)(t,s,a,s=>s.filter(s=>s.user_id!==e.userId),void 0,e=>Math.max(0,e-1))},onError:e=>{(0,K.Eo)(e)},onSettled:()=>{(0,G.T6)(t,s,a)}});return{removeWorkspaceMember:r}}({workspaceId:n}),P=(0,d.useCallback)(async e=>{N||await D({userId:r.user_id,monthlyCreditLimit:isNaN(null!=e?e:0)?-1:e})},[r.user_id,N,D]);(0,d.useEffect)(()=>{let e=e=>{v&&j.current&&!j.current.contains(e.target)&&P(c).then(()=>{g(!1)})};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[v,c,D,P]);let Q=async e=>{N||await M({userId:r.user_id,role:e})},V=()=>{w({childProps:{memberName:r.display_name||r.username,onConfirm:async()=>{await S({userId:r.user_id}),w(!1)},onCancel:()=>w(!1)}})},B=(0,q.Tj)(),Y=(0,a.jsxs)(a.Fragment,{children:[["owner","admin"].includes(null!=k?k:"")&&B&&(0,a.jsxs)(z.u,{delayDuration:600,children:[(0,a.jsx)(z.aJ,{children:(0,a.jsx)(a.Fragment,{children:v?(0,a.jsxs)("div",{ref:j,className:"relative flex items-center",children:[(0,a.jsx)(x.I,{placeholder:"Limit / month",value:c||"",className:"max-w-32 pr-8 text-xs",onChange:e=>h(parseInt(e.target.value)),onKeyDown:e=>{if("Enter"===e.key)P(c).then(()=>{g(!1)});else if("Escape"===e.key){var s;h(null!==(s=r.monthly_credit_limit)&&void 0!==s?s:void 0),g(!1)}},autoFocus:!0}),(0,a.jsx)(p.z,{variant:"ghost",size:"icon",className:"absolute right-0.5 h-8 w-8 shadow-none hover:bg-accent hover:shadow-none",onClick:()=>{P(c).then(()=>{g(!1)})},children:(0,a.jsx)(f.Z,{name:"check",size:"small"})})]}):(0,a.jsx)(p.z,{variant:"ghost",size:"sm",className:"text-xs shadow-none hover:bg-accent hover:shadow-none",onClick:()=>g(!0),children:(null==r?void 0:r.monthly_credit_limit)?"".concat(r.monthly_credit_limit," credits/mo"):"No limit"})})}),(0,a.jsx)(z._v,{className:"max-w-[30ch]",children:"Update credit limits for this member"})]}),(0,a.jsxs)(O.h_,{children:[(0,a.jsxs)(z.u,{children:[(0,a.jsx)(z.aJ,{children:(0,a.jsx)(O.$F,{asChild:!0,disabled:y||!I.canRemoveMember(),children:(0,a.jsxs)(p.z,{"aria-haspopup":"true",variant:"ghost",children:[N?"Pending":Z[r.role]," ",(0,a.jsx)(f.Z,{name:"keyboard_arrow_down",size:"small",className:"opacity-50"})]})})}),(0,a.jsx)(z._v,{className:"max-w-[30ch]",children:N?"This user has been invited to join as ".concat(Z[r.role]):J[r.role]})]}),(0,a.jsx)(O.AW,{align:"end",children:N?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(T.w,{label:"Pending",isSelected:!0,onClick:()=>{},disabled:!0}),(0,a.jsx)(T.w,{label:"Remove",destructive:!0,onClick:V})]}):(0,a.jsxs)(a.Fragment,{children:[I.canSetInviteRole()&&(0,a.jsx)(T.w,{label:"Admin",isSelected:"admin"===r.role,onClick:()=>Q("admin"),disabled:!C,tooltip:J.admin}),(0,a.jsx)(T.w,{label:"Editor",isSelected:"member"===r.role,onClick:()=>Q("member"),disabled:!C,tooltip:J.member}),(0,a.jsx)(T.w,{label:y?"Leave":"Remove",destructive:!0,onClick:V})]})})]})]});return(0,a.jsx)(R.Q,{id:r.user_id,username:r.username,displayName:null!==(t=r.display_name)&&void 0!==t?t:r.email,photoURL:r.photo_url,avatarClassName:"h-8 w-8",actionComponent:Y,isCurrentUser:y,email:r.email,isInvited:N})},V=[{value:"admin",label:"Admin"},{value:"member",label:"Editor"}],B=[{label:"All",value:"all"},{label:"Active",value:"active"},{label:"Pending",value:"pending"}],Y=e=>{let{currentPage:s,totalPages:t,onPreviousPage:r,onNextPage:n,onFirstPage:i,onLastPage:l,totalCount:o,pageSize:c}=e;if(t<=1)return null;let d=Math.min(s*c,o);return(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Showing ",(s-1)*c+1,"-",d," of ",o," members"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(p.z,{variant:"outline",size:"sm",onClick:i,disabled:1===s,children:(0,a.jsx)(f.Z,{name:"first_page",className:"h-4 w-4"})}),(0,a.jsx)(p.z,{variant:"outline",size:"sm",onClick:r,disabled:1===s,children:(0,a.jsx)(f.Z,{name:"chevron_left",className:"h-4 w-4"})}),(0,a.jsxs)("span",{className:"text-sm font-medium",children:[s," of ",t]}),(0,a.jsx)(p.z,{variant:"outline",size:"sm",onClick:n,disabled:s===t,children:(0,a.jsx)(f.Z,{name:"chevron_right",className:"h-4 w-4"})}),(0,a.jsx)(p.z,{variant:"outline",size:"sm",onClick:l,disabled:s===t,children:(0,a.jsx)(f.Z,{name:"last_page",className:"h-4 w-4"})})]})]})},$=e=>{var s;let{memberships:t,workspace:r,searchParams:n,search:i,total:l,isLoading:o,PAGE_SIZE:c}=e,{authUser:b}=(0,m.Eu)(),[y,w]=(0,d.useState)(n.status||"all"),[_,k]=(0,d.useState)(n.query||""),N=(0,v.N)(_,250);(0,d.useEffect)(()=>{let e=N;e.length<3&&(e=""),i({query:e,offset:0,status:y})},[N,y,i]);let I=(0,u.useCurrentWorkspaceStore)(e=>e.membership),C=null==I?void 0:I.role,M=E({workspace:r,authUserId:null==b?void 0:b.uid,role:C}),D="free"===(0,g.Ll)(r.plan),{inviteWorkspaceMember:R,isInvitingMember:A}=(0,j.B)({workspaceId:r.id}),P=async e=>{let{emails:s,role:t}=e;if(0===s.length)return{success:!1};let a=0,r=D?"member":t;for(let e of s)await R({email:e,role:r}),a++;return{success:a>0}},L=e=>{k(e)},O=e=>{w(e)};return(0,a.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("h4",{className:"text-sm font-medium",children:"Invite new members"}),(0,a.jsx)(h.s,{onInvite:e=>{let{emails:s,role:t}=e;return P({emails:s,role:t})},isInviting:A,roleOptions:V,canSelectRoles:M.canSetInviteRole(),defaultRole:"member",placeholder:"Add emails",completelyDisabled:!M.canEmailInvite()})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h4",{className:"text-sm font-medium",children:"Members"}),(_||"all"!==y)&&(0,a.jsxs)("span",{className:"text-sm text-muted-foreground",children:[l," members found"]})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(f.Z,{name:"search",className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,a.jsx)(x.I,{type:"text",placeholder:"Search members by name or email...",value:_,onChange:e=>L(e.target.value),className:"pl-9"}),_&&(0,a.jsx)(p.z,{variant:"ghost",size:"sm",className:"absolute right-1 top-1/2 h-6 w-6 -translate-y-1/2 p-0",onClick:()=>L(""),children:(0,a.jsx)(f.Z,{name:"close",className:"h-3 w-3"})})]}),(0,a.jsx)("div",{className:"flex gap-2",children:B.map(e=>{let{label:s,value:t}=e;return(0,a.jsx)(p.z,{variant:y===t?"default":"outline",size:"sm",onClick:()=>O(t),className:"text-xs",children:s},t)})}),(0,a.jsx)("div",{className:"flex flex-col gap-2 border-b pb-3",children:o?(0,a.jsx)("div",{className:"flex items-center justify-center py-8 text-sm text-muted-foreground",children:"Loading members..."}):t.length>0?t.map(e=>e?(0,a.jsx)(Q,{currentMembership:e,workspaceId:r.id,memberships:t,workspace:r},"".concat(e.email,"-").concat(e.user_id)):null):(0,a.jsx)("div",{className:"flex items-center justify-center py-8 text-sm text-muted-foreground",children:_||"all"!==y?"No members found".concat(_?' for "'.concat(_,'"'):""):"No members found"})}),(0,a.jsx)(Y,{currentPage:Math.floor((null!==(s=n.offset)&&void 0!==s?s:0)/c)+1,totalPages:Math.ceil(l/c),onPreviousPage:()=>{var e;return i({offset:Math.max(0,(null!==(e=n.offset)&&void 0!==e?e:0)-c)})},onNextPage:()=>{var e;return i({offset:(null!==(e=n.offset)&&void 0!==e?e:0)+c})},onFirstPage:()=>i({offset:0}),onLastPage:()=>i({offset:Math.floor((l-1)/c)*c}),totalCount:l,pageSize:c})]}),M.canSeeUsage()&&t&&(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("h4",{children:"Usage"}),(0,a.jsx)(S,{workspace:r,memberships:t})]})]})};var H=t(21354);let X=20,ee=e=>{let{workspace:s}=e,t=(0,n.MD)(),{members:r,total:i,isLoading:l,search:o,searchParams:c}=(0,H.qB)({workspaceId:s.id});return t?(0,a.jsx)(et,{workspace:s,members:r,total:i,isLoading:l,search:o,searchParams:c}):(0,a.jsx)(es,{workspace:s,members:r,total:i,isLoading:l,search:o,searchParams:c})};function es(e){let{workspace:s,members:t,total:n,isLoading:l,search:o,searchParams:d}=e,{data:m,isLoading:u}=c(s.id),{memberCount:h}=(0,H.qI)({workspaceId:s.id,status:"all"}),p=s.name||"Workspace",f=(0,a.jsxs)(a.Fragment,{children:["Inviting people to ",(0,a.jsx)("strong",{children:p})," gives access to workspace shared projects and credits. You're using ",h,"/",u?"...":m," seats. Need more?"," ",(0,a.jsx)(r.default,{className:"underline",target:"_blank",href:"https://enterpriseform.lovable.app/",children:"Contact us"}),"."]});return(0,a.jsx)(i.tM,{title:"People",value:"people",description:f,docsLink:"https://docs.lovable.dev/user-guides/teams",children:(0,a.jsx)(F.x,{searchParams:d,children:(0,a.jsx)($,{memberships:t,workspace:s,searchParams:d,search:o,total:n,isLoading:l,PAGE_SIZE:X})})})}function et(e){let{workspace:s,members:t,total:n,isLoading:l,search:o,searchParams:d}=e,{data:m,isLoading:u}=c(s.id),{memberCount:h}=(0,H.qI)({workspaceId:s.id,status:"all"}),p=s.name||"Workspace",f=(0,a.jsxs)(a.Fragment,{children:["Inviting people to ",(0,a.jsxs)("strong",{children:[p,"'s workspace"]})," gives access to workspace shared projects and credits. You're using"," ",h,"/",u?"...":m," seats. Need more?"," ",(0,a.jsx)(r.default,{className:"underline",target:"_blank",href:"https://enterpriseform.lovable.app/",children:"Contact us"}),"."]});return(0,a.jsx)(i.tM,{title:"People",value:"people",description:f,children:(0,a.jsx)($,{memberships:t,workspace:s,searchParams:d,search:o,total:n,isLoading:l,PAGE_SIZE:X})})}},7653:function(e,s,t){t.d(s,{b:function(){return i},x:function(){return l}});var a=t(52155),r=t(98244);let n=(0,r.createContext)(null),i=()=>(0,r.useContext)(n),l=e=>{let{children:s,searchParams:t}=e;return(0,a.jsx)(n.Provider,{value:t,children:s})}},16125:function(e,s,t){t.d(s,{B:function(){return d}});var a=t(29605),r=t(56166),n=t(13273),i=t(94671),l=t(42690),o=t(7653),c=t(67005);function d(e){let{workspaceId:s}=e,t=(0,a.NL)(),d=(0,o.b)(),{mutateAsync:m,isPending:u}=(0,r.D)({mutationFn:async e=>{let{email:t,role:a="member"}=e;return(0,i.SJ)().post("/workspaces/".concat(s,"/memberships"),{email:t,role:a})},onSuccess:async e=>{if(e){let r=l.t.workspaceMemberships({workspaceId:s}),n=t.getQueryData(r.queryKey);if(n&&!n.members.some(s=>s.user_id===e.user_id)){var a;t.setQueryData(r.queryKey,{...n,members:[...n.members,e],total:n.total+1,limit:n.limit,offset:null!==(a=n.offset)&&void 0!==a?a:0,has_more:n.has_more})}if(d&&(!d.query||""===d.query.trim())){let a=l.t.searchWorkspaceMemberships({workspaceId:s,params:d}),r=t.getQueryData(a.queryKey);r&&!r.members.some(s=>s.user_id===e.user_id)&&t.setQueryData(a.queryKey,{...r,members:[...r.members,e],total:r.total+1,limit:r.limit,offset:r.offset,has_more:r.has_more})}}(0,c.T6)(t,s,d)},onError:e=>{(0,n.Eo)(e)}});return{inviteWorkspaceMember:m,isInvitingMember:u}}},21354:function(e,s,t){t.d(s,{SD:function(){return o},qB:function(){return l},qI:function(){return c}});var a=t(68820),r=t(98244),n=t(42690),i=t(18895);function l(e){let{workspaceId:s}=e,[t,l]=(0,r.useState)({query:"",status:"all",limit:i.I,offset:0}),{data:o,isLoading:c,error:d}=(0,a.a)(n.t.searchWorkspaceMemberships({workspaceId:s,params:t})),m=(0,r.useCallback)(e=>{l(s=>{let t={...s,...e};return(void 0!==e.query||void 0!==e.status)&&(t.offset=0),t})},[]),u=(0,r.useCallback)(()=>{(null==o?void 0:o.has_more)&&l(e=>({...e,offset:(e.offset||0)+i.I}))},[null==o?void 0:o.has_more]);return{members:(null==o?void 0:o.members)||[],total:(null==o?void 0:o.total)||0,hasMore:(null==o?void 0:o.has_more)||!1,isLoading:c,error:d,search:m,loadMore:u,searchParams:t}}function o(e){let{workspaceId:s}=e,{data:t,isLoading:r,error:i}=(0,a.a)(n.t.searchWorkspaceMemberships({workspaceId:s,params:{query:"",status:"active",role:"owner",limit:1}}));return{owner:(null==t?void 0:t.members[0])||null,isLoading:r,error:i}}function c(e){let{workspaceId:s,status:t="active"}=e,{data:r}=(0,a.a)(n.t.searchWorkspaceMemberships({workspaceId:s,params:{query:"",status:t,limit:1}}));return{memberCount:(null==r?void 0:r.total)||0}}},67005:function(e,s,t){t.d(s,{T6:function(){return i},dG:function(){return r},yt:function(){return n}});var a=t(42690);async function r(e,s){let t=a.t.workspaceMemberships({workspaceId:s});await e.cancelQueries({queryKey:t.queryKey})}function n(e,s,t,r,n,i){var l,o;let c=a.t.workspaceMemberships({workspaceId:s}),d=e.getQueryData(c.queryKey);if(d&&e.setQueryData(c.queryKey,{...d,members:r(d.members),total:i?i(d.total):d.total,limit:d.limit,offset:null!==(l=d.offset)&&void 0!==l?l:0,has_more:d.has_more}),t){let l=a.t.searchWorkspaceMemberships({workspaceId:s,params:t}),c=e.getQueryData(l.queryKey);if(c){let s=n?n(c.members):r(c.members);e.setQueryData(l.queryKey,{...c,members:s,total:i?i(c.total):c.total,limit:c.limit,offset:null!==(o=c.offset)&&void 0!==o?o:0,has_more:c.has_more})}}}function i(e,s,t){e.invalidateQueries({queryKey:a.t.workspaceMemberships({workspaceId:s}).queryKey}),t&&e.invalidateQueries({queryKey:a.t.searchWorkspaceMemberships({workspaceId:s,params:t}).queryKey})}},25483:function(e,s,t){t.d(s,{B:function(){return u}});var a=t(52155),r=t(26052),n=t(4578),i=t(45694),l=t(76332),o=t(99792);let c=/[,;\n\t]+/g,d=/\s+/g,m=e=>e.replace(c," ").replace(d," ").trim().split(" ").map(e=>e.trim()).filter(e=>""!==e),u=e=>{let{tags:s,setTags:t,inputValue:c,setInputValue:d,placeholder:u="Type and press Enter...",className:h="",...p}=e,f=e=>{s.includes(e)||""===e.trim()||t([...s,e]),d("")},x=e=>{t(s.filter((s,t)=>t!==e))};return(0,a.jsxs)("div",{className:(0,n.cn)("flex min-h-9 w-full min-w-0 flex-wrap items-center gap-1.5 overflow-hidden rounded-md border border-input bg-transparent p-2 py-1.5 text-sm shadow-sm transition-colors focus-within:ring-1 focus-within:ring-ring",h),children:[s.map((e,s)=>{let t=(0,i.Jh)(e);return(0,a.jsx)(l.b,{showTooltip:!t,tooltipContent:"This is not a valid email.",instant:!0,className:"min-w-0",children:(0,a.jsxs)(r.C,{variant:"secondary",className:"flex min-w-0 cursor-default items-center gap-1 rounded-sm px-1 py-0 text-xs font-medium",children:[!t&&(0,a.jsx)(o.Z,{name:"warning_fill",className:"text-destructive-primary",size:"small"}),(0,a.jsx)("span",{className:"min-w-0 max-w-[160px] overflow-hidden truncate md:whitespace-nowrap",children:e}),(0,a.jsx)("button",{type:"button",className:"flex-shrink-0 rounded-sm duration-100 ease-out hover:bg-muted-hover",onClick:()=>x(s),children:(0,a.jsx)(o.Z,{name:"close_small"})})]})},s)}),(0,a.jsx)("input",{type:"text",value:c,onChange:e=>d(e.target.value),onKeyDown:e=>{"Enter"!==e.key&&","!==e.key&&" "!==e.key||e.metaKey||""===c.trim()?"Backspace"===e.key&&""===c&&s.length>0&&x(s.length-1):(e.preventDefault(),f(c.trim()))},onPaste:e=>{e.preventDefault();let a=m(e.clipboardData.getData("text")),r=new Set(s),n=[...s];a.forEach(e=>{let s=""!==e.trim();!r.has(e)&&s&&(n.push(e),r.add(e))}),t(n)},placeholder:u,className:"min-w-[80px] flex-1 bg-transparent text-sm outline-none placeholder:text-muted-foreground",...p})]})};u.displayName="TagsInput"},7575:function(e,s,t){t.d(s,{w:function(){return c}});var a=t(52155),r=t(98244),n=t(53259),i=t(99792),l=t(4578),o=t(84183);let c=e=>{let{label:s,isSelected:t,onClick:c,disabled:d,className:m,destructive:u,tooltip:h}=e,[p,f]=(0,r.useState)(!1);return(0,a.jsxs)(o.u,{open:void 0!==h&&p,onOpenChange:f,children:[(0,a.jsx)(o.aJ,{asChild:!0,children:(0,a.jsxs)(n.Xi,{onClick:c,disabled:d,className:(0,l.cn)("flex items-center justify-between",{"bg-muted":t,"cursor-default":d,"text-destructive-primary focus:bg-destructive focus:text-destructive-foreground":u},m),children:[s,t&&(0,a.jsx)(i.Z,{name:"check",size:"small"})]})}),(0,a.jsx)(o._v,{side:"right",className:"max-w-[30ch]",children:h})]})}},47149:function(e,s,t){t.d(s,{N:function(){return r}});var a=t(98244);function r(e,s){let[t,r]=(0,a.useState)(e);return(0,a.useEffect)(()=>{let t=setTimeout(()=>{r(e)},s);return()=>{clearTimeout(t)}},[e,s]),t}},33864:function(e,s,t){function a(e){return Number.isInteger(e)?e.toString():e.toFixed(2)}function r(e,s){return"".concat(a(e),"/").concat(a(s))}t.d(s,{H:function(){return a},u:function(){return r}})},45694:function(e,s,t){t.d(s,{Jh:function(){return i},UM:function(){return o},hO:function(){return l}});var a=t(25243);let r=a.Z_().min(1,"Email is required").email("Please enter a valid email address"),n=a.IX(r).max(3,"You can invite up to 3 team members").refine(e=>new Set(e.map(e=>e.toLowerCase())).size===e.length,{message:"Duplicate email addresses are not allowed"});function i(e){return r.safeParse(e).success}function l(e){let s=e.filter(e=>""!==e.trim());return n.safeParse(s)}function o(e,s){let t=e.filter(e=>""!==e.trim()),a=n.safeParse(t),i=[null,null,null];for(let s=0;s<3;s++){let t=e[s];if(t&&t.trim()){let e=r.safeParse(t);if(!e.success){var l;i[s]=(null===(l=e.error.errors[0])||void 0===l?void 0:l.message)||"Invalid email address"}}}let o=[];return a.success||(o=a.error.errors.filter(e=>0===e.path.length).map(e=>e.message)),s&&t.some(e=>e.trim().toLowerCase()===s.trim().toLowerCase())&&o.push("You cannot invite yourself"),{globalErrors:o,fieldErrors:i}}}}]);